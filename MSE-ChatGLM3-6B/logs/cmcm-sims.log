2024-06-11 10:40:04:INFO:Start running cmcm...
2024-06-11 10:40:04:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 10:40:04:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 10:40:04:INFO:Let's use the GPU 1 !
2024-06-11 10:40:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073605 HTTP/1.1" 200 280
2024-06-11 10:40:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:40:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:40:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=config.json HTTP/1.1" 200 1323
2024-06-11 10:40:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=configuration.json HTTP/1.1" 200 48
2024-06-11 10:40:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=configuration_chatglm.py HTTP/1.1" 200 2332
2024-06-11 10:40:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=MODEL_LICENSE HTTP/1.1" 200 4133
2024-06-11 10:40:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=modeling_chatglm.py HTTP/1.1" 200 55652
2024-06-11 10:40:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=quantization.py HTTP/1.1" 200 14692
2024-06-11 10:40:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=README.md HTTP/1.1" 200 4566
2024-06-11 10:40:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=tokenization_chatglm.py HTTP/1.1" 200 11279
2024-06-11 10:40:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=tokenizer.model HTTP/1.1" 200 1018370
2024-06-11 10:40:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=tokenizer_config.json HTTP/1.1" 200 249
2024-06-11 10:40:10:INFO:train samples: (1284,)
2024-06-11 10:40:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073610 HTTP/1.1" 200 280
2024-06-11 10:40:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:40:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:40:11:INFO:valid samples: (229,)
2024-06-11 10:40:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073612 HTTP/1.1" 200 280
2024-06-11 10:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:40:13:INFO:test samples: (686,)
2024-06-11 10:40:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073613 HTTP/1.1" 200 280
2024-06-11 10:40:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:40:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00001-of-00007.bin HTTP/1.1" 200 150059490
2024-06-11 10:40:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:40:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:40:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00002-of-00007.bin HTTP/1.1" 200 122805720
2024-06-11 10:41:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:41:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:41:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00003-of-00007.bin HTTP/1.1" 200 81921276
2024-06-11 10:42:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00004-of-00007.bin HTTP/1.1" 200 137504398
2024-06-11 10:42:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:42:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:42:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00005-of-00007.bin HTTP/1.1" 200 122805784
2024-06-11 10:43:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00006-of-00007.bin HTTP/1.1" 200 81921276
2024-06-11 10:43:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 46175582
2024-06-11 10:43:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model-00007-of-00007.bin HTTP/1.1" 200 167772160
2024-06-11 10:43:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo?Revision=v1.0.1&FilePath=pytorch_model.bin.index.json HTTP/1.1" 200 20437
2024-06-11 10:43:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:43:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073839 HTTP/1.1" 200 280
2024-06-11 10:43:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:43:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:02:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 10:44:02:INFO:Init labels...
2024-06-11 10:44:02:INFO:Start training...
2024-06-11 10:44:20:INFO:Start running cmcm...
2024-06-11 10:44:20:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 10:44:20:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 10:44:20:INFO:Let's use the GPU 1 !
2024-06-11 10:44:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073861 HTTP/1.1" 200 280
2024-06-11 10:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:22:INFO:train samples: (1284,)
2024-06-11 10:44:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073863 HTTP/1.1" 200 280
2024-06-11 10:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:23:INFO:valid samples: (229,)
2024-06-11 10:44:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073864 HTTP/1.1" 200 280
2024-06-11 10:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:25:INFO:test samples: (686,)
2024-06-11 10:44:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:44:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073865 HTTP/1.1" 200 280
2024-06-11 10:44:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:44:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 10:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718073874 HTTP/1.1" 200 280
2024-06-11 10:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 10:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 10:44:37:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 10:44:37:INFO:Init labels...
2024-06-11 10:44:37:INFO:Start training...
2024-06-11 10:45:21:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1262
2024-06-11 10:45:35:INFO:VAL-(cmcm) >>
2024-06-11 10:45:35:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8346  Non0_acc_2: 0.8565  Non0_F1_score: 0.8572  Mult_acc_5: 0.5459  Mult_acc_7: 0.4323  MAE: 0.7717  Corr: 0.8096 
2024-06-11 10:45:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:46:26:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.8571
2024-06-11 10:46:39:INFO:VAL-(cmcm) >>
2024-06-11 10:46:39:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8518  Non0_acc_2: 0.8194  Non0_F1_score: 0.8190  Mult_acc_5: 0.5546  Mult_acc_7: 0.4541  MAE: 0.6913  Corr: 0.8186 
2024-06-11 10:46:45:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:47:29:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.7793
2024-06-11 10:47:42:INFO:VAL-(cmcm) >>
2024-06-11 10:47:42:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8796  Non0_F1_score: 0.8800  Mult_acc_5: 0.5721  Mult_acc_7: 0.4760  MAE: 0.6669  Corr: 0.8341 
2024-06-11 10:47:48:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:48:32:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.7456
2024-06-11 10:48:45:INFO:VAL-(cmcm) >>
2024-06-11 10:48:45:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8442  Non0_acc_2: 0.8472  Non0_F1_score: 0.8478  Mult_acc_5: 0.5459  Mult_acc_7: 0.4585  MAE: 0.6704  Corr: 0.8307 
2024-06-11 10:49:27:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.7301
2024-06-11 10:49:40:INFO:VAL-(cmcm) >>
2024-06-11 10:49:40:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8889  Non0_F1_score: 0.8890  Mult_acc_5: 0.5633  Mult_acc_7: 0.4672  MAE: 0.6699  Corr: 0.8392 
2024-06-11 10:50:24:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.7174
2024-06-11 10:50:37:INFO:VAL-(cmcm) >>
2024-06-11 10:50:37:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8611  Non0_F1_score: 0.8618  Mult_acc_5: 0.5852  Mult_acc_7: 0.4891  MAE: 0.6206  Corr: 0.8397 
2024-06-11 10:50:44:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:51:29:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.7061
2024-06-11 10:51:42:INFO:VAL-(cmcm) >>
2024-06-11 10:51:42:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8612  Non0_acc_2: 0.8611  Non0_F1_score: 0.8619  Mult_acc_5: 0.6070  Mult_acc_7: 0.5066  MAE: 0.6088  Corr: 0.8475 
2024-06-11 10:51:49:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:52:33:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.7006
2024-06-11 10:52:46:INFO:VAL-(cmcm) >>
2024-06-11 10:52:46:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8694  Non0_acc_2: 0.8611  Non0_F1_score: 0.8618  Mult_acc_5: 0.5983  Mult_acc_7: 0.5109  MAE: 0.6018  Corr: 0.8534 
2024-06-11 10:52:52:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:53:38:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.6989
2024-06-11 10:53:51:INFO:VAL-(cmcm) >>
2024-06-11 10:53:51:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8591  Non0_acc_2: 0.8750  Non0_F1_score: 0.8752  Mult_acc_5: 0.5721  Mult_acc_7: 0.4716  MAE: 0.6127  Corr: 0.8533 
2024-06-11 10:54:34:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.6898
2024-06-11 10:54:47:INFO:VAL-(cmcm) >>
2024-06-11 10:54:47:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8773  Non0_acc_2: 0.8889  Non0_F1_score: 0.8890  Mult_acc_5: 0.6157  Mult_acc_7: 0.5240  MAE: 0.5778  Corr: 0.8799 
2024-06-11 10:54:53:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:55:37:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.6870
2024-06-11 10:55:50:INFO:VAL-(cmcm) >>
2024-06-11 10:55:50:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8815  Non0_acc_2: 0.8796  Non0_F1_score: 0.8801  Mult_acc_5: 0.5983  Mult_acc_7: 0.5197  MAE: 0.5678  Corr: 0.8730 
2024-06-11 10:55:57:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 10:56:41:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.6836
2024-06-11 10:56:54:INFO:VAL-(cmcm) >>
2024-06-11 10:56:54:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8679  Non0_acc_2: 0.8750  Non0_F1_score: 0.8751  Mult_acc_5: 0.5721  Mult_acc_7: 0.4803  MAE: 0.5979  Corr: 0.8687 
2024-06-11 10:57:37:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.6803
2024-06-11 10:57:50:INFO:VAL-(cmcm) >>
2024-06-11 10:57:50:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8679  Non0_acc_2: 0.8750  Non0_F1_score: 0.8756  Mult_acc_5: 0.6114  Mult_acc_7: 0.5240  MAE: 0.5747  Corr: 0.8726 
2024-06-11 10:58:32:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.6752
2024-06-11 10:58:45:INFO:VAL-(cmcm) >>
2024-06-11 10:58:45:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8843  Non0_F1_score: 0.8847  Mult_acc_5: 0.5895  Mult_acc_7: 0.4803  MAE: 0.5992  Corr: 0.8693 
2024-06-11 10:59:29:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.6600
2024-06-11 10:59:42:INFO:VAL-(cmcm) >>
2024-06-11 10:59:42:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8519  Non0_F1_score: 0.8526  Mult_acc_5: 0.5633  Mult_acc_7: 0.4629  MAE: 0.6001  Corr: 0.8633 
2024-06-11 11:00:27:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.6573
2024-06-11 11:00:40:INFO:VAL-(cmcm) >>
2024-06-11 11:00:40:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8519  Non0_F1_score: 0.8527  Mult_acc_5: 0.5677  Mult_acc_7: 0.4716  MAE: 0.6276  Corr: 0.8631 
2024-06-11 11:01:24:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.6563
2024-06-11 11:01:37:INFO:VAL-(cmcm) >>
2024-06-11 11:01:37:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8843  Non0_F1_score: 0.8848  Mult_acc_5: 0.6026  Mult_acc_7: 0.5197  MAE: 0.5765  Corr: 0.8739 
2024-06-11 11:02:20:INFO:TRAIN-(cmcm) (7/18/1)>> loss: 0.6499
2024-06-11 11:02:33:INFO:VAL-(cmcm) >>
2024-06-11 11:02:33:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8889  Non0_F1_score: 0.8889  Mult_acc_5: 0.6114  Mult_acc_7: 0.5240  MAE: 0.5769  Corr: 0.8796 
2024-06-11 11:03:18:INFO:TRAIN-(cmcm) (8/19/1)>> loss: 0.6437
2024-06-11 11:03:30:INFO:VAL-(cmcm) >>
2024-06-11 11:03:30:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.8704  Non0_F1_score: 0.8711  Mult_acc_5: 0.5983  Mult_acc_7: 0.5328  MAE: 0.5931  Corr: 0.8692 
2024-06-11 11:04:12:INFO:TRAIN-(cmcm) (9/20/1)>> loss: 0.6443
2024-06-11 11:04:25:INFO:VAL-(cmcm) >>
2024-06-11 11:04:25:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8796  Non0_F1_score: 0.8803  Mult_acc_5: 0.5677  Mult_acc_7: 0.4978  MAE: 0.5752  Corr: 0.8734 
2024-06-11 11:05:07:INFO:TRAIN-(cmcm) (10/21/1)>> loss: 0.6378
2024-06-11 11:05:20:INFO:VAL-(cmcm) >>
2024-06-11 11:05:20:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8735  Non0_acc_2: 0.8704  Non0_F1_score: 0.8711  Mult_acc_5: 0.5546  Mult_acc_7: 0.4803  MAE: 0.5857  Corr: 0.8732 
2024-06-11 11:05:58:INFO:TEST-(cmcm) >>
2024-06-11 11:05:58:INFO:M: >>  Has0_acc_2: 0.8834  Has0_F1_score: 0.8834  Non0_acc_2: 0.8704  Non0_F1_score: 0.8688  Mult_acc_5: 0.5350  Mult_acc_7: 0.4592  MAE: 0.6140  Corr: 0.8515 
2024-06-11 11:05:59:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 11:05:59:INFO:Start running cmcm...
2024-06-11 11:05:59:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 11:05:59:INFO:Let's use the GPU 1 !
2024-06-11 11:05:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:06:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718075160 HTTP/1.1" 200 280
2024-06-11 11:06:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:06:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:06:01:INFO:train samples: (1284,)
2024-06-11 11:06:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:06:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718075161 HTTP/1.1" 200 280
2024-06-11 11:06:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:06:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:06:02:INFO:valid samples: (229,)
2024-06-11 11:06:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:06:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718075163 HTTP/1.1" 200 280
2024-06-11 11:06:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:06:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:06:03:INFO:test samples: (686,)
2024-06-11 11:06:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:06:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718075164 HTTP/1.1" 200 280
2024-06-11 11:06:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:06:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:06:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:06:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718075172 HTTP/1.1" 200 280
2024-06-11 11:06:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:06:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:06:14:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 11:06:14:INFO:Init labels...
2024-06-11 11:06:14:INFO:Start training...
2024-06-11 11:06:56:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.1404
2024-06-11 11:07:09:INFO:VAL-(cmcm) >>
2024-06-11 11:07:09:INFO:M: >>  Has0_acc_2: 0.8253  Has0_F1_score: 0.8193  Non0_acc_2: 0.8380  Non0_F1_score: 0.8313  Mult_acc_5: 0.4585  Mult_acc_7: 0.3581  MAE: 0.8634  Corr: 0.8104 
2024-06-11 11:07:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:08:04:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.8898
2024-06-11 11:08:16:INFO:VAL-(cmcm) >>
2024-06-11 11:08:16:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8597  Non0_acc_2: 0.8796  Non0_F1_score: 0.8785  Mult_acc_5: 0.4934  Mult_acc_7: 0.3843  MAE: 0.7721  Corr: 0.8218 
2024-06-11 11:08:25:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:09:09:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.8412
2024-06-11 11:09:22:INFO:VAL-(cmcm) >>
2024-06-11 11:09:22:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8406  Non0_acc_2: 0.8704  Non0_F1_score: 0.8702  Mult_acc_5: 0.5764  Mult_acc_7: 0.4760  MAE: 0.6918  Corr: 0.8431 
2024-06-11 11:09:31:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:10:14:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8034
2024-06-11 11:10:26:INFO:VAL-(cmcm) >>
2024-06-11 11:10:26:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8545  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.5808  Mult_acc_7: 0.4585  MAE: 0.6664  Corr: 0.8586 
2024-06-11 11:10:35:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:11:18:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.7378
2024-06-11 11:11:30:INFO:VAL-(cmcm) >>
2024-06-11 11:11:30:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8513  Non0_acc_2: 0.8935  Non0_F1_score: 0.8937  Mult_acc_5: 0.5546  Mult_acc_7: 0.4454  MAE: 0.6350  Corr: 0.8701 
2024-06-11 11:11:39:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:12:22:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.7102
2024-06-11 11:12:35:INFO:VAL-(cmcm) >>
2024-06-11 11:12:35:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8609  Non0_acc_2: 0.8519  Non0_F1_score: 0.8523  Mult_acc_5: 0.5502  Mult_acc_7: 0.4410  MAE: 0.6494  Corr: 0.8616 
2024-06-11 11:13:16:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.7013
2024-06-11 11:13:28:INFO:VAL-(cmcm) >>
2024-06-11 11:13:28:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8490  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.6157  Mult_acc_7: 0.4934  MAE: 0.6210  Corr: 0.8719 
2024-06-11 11:13:37:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:14:20:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.6885
2024-06-11 11:14:32:INFO:VAL-(cmcm) >>
2024-06-11 11:14:32:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8566  Non0_acc_2: 0.8889  Non0_F1_score: 0.8893  Mult_acc_5: 0.5284  Mult_acc_7: 0.4192  MAE: 0.6525  Corr: 0.8629 
2024-06-11 11:15:13:INFO:TRAIN-(cmcm) (2/9/2)>> loss: 0.6803
2024-06-11 11:15:26:INFO:VAL-(cmcm) >>
2024-06-11 11:15:26:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8470  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.6245  Mult_acc_7: 0.4934  MAE: 0.6136  Corr: 0.8774 
2024-06-11 11:15:35:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:16:18:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.6713
2024-06-11 11:16:30:INFO:VAL-(cmcm) >>
2024-06-11 11:16:30:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8613  Non0_acc_2: 0.8981  Non0_F1_score: 0.8986  Mult_acc_5: 0.5852  Mult_acc_7: 0.4672  MAE: 0.6298  Corr: 0.8713 
2024-06-11 11:17:11:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.6693
2024-06-11 11:17:24:INFO:VAL-(cmcm) >>
2024-06-11 11:17:24:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8935  Non0_F1_score: 0.8941  Mult_acc_5: 0.5633  Mult_acc_7: 0.4498  MAE: 0.6324  Corr: 0.8759 
2024-06-11 11:18:05:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 0.6599
2024-06-11 11:18:17:INFO:VAL-(cmcm) >>
2024-06-11 11:18:17:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8457  Non0_acc_2: 0.8935  Non0_F1_score: 0.8937  Mult_acc_5: 0.6114  Mult_acc_7: 0.4934  MAE: 0.5848  Corr: 0.8883 
2024-06-11 11:18:26:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:19:09:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.6549
2024-06-11 11:19:21:INFO:VAL-(cmcm) >>
2024-06-11 11:19:21:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8506  Non0_acc_2: 0.8843  Non0_F1_score: 0.8836  Mult_acc_5: 0.5983  Mult_acc_7: 0.4803  MAE: 0.6678  Corr: 0.8521 
2024-06-11 11:20:02:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.6564
2024-06-11 11:20:15:INFO:VAL-(cmcm) >>
2024-06-11 11:20:15:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6245  Mult_acc_7: 0.5066  MAE: 0.5909  Corr: 0.8861 
2024-06-11 11:20:56:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.6483
2024-06-11 11:21:08:INFO:VAL-(cmcm) >>
2024-06-11 11:21:08:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8548  Non0_acc_2: 0.8843  Non0_F1_score: 0.8843  Mult_acc_5: 0.6288  Mult_acc_7: 0.5066  MAE: 0.6023  Corr: 0.8864 
2024-06-11 11:21:49:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.6507
2024-06-11 11:22:02:INFO:VAL-(cmcm) >>
2024-06-11 11:22:02:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.9028  Non0_F1_score: 0.9033  Mult_acc_5: 0.5677  Mult_acc_7: 0.4454  MAE: 0.6346  Corr: 0.8755 
2024-06-11 11:22:43:INFO:TRAIN-(cmcm) (5/17/2)>> loss: 0.6449
2024-06-11 11:22:55:INFO:VAL-(cmcm) >>
2024-06-11 11:22:55:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.8889  Non0_F1_score: 0.8895  Mult_acc_5: 0.5371  Mult_acc_7: 0.4236  MAE: 0.6586  Corr: 0.8646 
2024-06-11 11:23:36:INFO:TRAIN-(cmcm) (6/18/2)>> loss: 0.6387
2024-06-11 11:23:49:INFO:VAL-(cmcm) >>
2024-06-11 11:23:49:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8453  Non0_acc_2: 0.8843  Non0_F1_score: 0.8840  Mult_acc_5: 0.5895  Mult_acc_7: 0.4716  MAE: 0.6429  Corr: 0.8714 
2024-06-11 11:24:30:INFO:TRAIN-(cmcm) (7/19/2)>> loss: 0.6354
2024-06-11 11:24:42:INFO:VAL-(cmcm) >>
2024-06-11 11:24:42:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8453  Non0_acc_2: 0.9028  Non0_F1_score: 0.9031  Mult_acc_5: 0.5895  Mult_acc_7: 0.4760  MAE: 0.6123  Corr: 0.8831 
2024-06-11 11:25:23:INFO:TRAIN-(cmcm) (8/20/2)>> loss: 0.6336
2024-06-11 11:25:36:INFO:VAL-(cmcm) >>
2024-06-11 11:25:36:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8410  Non0_acc_2: 0.8935  Non0_F1_score: 0.8938  Mult_acc_5: 0.5590  Mult_acc_7: 0.4498  MAE: 0.6529  Corr: 0.8690 
2024-06-11 11:26:17:INFO:TRAIN-(cmcm) (9/21/2)>> loss: 0.6292
2024-06-11 11:26:29:INFO:VAL-(cmcm) >>
2024-06-11 11:26:29:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8410  Non0_acc_2: 0.9074  Non0_F1_score: 0.9077  Mult_acc_5: 0.6070  Mult_acc_7: 0.4934  MAE: 0.6097  Corr: 0.8806 
2024-06-11 11:27:10:INFO:TRAIN-(cmcm) (10/22/2)>> loss: 0.6272
2024-06-11 11:27:23:INFO:VAL-(cmcm) >>
2024-06-11 11:27:23:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8558  Non0_acc_2: 0.8981  Non0_F1_score: 0.8986  Mult_acc_5: 0.5590  Mult_acc_7: 0.4454  MAE: 0.6411  Corr: 0.8723 
2024-06-11 11:28:00:INFO:TEST-(cmcm) >>
2024-06-11 11:28:00:INFO:M: >>  Has0_acc_2: 0.8761  Has0_F1_score: 0.8758  Non0_acc_2: 0.8902  Non0_F1_score: 0.8894  Mult_acc_5: 0.5583  Mult_acc_7: 0.4723  MAE: 0.6425  Corr: 0.8419 
2024-06-11 11:28:01:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 11:28:01:INFO:Start running cmcm...
2024-06-11 11:28:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 11:28:01:INFO:Let's use the GPU 1 !
2024-06-11 11:28:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:28:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718076482 HTTP/1.1" 200 280
2024-06-11 11:28:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:28:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:28:02:INFO:train samples: (1284,)
2024-06-11 11:28:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:28:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718076483 HTTP/1.1" 200 280
2024-06-11 11:28:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:28:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:28:04:INFO:valid samples: (229,)
2024-06-11 11:28:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:28:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718076484 HTTP/1.1" 200 280
2024-06-11 11:28:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:28:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:28:05:INFO:test samples: (686,)
2024-06-11 11:28:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:28:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718076486 HTTP/1.1" 200 280
2024-06-11 11:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:28:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:28:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718076495 HTTP/1.1" 200 280
2024-06-11 11:28:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:28:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:28:17:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 11:28:17:INFO:Init labels...
2024-06-11 11:28:17:INFO:Start training...
2024-06-11 11:28:58:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.2170
2024-06-11 11:29:10:INFO:VAL-(cmcm) >>
2024-06-11 11:29:10:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8440  Non0_acc_2: 0.8287  Non0_F1_score: 0.8288  Mult_acc_5: 0.5284  Mult_acc_7: 0.3188  MAE: 1.0223  Corr: 0.7889 
2024-06-11 11:29:19:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:30:02:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0361
2024-06-11 11:30:14:INFO:VAL-(cmcm) >>
2024-06-11 11:30:14:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8442  Non0_acc_2: 0.7639  Non0_F1_score: 0.7609  Mult_acc_5: 0.4629  Mult_acc_7: 0.3799  MAE: 0.8071  Corr: 0.7791 
2024-06-11 11:30:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:31:06:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9061
2024-06-11 11:31:18:INFO:VAL-(cmcm) >>
2024-06-11 11:31:18:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8682  Non0_acc_2: 0.8889  Non0_F1_score: 0.8881  Mult_acc_5: 0.4978  Mult_acc_7: 0.3799  MAE: 0.7477  Corr: 0.8279 
2024-06-11 11:31:27:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:32:10:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.8321
2024-06-11 11:32:22:INFO:VAL-(cmcm) >>
2024-06-11 11:32:23:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8770  Non0_acc_2: 0.8935  Non0_F1_score: 0.8929  Mult_acc_5: 0.5677  Mult_acc_7: 0.4629  MAE: 0.6769  Corr: 0.8667 
2024-06-11 11:32:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:33:14:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.7632
2024-06-11 11:33:26:INFO:VAL-(cmcm) >>
2024-06-11 11:33:26:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8541  Non0_acc_2: 0.8750  Non0_F1_score: 0.8734  Mult_acc_5: 0.5066  Mult_acc_7: 0.4017  MAE: 0.6913  Corr: 0.8527 
2024-06-11 11:34:07:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.7181
2024-06-11 11:34:20:INFO:VAL-(cmcm) >>
2024-06-11 11:34:20:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8696  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5415  Mult_acc_7: 0.4498  MAE: 0.6333  Corr: 0.8654 
2024-06-11 11:34:28:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:35:11:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.6986
2024-06-11 11:35:24:INFO:VAL-(cmcm) >>
2024-06-11 11:35:24:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8737  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5895  Mult_acc_7: 0.4847  MAE: 0.6311  Corr: 0.8601 
2024-06-11 11:35:32:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:36:15:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.6809
2024-06-11 11:36:27:INFO:VAL-(cmcm) >>
2024-06-11 11:36:27:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8587  Non0_acc_2: 0.8889  Non0_F1_score: 0.8878  Mult_acc_5: 0.4803  Mult_acc_7: 0.3843  MAE: 0.6708  Corr: 0.8626 
2024-06-11 11:37:08:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.6724
2024-06-11 11:37:21:INFO:VAL-(cmcm) >>
2024-06-11 11:37:21:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.5808  Mult_acc_7: 0.4847  MAE: 0.6385  Corr: 0.8548 
2024-06-11 11:38:02:INFO:TRAIN-(cmcm) (3/10/3)>> loss: 0.6648
2024-06-11 11:38:14:INFO:VAL-(cmcm) >>
2024-06-11 11:38:14:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8696  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.5895  Mult_acc_7: 0.4760  MAE: 0.6634  Corr: 0.8556 
2024-06-11 11:38:55:INFO:TRAIN-(cmcm) (4/11/3)>> loss: 0.6606
2024-06-11 11:39:08:INFO:VAL-(cmcm) >>
2024-06-11 11:39:08:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8775  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5022  Mult_acc_7: 0.4148  MAE: 0.6407  Corr: 0.8548 
2024-06-11 11:39:49:INFO:TRAIN-(cmcm) (5/12/3)>> loss: 0.6507
2024-06-11 11:40:01:INFO:VAL-(cmcm) >>
2024-06-11 11:40:01:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8727  Non0_acc_2: 0.8889  Non0_F1_score: 0.8881  Mult_acc_5: 0.5066  Mult_acc_7: 0.4148  MAE: 0.6398  Corr: 0.8652 
2024-06-11 11:40:42:INFO:TRAIN-(cmcm) (6/13/3)>> loss: 0.6516
2024-06-11 11:40:55:INFO:VAL-(cmcm) >>
2024-06-11 11:40:55:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5633  Mult_acc_7: 0.4629  MAE: 0.6320  Corr: 0.8632 
2024-06-11 11:41:36:INFO:TRAIN-(cmcm) (7/14/3)>> loss: 0.6409
2024-06-11 11:41:48:INFO:VAL-(cmcm) >>
2024-06-11 11:41:48:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8777  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5546  Mult_acc_7: 0.4629  MAE: 0.6407  Corr: 0.8515 
2024-06-11 11:42:29:INFO:TRAIN-(cmcm) (8/15/3)>> loss: 0.6358
2024-06-11 11:42:42:INFO:VAL-(cmcm) >>
2024-06-11 11:42:42:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8775  Non0_acc_2: 0.8981  Non0_F1_score: 0.8976  Mult_acc_5: 0.5764  Mult_acc_7: 0.4760  MAE: 0.6477  Corr: 0.8502 
2024-06-11 11:43:23:INFO:TRAIN-(cmcm) (9/16/3)>> loss: 0.6308
2024-06-11 11:43:35:INFO:VAL-(cmcm) >>
2024-06-11 11:43:35:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8727  Non0_acc_2: 0.8935  Non0_F1_score: 0.8929  Mult_acc_5: 0.5633  Mult_acc_7: 0.4454  MAE: 0.6656  Corr: 0.8518 
2024-06-11 11:44:16:INFO:TRAIN-(cmcm) (10/17/3)>> loss: 0.6269
2024-06-11 11:44:29:INFO:VAL-(cmcm) >>
2024-06-11 11:44:29:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8889  Non0_F1_score: 0.8881  Mult_acc_5: 0.5459  Mult_acc_7: 0.4410  MAE: 0.6726  Corr: 0.8467 
2024-06-11 11:45:06:INFO:TEST-(cmcm) >>
2024-06-11 11:45:06:INFO:M: >>  Has0_acc_2: 0.8703  Has0_F1_score: 0.8697  Non0_acc_2: 0.8872  Non0_F1_score: 0.8870  Mult_acc_5: 0.5204  Mult_acc_7: 0.4373  MAE: 0.7034  Corr: 0.8183 
2024-06-11 11:45:07:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 11:45:07:INFO:Start running cmcm...
2024-06-11 11:45:07:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 11:45:07:INFO:Let's use the GPU 1 !
2024-06-11 11:45:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:45:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718077507 HTTP/1.1" 200 280
2024-06-11 11:45:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:45:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:45:08:INFO:train samples: (1284,)
2024-06-11 11:45:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718077509 HTTP/1.1" 200 280
2024-06-11 11:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:45:09:INFO:valid samples: (229,)
2024-06-11 11:45:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:45:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718077510 HTTP/1.1" 200 280
2024-06-11 11:45:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:45:11:INFO:test samples: (686,)
2024-06-11 11:45:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718077511 HTTP/1.1" 200 280
2024-06-11 11:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:45:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 11:45:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718077519 HTTP/1.1" 200 280
2024-06-11 11:45:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 11:45:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 11:45:22:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 11:45:22:INFO:Init labels...
2024-06-11 11:45:22:INFO:Start training...
2024-06-11 11:46:03:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.1667
2024-06-11 11:46:15:INFO:VAL-(cmcm) >>
2024-06-11 11:46:15:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8376  Non0_acc_2: 0.7824  Non0_F1_score: 0.7802  Mult_acc_5: 0.5415  Mult_acc_7: 0.4367  MAE: 0.7656  Corr: 0.8050 
2024-06-11 11:46:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:47:07:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.9511
2024-06-11 11:47:19:INFO:VAL-(cmcm) >>
2024-06-11 11:47:19:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8659  Non0_acc_2: 0.9120  Non0_F1_score: 0.9125  Mult_acc_5: 0.5197  Mult_acc_7: 0.4148  MAE: 0.7027  Corr: 0.8378 
2024-06-11 11:47:28:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:48:10:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.8480
2024-06-11 11:48:23:INFO:VAL-(cmcm) >>
2024-06-11 11:48:23:INFO:M: >>  Has0_acc_2: 0.8865  Has0_F1_score: 0.8868  Non0_acc_2: 0.9074  Non0_F1_score: 0.9074  Mult_acc_5: 0.5546  Mult_acc_7: 0.4760  MAE: 0.6468  Corr: 0.8663 
2024-06-11 11:48:31:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:49:14:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.7738
2024-06-11 11:49:27:INFO:VAL-(cmcm) >>
2024-06-11 11:49:27:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8777  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5764  Mult_acc_7: 0.4934  MAE: 0.6324  Corr: 0.8652 
2024-06-11 11:49:35:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:50:18:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.7232
2024-06-11 11:50:31:INFO:VAL-(cmcm) >>
2024-06-11 11:50:31:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8786  Non0_acc_2: 0.9028  Non0_F1_score: 0.9030  Mult_acc_5: 0.5808  Mult_acc_7: 0.4847  MAE: 0.5922  Corr: 0.8692 
2024-06-11 11:50:39:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:51:22:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.7015
2024-06-11 11:51:35:INFO:VAL-(cmcm) >>
2024-06-11 11:51:35:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8740  Non0_acc_2: 0.9028  Non0_F1_score: 0.9027  Mult_acc_5: 0.5852  Mult_acc_7: 0.4891  MAE: 0.6389  Corr: 0.8635 
2024-06-11 11:52:16:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 0.6909
2024-06-11 11:52:28:INFO:VAL-(cmcm) >>
2024-06-11 11:52:28:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8692  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5939  Mult_acc_7: 0.5022  MAE: 0.6503  Corr: 0.8672 
2024-06-11 11:53:09:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.6782
2024-06-11 11:53:22:INFO:VAL-(cmcm) >>
2024-06-11 11:53:22:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8609  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5983  Mult_acc_7: 0.4978  MAE: 0.6189  Corr: 0.8705 
2024-06-11 11:54:03:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.6674
2024-06-11 11:54:15:INFO:VAL-(cmcm) >>
2024-06-11 11:54:15:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8658  Non0_acc_2: 0.9028  Non0_F1_score: 0.9031  Mult_acc_5: 0.5633  Mult_acc_7: 0.4803  MAE: 0.6324  Corr: 0.8685 
2024-06-11 11:54:56:INFO:TRAIN-(cmcm) (5/10/4)>> loss: 0.6582
2024-06-11 11:55:09:INFO:VAL-(cmcm) >>
2024-06-11 11:55:09:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8889  Non0_F1_score: 0.8883  Mult_acc_5: 0.5852  Mult_acc_7: 0.4847  MAE: 0.6149  Corr: 0.8685 
2024-06-11 11:55:50:INFO:TRAIN-(cmcm) (6/11/4)>> loss: 0.6510
2024-06-11 11:56:03:INFO:VAL-(cmcm) >>
2024-06-11 11:56:03:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8701  Non0_acc_2: 0.9074  Non0_F1_score: 0.9076  Mult_acc_5: 0.5415  Mult_acc_7: 0.4410  MAE: 0.6219  Corr: 0.8659 
2024-06-11 11:56:44:INFO:TRAIN-(cmcm) (7/12/4)>> loss: 0.6427
2024-06-11 11:56:56:INFO:VAL-(cmcm) >>
2024-06-11 11:56:56:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8744  Non0_acc_2: 0.9120  Non0_F1_score: 0.9122  Mult_acc_5: 0.5852  Mult_acc_7: 0.4803  MAE: 0.5795  Corr: 0.8807 
2024-06-11 11:57:05:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 11:57:47:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.6412
2024-06-11 11:58:00:INFO:VAL-(cmcm) >>
2024-06-11 11:58:00:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8658  Non0_acc_2: 0.9028  Non0_F1_score: 0.9031  Mult_acc_5: 0.5502  Mult_acc_7: 0.4498  MAE: 0.6189  Corr: 0.8678 
2024-06-11 11:58:41:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.6350
2024-06-11 11:58:54:INFO:VAL-(cmcm) >>
2024-06-11 11:58:54:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8779  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5808  Mult_acc_7: 0.4672  MAE: 0.6136  Corr: 0.8674 
2024-06-11 11:59:35:INFO:TRAIN-(cmcm) (3/15/4)>> loss: 0.6294
2024-06-11 11:59:47:INFO:VAL-(cmcm) >>
2024-06-11 11:59:47:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8777  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.5939  Mult_acc_7: 0.4934  MAE: 0.5887  Corr: 0.8721 
2024-06-11 12:00:28:INFO:TRAIN-(cmcm) (4/16/4)>> loss: 0.6196
2024-06-11 12:00:41:INFO:VAL-(cmcm) >>
2024-06-11 12:00:41:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8698  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.5895  Mult_acc_7: 0.4934  MAE: 0.5861  Corr: 0.8738 
2024-06-11 12:01:22:INFO:TRAIN-(cmcm) (5/17/4)>> loss: 0.6178
2024-06-11 12:01:35:INFO:VAL-(cmcm) >>
2024-06-11 12:01:35:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8679  Non0_acc_2: 0.8889  Non0_F1_score: 0.8878  Mult_acc_5: 0.5764  Mult_acc_7: 0.4803  MAE: 0.6040  Corr: 0.8752 
2024-06-11 12:02:16:INFO:TRAIN-(cmcm) (6/18/4)>> loss: 0.6108
2024-06-11 12:02:28:INFO:VAL-(cmcm) >>
2024-06-11 12:02:28:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8820  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5808  Mult_acc_7: 0.4891  MAE: 0.5922  Corr: 0.8743 
2024-06-11 12:03:09:INFO:TRAIN-(cmcm) (7/19/4)>> loss: 0.6051
2024-06-11 12:03:22:INFO:VAL-(cmcm) >>
2024-06-11 12:03:22:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8739  Non0_acc_2: 0.8935  Non0_F1_score: 0.8934  Mult_acc_5: 0.5895  Mult_acc_7: 0.5066  MAE: 0.6001  Corr: 0.8680 
2024-06-11 12:04:03:INFO:TRAIN-(cmcm) (8/20/4)>> loss: 0.6002
2024-06-11 12:04:15:INFO:VAL-(cmcm) >>
2024-06-11 12:04:15:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8735  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5895  Mult_acc_7: 0.5109  MAE: 0.5988  Corr: 0.8699 
2024-06-11 12:04:56:INFO:TRAIN-(cmcm) (9/21/4)>> loss: 0.5960
2024-06-11 12:05:09:INFO:VAL-(cmcm) >>
2024-06-11 12:05:09:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8787  Non0_acc_2: 0.9120  Non0_F1_score: 0.9122  Mult_acc_5: 0.5677  Mult_acc_7: 0.4672  MAE: 0.5970  Corr: 0.8756 
2024-06-11 12:05:50:INFO:TRAIN-(cmcm) (10/22/4)>> loss: 0.5937
2024-06-11 12:06:03:INFO:VAL-(cmcm) >>
2024-06-11 12:06:03:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8784  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.5895  Mult_acc_7: 0.4978  MAE: 0.5992  Corr: 0.8714 
2024-06-11 12:06:40:INFO:TEST-(cmcm) >>
2024-06-11 12:06:40:INFO:M: >>  Has0_acc_2: 0.8746  Has0_F1_score: 0.8739  Non0_acc_2: 0.8994  Non0_F1_score: 0.8989  Mult_acc_5: 0.5292  Mult_acc_7: 0.4577  MAE: 0.6309  Corr: 0.8457 
2024-06-11 12:06:41:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 12:06:41:INFO:Start running cmcm...
2024-06-11 12:06:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 12:06:41:INFO:Let's use the GPU 1 !
2024-06-11 12:06:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:06:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718078801 HTTP/1.1" 200 280
2024-06-11 12:06:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 12:06:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:06:42:INFO:train samples: (1284,)
2024-06-11 12:06:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:06:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718078803 HTTP/1.1" 200 280
2024-06-11 12:06:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 12:06:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:06:43:INFO:valid samples: (229,)
2024-06-11 12:06:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:06:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718078804 HTTP/1.1" 200 280
2024-06-11 12:06:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 12:06:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:06:44:INFO:test samples: (686,)
2024-06-11 12:06:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:06:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718078805 HTTP/1.1" 200 280
2024-06-11 12:06:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 12:06:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:06:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1718078814 HTTP/1.1" 200 280
2024-06-11 12:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-06-11 12:06:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:06:56:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-06-11 12:06:56:INFO:Init labels...
2024-06-11 12:06:56:INFO:Start training...
2024-06-11 12:07:37:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.1736
2024-06-11 12:07:49:INFO:VAL-(cmcm) >>
2024-06-11 12:07:49:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8563  Non0_acc_2: 0.7222  Non0_F1_score: 0.7141  Mult_acc_5: 0.5371  Mult_acc_7: 0.4323  MAE: 0.8009  Corr: 0.7765 
2024-06-11 12:07:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:08:41:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9526
2024-06-11 12:08:53:INFO:VAL-(cmcm) >>
2024-06-11 12:08:53:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8701  Non0_acc_2: 0.8889  Non0_F1_score: 0.8895  Mult_acc_5: 0.5721  Mult_acc_7: 0.4629  MAE: 0.6743  Corr: 0.8357 
2024-06-11 12:09:02:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:09:45:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.8590
2024-06-11 12:09:57:INFO:VAL-(cmcm) >>
2024-06-11 12:09:57:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.5808  Mult_acc_7: 0.4891  MAE: 0.6411  Corr: 0.8443 
2024-06-11 12:10:06:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:10:48:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8259
2024-06-11 12:11:02:INFO:VAL-(cmcm) >>
2024-06-11 12:11:02:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8889  Non0_F1_score: 0.8892  Mult_acc_5: 0.5808  Mult_acc_7: 0.4672  MAE: 0.6376  Corr: 0.8518 
2024-06-11 12:11:10:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:11:53:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8026
2024-06-11 12:12:05:INFO:VAL-(cmcm) >>
2024-06-11 12:12:05:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8679  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6070  Mult_acc_7: 0.4891  MAE: 0.6180  Corr: 0.8620 
2024-06-11 12:12:14:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:12:57:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.7146
2024-06-11 12:13:09:INFO:VAL-(cmcm) >>
2024-06-11 12:13:09:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8612  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.6157  Mult_acc_7: 0.4891  MAE: 0.6795  Corr: 0.8616 
2024-06-11 12:13:50:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.6675
2024-06-11 12:14:03:INFO:VAL-(cmcm) >>
2024-06-11 12:14:03:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8775  Non0_acc_2: 0.8935  Non0_F1_score: 0.8929  Mult_acc_5: 0.6026  Mult_acc_7: 0.4847  MAE: 0.6472  Corr: 0.8661 
2024-06-11 12:14:44:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.6528
2024-06-11 12:14:56:INFO:VAL-(cmcm) >>
2024-06-11 12:14:56:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8696  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.6157  Mult_acc_7: 0.4934  MAE: 0.5979  Corr: 0.8630 
2024-06-11 12:15:05:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:15:48:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.6386
2024-06-11 12:16:00:INFO:VAL-(cmcm) >>
2024-06-11 12:16:00:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8737  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6245  Mult_acc_7: 0.5022  MAE: 0.5905  Corr: 0.8669 
2024-06-11 12:16:09:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 12:16:52:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.6321
2024-06-11 12:17:04:INFO:VAL-(cmcm) >>
2024-06-11 12:17:04:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.6026  Mult_acc_7: 0.4498  MAE: 0.6699  Corr: 0.8650 
2024-06-11 12:17:45:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 0.6278
2024-06-11 12:17:58:INFO:VAL-(cmcm) >>
2024-06-11 12:17:58:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8809  Non0_acc_2: 0.8935  Non0_F1_score: 0.8921  Mult_acc_5: 0.6376  Mult_acc_7: 0.5109  MAE: 0.6088  Corr: 0.8670 
2024-06-11 12:18:39:INFO:TRAIN-(cmcm) (3/12/5)>> loss: 0.6215
2024-06-11 12:18:51:INFO:VAL-(cmcm) >>
2024-06-11 12:18:51:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8784  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.6419  Mult_acc_7: 0.4978  MAE: 0.6328  Corr: 0.8712 
2024-06-11 12:19:33:INFO:TRAIN-(cmcm) (4/13/5)>> loss: 0.6139
2024-06-11 12:19:45:INFO:VAL-(cmcm) >>
2024-06-11 12:19:45:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8775  Non0_acc_2: 0.8935  Non0_F1_score: 0.8929  Mult_acc_5: 0.5852  Mult_acc_7: 0.4585  MAE: 0.6223  Corr: 0.8590 
2024-06-11 12:20:26:INFO:TRAIN-(cmcm) (5/14/5)>> loss: 0.6073
2024-06-11 12:20:39:INFO:VAL-(cmcm) >>
2024-06-11 12:20:39:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8730  Non0_acc_2: 0.8889  Non0_F1_score: 0.8881  Mult_acc_5: 0.6245  Mult_acc_7: 0.5066  MAE: 0.5953  Corr: 0.8622 
2024-06-11 12:21:20:INFO:TRAIN-(cmcm) (6/15/5)>> loss: 0.6002
2024-06-11 12:21:32:INFO:VAL-(cmcm) >>
2024-06-11 12:21:32:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8781  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.6114  Mult_acc_7: 0.4847  MAE: 0.6149  Corr: 0.8532 
2024-06-11 12:22:13:INFO:TRAIN-(cmcm) (7/16/5)>> loss: 0.5942
2024-06-11 12:22:26:INFO:VAL-(cmcm) >>
2024-06-11 12:22:26:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8698  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.5895  Mult_acc_7: 0.4760  MAE: 0.5979  Corr: 0.8649 
2024-06-11 12:23:07:INFO:TRAIN-(cmcm) (8/17/5)>> loss: 0.5878
2024-06-11 12:23:20:INFO:VAL-(cmcm) >>
2024-06-11 12:23:20:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.8889  Non0_F1_score: 0.8883  Mult_acc_5: 0.6026  Mult_acc_7: 0.4891  MAE: 0.6228  Corr: 0.8585 
2024-06-11 12:24:01:INFO:TRAIN-(cmcm) (9/18/5)>> loss: 0.5801
2024-06-11 12:24:13:INFO:VAL-(cmcm) >>
2024-06-11 12:24:13:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8645  Non0_acc_2: 0.8843  Non0_F1_score: 0.8836  Mult_acc_5: 0.6288  Mult_acc_7: 0.5109  MAE: 0.6057  Corr: 0.8582 
2024-06-11 12:24:54:INFO:TRAIN-(cmcm) (10/19/5)>> loss: 0.5764
2024-06-11 12:25:07:INFO:VAL-(cmcm) >>
2024-06-11 12:25:07:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8740  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.6376  Mult_acc_7: 0.5197  MAE: 0.5940  Corr: 0.8582 
2024-06-11 12:25:45:INFO:TEST-(cmcm) >>
2024-06-11 12:25:45:INFO:M: >>  Has0_acc_2: 0.8805  Has0_F1_score: 0.8801  Non0_acc_2: 0.8994  Non0_F1_score: 0.8993  Mult_acc_5: 0.5437  Mult_acc_7: 0.4606  MAE: 0.6471  Corr: 0.8521 
2024-06-11 12:25:45:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-12 10:20:44:INFO:Start running cmcm...
2024-07-12 10:20:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:20:44:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:20:44:INFO:Let's use the GPU 1 !
2024-07-12 10:20:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:20:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720750845 HTTP/1.1" 200 280
2024-07-12 10:20:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:20:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:20:46:INFO:train samples: (1284,)
2024-07-12 10:20:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:20:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720750847 HTTP/1.1" 200 280
2024-07-12 10:20:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:20:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:20:47:INFO:valid samples: (229,)
2024-07-12 10:20:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:20:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720750848 HTTP/1.1" 200 280
2024-07-12 10:20:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:20:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:20:49:INFO:test samples: (686,)
2024-07-12 10:20:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:20:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720750849 HTTP/1.1" 200 280
2024-07-12 10:20:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:20:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:21:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:21:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720750861 HTTP/1.1" 200 280
2024-07-12 10:21:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:21:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:21:05:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-12 10:23:24:INFO:TEST-(cmcm) >>
2024-07-12 10:23:24:INFO:M: >>  Has0_acc_2: 0.8805  Has0_F1_score: 0.8801  Non0_acc_2: 0.8994  Non0_F1_score: 0.8993  Mult_acc_5: 0.5437  Mult_acc_7: 0.4606  MAE: 0.6471  Corr: 0.8521 
2024-07-12 10:23:25:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-12 10:27:35:INFO:Start running cmcm...
2024-07-12 10:27:35:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:27:35:INFO:Find gpu: 2, with memory: 9584312320 left!
2024-07-12 10:27:35:INFO:Let's use the GPU 1 !
2024-07-12 10:27:43:INFO:Start running cmcm...
2024-07-12 10:27:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:27:43:INFO:Find gpu: 2, with memory: 9584312320 left!
2024-07-12 10:27:43:INFO:Let's use the GPU 1 !
2024-07-12 10:27:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:27:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720751264 HTTP/1.1" 200 280
2024-07-12 10:27:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:27:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:27:45:INFO:train samples: (1284,)
2024-07-12 10:27:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:27:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720751266 HTTP/1.1" 200 280
2024-07-12 10:27:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:27:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:27:47:INFO:valid samples: (229,)
2024-07-12 10:27:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:27:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720751267 HTTP/1.1" 200 280
2024-07-12 10:27:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:27:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:27:48:INFO:test samples: (686,)
2024-07-12 10:27:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:27:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720751269 HTTP/1.1" 200 280
2024-07-12 10:27:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:27:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:27:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:27:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720751279 HTTP/1.1" 200 280
2024-07-12 10:27:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:27:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:28:02:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-12 10:48:51:INFO:Start running cmcm...
2024-07-12 10:48:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:48:51:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:48:51:INFO:Let's use the GPU 1 !
2024-07-12 10:48:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:48:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752532 HTTP/1.1" 200 280
2024-07-12 10:48:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:48:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:48:53:INFO:train samples: (1284,)
2024-07-12 10:48:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:48:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752533 HTTP/1.1" 200 280
2024-07-12 10:48:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:48:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:48:54:INFO:valid samples: (229,)
2024-07-12 10:48:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752535 HTTP/1.1" 200 280
2024-07-12 10:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:48:56:INFO:test samples: (686,)
2024-07-12 10:48:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:48:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752536 HTTP/1.1" 200 280
2024-07-12 10:48:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:48:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:49:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:49:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752546 HTTP/1.1" 200 280
2024-07-12 10:49:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:49:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:49:10:INFO:trainable params: 2601484 || all params: 6246185484 || trainable%: 0.04164916342404282
2024-07-12 10:50:07:INFO:Start running cmcm...
2024-07-12 10:50:07:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:50:07:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:50:07:INFO:Let's use the GPU 1 !
2024-07-12 10:50:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:50:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752608 HTTP/1.1" 200 280
2024-07-12 10:50:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:50:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:50:09:INFO:train samples: (1284,)
2024-07-12 10:50:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752610 HTTP/1.1" 200 280
2024-07-12 10:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:50:10:INFO:valid samples: (229,)
2024-07-12 10:50:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:50:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752611 HTTP/1.1" 200 280
2024-07-12 10:50:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:50:12:INFO:test samples: (686,)
2024-07-12 10:50:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752612 HTTP/1.1" 200 280
2024-07-12 10:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:50:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:50:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:50:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752622 HTTP/1.1" 200 280
2024-07-12 10:50:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:50:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:50:27:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 10:52:12:INFO:Start running cmcm...
2024-07-12 10:52:12:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:52:12:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:52:12:INFO:Let's use the GPU 1 !
2024-07-12 10:52:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:52:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752733 HTTP/1.1" 200 280
2024-07-12 10:52:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:52:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:52:15:INFO:train samples: (1284,)
2024-07-12 10:52:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:52:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752736 HTTP/1.1" 200 280
2024-07-12 10:52:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:52:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:52:17:INFO:valid samples: (229,)
2024-07-12 10:52:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:52:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752738 HTTP/1.1" 200 280
2024-07-12 10:52:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:52:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:52:19:INFO:test samples: (686,)
2024-07-12 10:52:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:52:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752740 HTTP/1.1" 200 280
2024-07-12 10:52:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:52:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:52:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:52:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752750 HTTP/1.1" 200 280
2024-07-12 10:52:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:52:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:52:35:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 10:53:33:INFO:Start running cmcm...
2024-07-12 10:53:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:53:33:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:53:33:INFO:Let's use the GPU 1 !
2024-07-12 10:53:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:53:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752814 HTTP/1.1" 200 280
2024-07-12 10:53:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:53:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:53:34:INFO:train samples: (1284,)
2024-07-12 10:53:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:53:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752815 HTTP/1.1" 200 280
2024-07-12 10:53:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:53:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:53:36:INFO:valid samples: (229,)
2024-07-12 10:53:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:53:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752817 HTTP/1.1" 200 280
2024-07-12 10:53:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:53:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:53:37:INFO:test samples: (686,)
2024-07-12 10:53:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:53:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752818 HTTP/1.1" 200 280
2024-07-12 10:53:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:53:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:53:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:53:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752828 HTTP/1.1" 200 280
2024-07-12 10:53:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:53:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:53:52:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 10:56:01:INFO:Start running cmcm...
2024-07-12 10:56:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:56:01:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:56:01:INFO:Let's use the GPU 1 !
2024-07-12 10:56:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:56:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752961 HTTP/1.1" 200 280
2024-07-12 10:56:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:56:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:56:02:INFO:train samples: (1284,)
2024-07-12 10:56:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:56:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752963 HTTP/1.1" 200 280
2024-07-12 10:56:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:56:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:56:04:INFO:valid samples: (229,)
2024-07-12 10:56:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:56:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752965 HTTP/1.1" 200 280
2024-07-12 10:56:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:56:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:56:05:INFO:test samples: (686,)
2024-07-12 10:56:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:56:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752966 HTTP/1.1" 200 280
2024-07-12 10:56:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:56:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:56:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:56:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720752975 HTTP/1.1" 200 280
2024-07-12 10:56:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:56:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:56:19:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 10:59:34:INFO:Start running cmcm...
2024-07-12 10:59:34:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 10:59:34:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 10:59:34:INFO:Let's use the GPU 1 !
2024-07-12 10:59:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:59:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753175 HTTP/1.1" 200 280
2024-07-12 10:59:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:59:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:59:36:INFO:train samples: (1284,)
2024-07-12 10:59:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:59:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753177 HTTP/1.1" 200 280
2024-07-12 10:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:59:37:INFO:valid samples: (229,)
2024-07-12 10:59:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:59:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753178 HTTP/1.1" 200 280
2024-07-12 10:59:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:59:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:59:39:INFO:test samples: (686,)
2024-07-12 10:59:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:59:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753179 HTTP/1.1" 200 280
2024-07-12 10:59:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:59:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:59:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 10:59:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753189 HTTP/1.1" 200 280
2024-07-12 10:59:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 10:59:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 10:59:53:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:00:21:INFO:Start running cmcm...
2024-07-12 11:00:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:00:21:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:00:21:INFO:Let's use the GPU 1 !
2024-07-12 11:00:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:00:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753222 HTTP/1.1" 200 280
2024-07-12 11:00:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:00:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:00:22:INFO:train samples: (1284,)
2024-07-12 11:00:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:00:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753223 HTTP/1.1" 200 280
2024-07-12 11:00:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:00:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:00:24:INFO:valid samples: (229,)
2024-07-12 11:00:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:00:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753225 HTTP/1.1" 200 280
2024-07-12 11:00:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:00:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:00:25:INFO:test samples: (686,)
2024-07-12 11:00:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:00:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753226 HTTP/1.1" 200 280
2024-07-12 11:00:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:00:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:00:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:00:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753235 HTTP/1.1" 200 280
2024-07-12 11:00:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:00:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:00:39:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:01:21:INFO:Start running cmcm...
2024-07-12 11:01:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:01:21:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:01:21:INFO:Let's use the GPU 1 !
2024-07-12 11:01:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:01:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753281 HTTP/1.1" 200 280
2024-07-12 11:01:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:01:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:01:23:INFO:train samples: (1284,)
2024-07-12 11:01:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:01:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753284 HTTP/1.1" 200 280
2024-07-12 11:01:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:01:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:01:25:INFO:valid samples: (229,)
2024-07-12 11:01:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:01:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753286 HTTP/1.1" 200 280
2024-07-12 11:01:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:01:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:01:28:INFO:test samples: (686,)
2024-07-12 11:01:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:01:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753288 HTTP/1.1" 200 280
2024-07-12 11:01:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:01:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:01:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:01:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753298 HTTP/1.1" 200 280
2024-07-12 11:01:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:01:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:01:43:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:03:59:INFO:Start running cmcm...
2024-07-12 11:03:59:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:03:59:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:03:59:INFO:Let's use the GPU 1 !
2024-07-12 11:04:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:04:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753440 HTTP/1.1" 200 280
2024-07-12 11:04:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:04:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:04:02:INFO:train samples: (1284,)
2024-07-12 11:04:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:04:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753443 HTTP/1.1" 200 280
2024-07-12 11:04:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:04:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:04:03:INFO:valid samples: (229,)
2024-07-12 11:04:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:04:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753444 HTTP/1.1" 200 280
2024-07-12 11:04:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:04:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:04:05:INFO:test samples: (686,)
2024-07-12 11:04:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:04:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753445 HTTP/1.1" 200 280
2024-07-12 11:04:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:04:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:04:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:04:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753455 HTTP/1.1" 200 280
2024-07-12 11:04:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:04:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:04:19:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:08:48:INFO:Start running cmcm...
2024-07-12 11:08:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:08:48:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:08:48:INFO:Let's use the GPU 1 !
2024-07-12 11:08:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:08:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753729 HTTP/1.1" 200 280
2024-07-12 11:08:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:08:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:08:50:INFO:train samples: (1284,)
2024-07-12 11:08:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:08:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753731 HTTP/1.1" 200 280
2024-07-12 11:08:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:08:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:08:51:INFO:valid samples: (229,)
2024-07-12 11:08:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:08:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753732 HTTP/1.1" 200 280
2024-07-12 11:08:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:08:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:08:53:INFO:test samples: (686,)
2024-07-12 11:08:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:08:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753733 HTTP/1.1" 200 280
2024-07-12 11:08:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:08:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753742 HTTP/1.1" 200 280
2024-07-12 11:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:05:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:09:31:INFO:Start running cmcm...
2024-07-12 11:09:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:09:31:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:09:31:INFO:Let's use the GPU 1 !
2024-07-12 11:09:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753771 HTTP/1.1" 200 280
2024-07-12 11:09:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:33:INFO:train samples: (1284,)
2024-07-12 11:09:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753774 HTTP/1.1" 200 280
2024-07-12 11:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:35:INFO:valid samples: (229,)
2024-07-12 11:09:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753776 HTTP/1.1" 200 280
2024-07-12 11:09:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:38:INFO:test samples: (686,)
2024-07-12 11:09:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753778 HTTP/1.1" 200 280
2024-07-12 11:09:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:09:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753788 HTTP/1.1" 200 280
2024-07-12 11:09:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:09:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:09:53:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:11:12:INFO:Start running cmcm...
2024-07-12 11:11:12:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:11:12:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:11:12:INFO:Let's use the GPU 1 !
2024-07-12 11:11:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:11:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753872 HTTP/1.1" 200 280
2024-07-12 11:11:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:11:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:11:13:INFO:train samples: (1284,)
2024-07-12 11:11:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:11:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753874 HTTP/1.1" 200 280
2024-07-12 11:11:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:11:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:11:15:INFO:valid samples: (229,)
2024-07-12 11:11:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:11:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753875 HTTP/1.1" 200 280
2024-07-12 11:11:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:11:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:11:16:INFO:test samples: (686,)
2024-07-12 11:11:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:11:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753877 HTTP/1.1" 200 280
2024-07-12 11:11:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:11:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:11:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:11:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720753886 HTTP/1.1" 200 280
2024-07-12 11:11:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:11:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:11:30:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:13:48:INFO:TEST-(cmcm) >>
2024-07-12 11:13:48:INFO:M: >>  Has0_acc_2: 0.7799  Has0_F1_score: 0.7785  Non0_acc_2: 0.8232  Non0_F1_score: 0.8176  Mult_acc_5: 0.4985  Mult_acc_7: 0.4125  MAE: 0.8201  Corr: 0.7851 
2024-07-12 11:13:50:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-12 11:15:17:INFO:Start running cmcm...
2024-07-12 11:15:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:15:17:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:15:17:INFO:Let's use the GPU 1 !
2024-07-12 11:15:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:15:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754118 HTTP/1.1" 200 280
2024-07-12 11:15:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:15:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:15:19:INFO:train samples: (1284,)
2024-07-12 11:15:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:15:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754120 HTTP/1.1" 200 280
2024-07-12 11:15:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:15:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:15:20:INFO:valid samples: (229,)
2024-07-12 11:15:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:15:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754121 HTTP/1.1" 200 280
2024-07-12 11:15:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:15:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:15:22:INFO:test samples: (686,)
2024-07-12 11:15:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:15:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754122 HTTP/1.1" 200 280
2024-07-12 11:15:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:15:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:15:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754132 HTTP/1.1" 200 280
2024-07-12 11:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:15:36:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:17:04:INFO:Start running cmcm...
2024-07-12 11:17:04:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:17:04:INFO:Find gpu: 2, with memory: 9355722752 left!
2024-07-12 11:17:04:INFO:Let's use the GPU 1 !
2024-07-12 11:17:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754225 HTTP/1.1" 200 280
2024-07-12 11:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:17:07:INFO:train samples: (1284,)
2024-07-12 11:17:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:17:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754228 HTTP/1.1" 200 280
2024-07-12 11:17:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:17:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:17:08:INFO:valid samples: (229,)
2024-07-12 11:17:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:17:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754229 HTTP/1.1" 200 280
2024-07-12 11:17:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:17:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:17:11:INFO:test samples: (686,)
2024-07-12 11:17:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:17:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754231 HTTP/1.1" 200 280
2024-07-12 11:17:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:17:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:17:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:17:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754241 HTTP/1.1" 200 280
2024-07-12 11:17:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:17:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:17:26:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:18:06:INFO:Start running cmcm...
2024-07-12 11:18:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:18:06:INFO:Find gpu: 2, with memory: 9584312320 left!
2024-07-12 11:18:06:INFO:Let's use the GPU 1 !
2024-07-12 11:18:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:18:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754287 HTTP/1.1" 200 280
2024-07-12 11:18:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:18:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:18:08:INFO:train samples: (1284,)
2024-07-12 11:18:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:18:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754289 HTTP/1.1" 200 280
2024-07-12 11:18:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:18:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:18:09:INFO:valid samples: (229,)
2024-07-12 11:18:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:18:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754290 HTTP/1.1" 200 280
2024-07-12 11:18:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:18:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:18:11:INFO:test samples: (686,)
2024-07-12 11:18:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:18:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754291 HTTP/1.1" 200 280
2024-07-12 11:18:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:18:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:18:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:18:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720754301 HTTP/1.1" 200 280
2024-07-12 11:18:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:18:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:18:25:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:20:42:INFO:TEST-(cmcm) >>
2024-07-12 11:20:42:INFO:M: >>  Has0_acc_2: 0.7813  Has0_F1_score: 0.7800  Non0_acc_2: 0.8262  Non0_F1_score: 0.8208  Mult_acc_5: 0.4985  Mult_acc_7: 0.4125  MAE: 0.8192  Corr: 0.7855 
2024-07-12 11:20:43:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-12 11:36:31:INFO:Start running cmcm...
2024-07-12 11:36:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:36:31:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:36:31:INFO:Let's use the GPU 1 !
2024-07-12 11:36:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755392 HTTP/1.1" 200 280
2024-07-12 11:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:36:34:INFO:train samples: (1284,)
2024-07-12 11:36:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755395 HTTP/1.1" 200 280
2024-07-12 11:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:36:36:INFO:valid samples: (229,)
2024-07-12 11:36:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:36:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755397 HTTP/1.1" 200 280
2024-07-12 11:36:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:36:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:36:39:INFO:test samples: (686,)
2024-07-12 11:36:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:36:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755400 HTTP/1.1" 200 280
2024-07-12 11:36:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:36:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:36:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:36:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755410 HTTP/1.1" 200 280
2024-07-12 11:36:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:36:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:36:55:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:39:31:INFO:Start running cmcm...
2024-07-12 11:39:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:39:31:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:39:31:INFO:Let's use the GPU 1 !
2024-07-12 11:39:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:39:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755572 HTTP/1.1" 200 280
2024-07-12 11:39:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:39:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:39:34:INFO:train samples: (1284,)
2024-07-12 11:39:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:39:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755574 HTTP/1.1" 200 280
2024-07-12 11:39:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:39:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:39:35:INFO:valid samples: (229,)
2024-07-12 11:39:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:39:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755576 HTTP/1.1" 200 280
2024-07-12 11:39:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:39:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:39:38:INFO:test samples: (686,)
2024-07-12 11:39:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:39:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755578 HTTP/1.1" 200 280
2024-07-12 11:39:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:39:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:39:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:39:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755587 HTTP/1.1" 200 280
2024-07-12 11:39:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:39:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:39:52:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:40:17:INFO:Start running cmcm...
2024-07-12 11:40:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-12 11:40:17:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 11:40:17:INFO:Let's use the GPU 1 !
2024-07-12 11:40:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:40:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755618 HTTP/1.1" 200 280
2024-07-12 11:40:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:40:19:INFO:train samples: (1284,)
2024-07-12 11:40:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755620 HTTP/1.1" 200 280
2024-07-12 11:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:40:21:INFO:valid samples: (229,)
2024-07-12 11:40:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755621 HTTP/1.1" 200 280
2024-07-12 11:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:40:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:40:22:INFO:test samples: (686,)
2024-07-12 11:40:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:40:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755623 HTTP/1.1" 200 280
2024-07-12 11:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:40:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 11:40:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720755632 HTTP/1.1" 200 280
2024-07-12 11:40:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 11:40:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 11:40:37:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-12 11:42:54:INFO:TEST-(cmcm) >>
2024-07-12 11:42:54:INFO:M: >>  Has0_acc_2: 0.7799  Has0_F1_score: 0.7785  Non0_acc_2: 0.8247  Non0_F1_score: 0.8191  Mult_acc_5: 0.4956  Mult_acc_7: 0.4096  MAE: 0.8205  Corr: 0.7849 
2024-07-12 11:42:55:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-12 12:58:00:INFO:Start running cmcm...
2024-07-12 12:58:00:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'iemocap', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/IEMOCAP', 'seq_lens': (84, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 5240, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the label                                                 set <hap: 0, sad: 1, neu: 2, ang: 3, exc: 4, fru: 5>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'hap': 0, 'sad': 1, 'neu': 2, 'ang': 3, 'exc': 4, 'fru': 5}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 1111}>
2024-07-12 12:58:00:INFO:Find gpu: 2, with memory: 9586409472 left!
2024-07-12 12:58:00:INFO:Let's use the GPU 1 !
2024-07-12 12:58:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 12:58:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720760281 HTTP/1.1" 200 280
2024-07-12 12:58:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 12:58:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 12:58:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 12:58:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720760285 HTTP/1.1" 200 280
2024-07-12 12:58:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 12:58:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 12:58:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 12:58:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720760287 HTTP/1.1" 200 280
2024-07-12 12:58:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 12:58:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 12:58:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 12:58:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720760289 HTTP/1.1" 200 280
2024-07-12 12:58:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 12:58:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 12:58:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-12 12:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720760298 HTTP/1.1" 200 280
2024-07-12 12:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-12 12:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-12 12:58:22:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-12 13:01:28:INFO:TEST-(cmcm) >>
2024-07-12 13:01:28:INFO:M: >>  acc: 0.2226  weight_F1: 0.1915 
2024-07-12 13:01:30:INFO:Results are added to results/results/iemocap-classification-50.csv...
2024-07-14 20:23:10:INFO:Start running cmcm...
2024-07-14 20:23:10:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-14 20:23:10:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-14 20:23:10:INFO:Let's use the GPU 1 !
2024-07-14 20:23:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:23:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959797 HTTP/1.1" 200 280
2024-07-14 20:23:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:23:26:INFO:train samples: (16326,)
2024-07-14 20:23:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959814 HTTP/1.1" 200 280
2024-07-14 20:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:23:35:INFO:valid samples: (1871,)
2024-07-14 20:23:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:23:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959822 HTTP/1.1" 200 280
2024-07-14 20:23:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:23:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:23:44:INFO:test samples: (4659,)
2024-07-14 20:23:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:23:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959825 HTTP/1.1" 200 280
2024-07-14 20:23:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:23:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:23:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:23:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959834 HTTP/1.1" 200 280
2024-07-14 20:23:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:23:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:23:57:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-14 20:23:57:INFO:Init labels...
2024-07-14 20:23:57:INFO:Start training...
2024-07-14 20:24:34:INFO:Start running cmcm...
2024-07-14 20:24:34:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the target                                                 set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 1111}>
2024-07-14 20:24:34:INFO:Find gpu: 2, with memory: 378273792 left!
2024-07-14 20:24:34:INFO:Let's use the GPU 1 !
2024-07-14 20:24:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:24:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959876 HTTP/1.1" 200 280
2024-07-14 20:24:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:24:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:24:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:24:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959882 HTTP/1.1" 200 280
2024-07-14 20:24:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:24:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:24:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:24:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959883 HTTP/1.1" 200 280
2024-07-14 20:24:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:24:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:24:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:24:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959885 HTTP/1.1" 200 280
2024-07-14 20:24:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:24:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:24:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 20:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720959894 HTTP/1.1" 200 280
2024-07-14 20:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 20:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 20:24:57:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-14 20:24:57:INFO:Init labels...
2024-07-14 20:24:57:INFO:Start training...
2024-07-14 20:32:23:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.6841
2024-07-14 20:33:01:INFO:VAL-(cmcm) >>
2024-07-14 20:33:01:INFO:M: >>  acc: 0.4247  weight_F1: 0.2581 
2024-07-14 20:33:07:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2024-07-14 20:33:33:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 0.7427
2024-07-14 20:35:18:INFO:VAL-(cmcm) >>
2024-07-14 20:35:18:INFO:M: >>  Has0_acc_2: 0.8455  Has0_F1_score: 0.8333  Non0_acc_2: 0.6252  Non0_F1_score: 0.6181  Mult_acc_5: 0.5243  Mult_acc_7: 0.5056  MAE: 0.6247  Corr: 0.6836 
2024-07-14 20:35:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-14 20:40:43:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.7309
2024-07-14 20:41:22:INFO:VAL-(cmcm) >>
2024-07-14 20:41:22:INFO:M: >>  acc: 0.4292  weight_F1: 0.3569 
2024-07-14 20:41:28:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2024-07-14 20:45:06:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.5391
2024-07-14 20:46:52:INFO:VAL-(cmcm) >>
2024-07-14 20:46:52:INFO:M: >>  Has0_acc_2: 0.8520  Has0_F1_score: 0.8406  Non0_acc_2: 0.6085  Non0_F1_score: 0.5969  Mult_acc_5: 0.5537  Mult_acc_7: 0.5270  MAE: 0.5825  Corr: 0.7096 
2024-07-14 20:46:57:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2024-07-14 20:49:03:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.6963
2024-07-14 20:49:42:INFO:VAL-(cmcm) >>
2024-07-14 20:49:42:INFO:M: >>  acc: 0.4671  weight_F1: 0.4223 
2024-07-14 20:49:48:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2024-07-14 20:56:35:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5274
2024-07-14 20:57:22:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.6535
2024-07-14 20:58:01:INFO:VAL-(cmcm) >>
2024-07-14 20:58:01:INFO:M: >>  acc: 0.5041  weight_F1: 0.4944 
2024-07-14 20:58:07:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2024-07-14 20:58:20:INFO:VAL-(cmcm) >>
2024-07-14 20:58:20:INFO:M: >>  Has0_acc_2: 0.8696  Has0_F1_score: 0.8674  Non0_acc_2: 0.7552  Non0_F1_score: 0.7603  Mult_acc_5: 0.5478  Mult_acc_7: 0.5227  MAE: 0.5845  Corr: 0.7486 
2024-07-14 21:05:42:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.6100
2024-07-14 21:06:21:INFO:VAL-(cmcm) >>
2024-07-14 21:06:21:INFO:M: >>  acc: 0.5338  weight_F1: 0.5260 
2024-07-14 21:06:27:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2024-07-14 21:08:06:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.5192
2024-07-14 21:09:53:INFO:VAL-(cmcm) >>
2024-07-14 21:09:53:INFO:M: >>  Has0_acc_2: 0.8712  Has0_F1_score: 0.8688  Non0_acc_2: 0.7350  Non0_F1_score: 0.7395  Mult_acc_5: 0.5740  Mult_acc_7: 0.5559  MAE: 0.5064  Corr: 0.7612 
2024-07-14 21:10:02:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2024-07-14 21:13:59:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.5767
2024-07-14 21:14:37:INFO:VAL-(cmcm) >>
2024-07-14 21:14:37:INFO:M: >>  acc: 0.5879  weight_F1: 0.5652 
2024-07-14 21:14:44:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2024-07-14 21:19:43:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.5122
2024-07-14 21:21:30:INFO:VAL-(cmcm) >>
2024-07-14 21:21:30:INFO:M: >>  Has0_acc_2: 0.8712  Has0_F1_score: 0.8653  Non0_acc_2: 0.7406  Non0_F1_score: 0.7450  Mult_acc_5: 0.5697  Mult_acc_7: 0.5452  MAE: 0.5265  Corr: 0.7485 
2024-07-14 21:22:18:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5544
2024-07-14 21:22:57:INFO:VAL-(cmcm) >>
2024-07-14 21:22:57:INFO:M: >>  acc: 0.5960  weight_F1: 0.5519 
2024-07-14 21:30:34:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.5337
2024-07-14 21:31:07:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.5087
2024-07-14 21:31:13:INFO:VAL-(cmcm) >>
2024-07-14 21:31:13:INFO:M: >>  acc: 0.6465  weight_F1: 0.6344 
2024-07-14 21:31:21:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2024-07-14 21:32:54:INFO:VAL-(cmcm) >>
2024-07-14 21:32:54:INFO:M: >>  Has0_acc_2: 0.8691  Has0_F1_score: 0.8637  Non0_acc_2: 0.7114  Non0_F1_score: 0.7145  Mult_acc_5: 0.5751  Mult_acc_7: 0.5575  MAE: 0.4991  Corr: 0.7558 
2024-07-14 21:33:01:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-14 21:38:59:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.5193
2024-07-14 21:39:38:INFO:VAL-(cmcm) >>
2024-07-14 21:39:38:INFO:M: >>  acc: 0.6384  weight_F1: 0.6284 
2024-07-14 21:42:45:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5057
2024-07-14 21:44:32:INFO:VAL-(cmcm) >>
2024-07-14 21:44:32:INFO:M: >>  Has0_acc_2: 0.8675  Has0_F1_score: 0.8606  Non0_acc_2: 0.7406  Non0_F1_score: 0.7451  Mult_acc_5: 0.5794  Mult_acc_7: 0.5575  MAE: 0.5073  Corr: 0.7609 
2024-07-14 21:47:15:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.5069
2024-07-14 21:47:54:INFO:VAL-(cmcm) >>
2024-07-14 21:47:54:INFO:M: >>  acc: 0.6393  weight_F1: 0.6254 
2024-07-14 21:54:15:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.5036
2024-07-14 21:55:31:INFO:TRAIN-(cmcm) (3/11/1)>> loss: 0.4985
2024-07-14 21:56:02:INFO:VAL-(cmcm) >>
2024-07-14 21:56:02:INFO:M: >>  Has0_acc_2: 0.8733  Has0_F1_score: 0.8722  Non0_acc_2: 0.7010  Non0_F1_score: 0.7034  Mult_acc_5: 0.5810  Mult_acc_7: 0.5564  MAE: 0.5164  Corr: 0.7571 
2024-07-14 21:56:10:INFO:VAL-(cmcm) >>
2024-07-14 21:56:10:INFO:M: >>  acc: 0.6537  weight_F1: 0.6292 
2024-07-14 22:03:58:INFO:TRAIN-(cmcm) (4/12/1)>> loss: 0.4884
2024-07-14 22:04:37:INFO:VAL-(cmcm) >>
2024-07-14 22:04:37:INFO:M: >>  acc: 0.6628  weight_F1: 0.6462 
2024-07-14 22:04:43:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2024-07-14 22:05:45:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.5005
2024-07-14 22:07:31:INFO:VAL-(cmcm) >>
2024-07-14 22:07:31:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8686  Non0_acc_2: 0.6579  Non0_F1_score: 0.6559  Mult_acc_5: 0.5735  Mult_acc_7: 0.5500  MAE: 0.5270  Corr: 0.7396 
2024-07-14 22:12:15:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.4843
2024-07-14 22:12:54:INFO:VAL-(cmcm) >>
2024-07-14 22:12:54:INFO:M: >>  acc: 0.6691  weight_F1: 0.6619 
2024-07-14 22:13:00:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2024-07-14 22:16:50:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.4980
2024-07-14 22:18:36:INFO:VAL-(cmcm) >>
2024-07-14 22:18:36:INFO:M: >>  Has0_acc_2: 0.8765  Has0_F1_score: 0.8756  Non0_acc_2: 0.7462  Non0_F1_score: 0.7509  Mult_acc_5: 0.5697  Mult_acc_7: 0.5462  MAE: 0.5381  Corr: 0.7701 
2024-07-14 22:20:30:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.4785
2024-07-14 22:21:09:INFO:VAL-(cmcm) >>
2024-07-14 22:21:09:INFO:M: >>  acc: 0.6646  weight_F1: 0.6580 
2024-07-14 22:27:56:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.4962
2024-07-14 22:28:38:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.4749
2024-07-14 22:29:17:INFO:VAL-(cmcm) >>
2024-07-14 22:29:17:INFO:M: >>  acc: 0.6655  weight_F1: 0.6564 
2024-07-14 22:29:41:INFO:VAL-(cmcm) >>
2024-07-14 22:29:41:INFO:M: >>  Has0_acc_2: 0.8744  Has0_F1_score: 0.8708  Non0_acc_2: 0.7038  Non0_F1_score: 0.7065  Mult_acc_5: 0.5692  Mult_acc_7: 0.5452  MAE: 0.5193  Corr: 0.7574 
2024-07-14 22:36:45:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.4702
2024-07-14 22:37:24:INFO:VAL-(cmcm) >>
2024-07-14 22:37:24:INFO:M: >>  acc: 0.6537  weight_F1: 0.6430 
2024-07-14 22:39:02:INFO:TRAIN-(cmcm) (6/12/1)>> loss: 0.4914
2024-07-14 22:40:48:INFO:VAL-(cmcm) >>
2024-07-14 22:40:48:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8720  Non0_acc_2: 0.7253  Non0_F1_score: 0.7292  Mult_acc_5: 0.5746  Mult_acc_7: 0.5489  MAE: 0.5123  Corr: 0.7645 
2024-07-14 22:44:53:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.4650
2024-07-14 22:45:31:INFO:VAL-(cmcm) >>
2024-07-14 22:45:31:INFO:M: >>  acc: 0.6700  weight_F1: 0.6505 
2024-07-14 22:50:10:INFO:TRAIN-(cmcm) (7/13/1)>> loss: 0.4889
2024-07-14 22:51:56:INFO:VAL-(cmcm) >>
2024-07-14 22:51:56:INFO:M: >>  Has0_acc_2: 0.8707  Has0_F1_score: 0.8661  Non0_acc_2: 0.7017  Non0_F1_score: 0.7035  Mult_acc_5: 0.5836  Mult_acc_7: 0.5569  MAE: 0.5147  Corr: 0.7646 
2024-07-14 22:52:59:INFO:TRAIN-(cmcm) (5/18/1)>> loss: 0.4616
2024-07-14 22:53:37:INFO:VAL-(cmcm) >>
2024-07-14 22:53:37:INFO:M: >>  acc: 0.6646  weight_F1: 0.6515 
2024-07-14 23:01:05:INFO:TRAIN-(cmcm) (6/19/1)>> loss: 0.4580
2024-07-14 23:01:18:INFO:TRAIN-(cmcm) (8/14/1)>> loss: 0.4874
2024-07-14 23:01:43:INFO:VAL-(cmcm) >>
2024-07-14 23:01:43:INFO:M: >>  acc: 0.6682  weight_F1: 0.6606 
2024-07-14 23:03:04:INFO:VAL-(cmcm) >>
2024-07-14 23:03:04:INFO:M: >>  Has0_acc_2: 0.8760  Has0_F1_score: 0.8728  Non0_acc_2: 0.6759  Non0_F1_score: 0.6754  Mult_acc_5: 0.5901  Mult_acc_7: 0.5708  MAE: 0.4965  Corr: 0.7646 
2024-07-14 23:03:10:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosei-regression.pth.
2024-07-14 23:09:11:INFO:TRAIN-(cmcm) (7/20/1)>> loss: 0.4538
2024-07-14 23:09:49:INFO:VAL-(cmcm) >>
2024-07-14 23:09:49:INFO:M: >>  acc: 0.6619  weight_F1: 0.6562 
2024-07-14 23:12:35:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.4853
2024-07-14 23:14:21:INFO:VAL-(cmcm) >>
2024-07-14 23:14:21:INFO:M: >>  Has0_acc_2: 0.8755  Has0_F1_score: 0.8750  Non0_acc_2: 0.7197  Non0_F1_score: 0.7233  Mult_acc_5: 0.5751  Mult_acc_7: 0.5532  MAE: 0.5258  Corr: 0.7671 
2024-07-14 23:17:17:INFO:TRAIN-(cmcm) (8/21/1)>> loss: 0.4528
2024-07-14 23:17:55:INFO:VAL-(cmcm) >>
2024-07-14 23:17:55:INFO:M: >>  acc: 0.6682  weight_F1: 0.6599 
2024-07-14 23:19:26:INFO:TEST-(cmcm) >>
2024-07-14 23:19:26:INFO:M: >>  acc: 0.6667  weight_F1: 0.6570 
2024-07-14 23:19:27:INFO:Results are added to results/results/meld-classification-90.csv...
2024-07-14 23:19:27:INFO:Start running cmcm...
2024-07-14 23:19:27:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the target                                                 set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 2222}>
2024-07-14 23:19:27:INFO:Let's use the GPU 1 !
2024-07-14 23:19:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 23:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720970369 HTTP/1.1" 200 280
2024-07-14 23:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 23:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 23:19:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 23:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720970374 HTTP/1.1" 200 280
2024-07-14 23:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 23:19:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 23:19:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 23:19:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720970376 HTTP/1.1" 200 280
2024-07-14 23:19:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 23:19:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 23:19:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 23:19:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720970378 HTTP/1.1" 200 280
2024-07-14 23:19:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 23:19:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 23:19:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-14 23:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720970386 HTTP/1.1" 200 280
2024-07-14 23:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-14 23:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-14 23:19:48:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-14 23:19:48:INFO:Init labels...
2024-07-14 23:19:48:INFO:Start training...
2024-07-14 23:23:42:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.4836
2024-07-14 23:25:28:INFO:VAL-(cmcm) >>
2024-07-14 23:25:28:INFO:M: >>  Has0_acc_2: 0.8755  Has0_F1_score: 0.8760  Non0_acc_2: 0.7267  Non0_F1_score: 0.7303  Mult_acc_5: 0.5687  Mult_acc_7: 0.5425  MAE: 0.5169  Corr: 0.7682 
2024-07-14 23:27:16:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.8319
2024-07-14 23:27:55:INFO:VAL-(cmcm) >>
2024-07-14 23:27:55:INFO:M: >>  acc: 0.4256  weight_F1: 0.2629 
2024-07-14 23:28:00:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2024-07-14 23:34:50:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.4817
2024-07-14 23:35:29:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.7264
2024-07-14 23:36:07:INFO:VAL-(cmcm) >>
2024-07-14 23:36:07:INFO:M: >>  acc: 0.4256  weight_F1: 0.2998 
2024-07-14 23:36:13:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2024-07-14 23:36:36:INFO:VAL-(cmcm) >>
2024-07-14 23:36:36:INFO:M: >>  Has0_acc_2: 0.8808  Has0_F1_score: 0.8813  Non0_acc_2: 0.7587  Non0_F1_score: 0.7633  Mult_acc_5: 0.5804  Mult_acc_7: 0.5553  MAE: 0.5044  Corr: 0.7719 
2024-07-14 23:43:42:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.6930
2024-07-14 23:44:21:INFO:VAL-(cmcm) >>
2024-07-14 23:44:21:INFO:M: >>  acc: 0.4788  weight_F1: 0.4305 
2024-07-14 23:44:26:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2024-07-14 23:45:57:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.4804
2024-07-14 23:47:43:INFO:VAL-(cmcm) >>
2024-07-14 23:47:43:INFO:M: >>  Has0_acc_2: 0.8755  Has0_F1_score: 0.8725  Non0_acc_2: 0.6940  Non0_F1_score: 0.6954  Mult_acc_5: 0.5847  Mult_acc_7: 0.5596  MAE: 0.5071  Corr: 0.7639 
2024-07-14 23:51:55:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.6412
2024-07-14 23:52:34:INFO:VAL-(cmcm) >>
2024-07-14 23:52:34:INFO:M: >>  acc: 0.5455  weight_F1: 0.5121 
2024-07-14 23:52:40:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2024-07-14 23:57:33:INFO:TRAIN-(cmcm) (5/19/1)>> loss: 0.4789
2024-07-14 23:59:19:INFO:VAL-(cmcm) >>
2024-07-14 23:59:19:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8682  Non0_acc_2: 0.6947  Non0_F1_score: 0.6961  Mult_acc_5: 0.5890  Mult_acc_7: 0.5692  MAE: 0.5004  Corr: 0.7665 
2024-07-15 00:00:09:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.5785
2024-07-15 00:00:47:INFO:VAL-(cmcm) >>
2024-07-15 00:00:47:INFO:M: >>  acc: 0.6141  weight_F1: 0.5880 
2024-07-15 00:00:53:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2024-07-15 00:08:22:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.5452
2024-07-15 00:08:43:INFO:TRAIN-(cmcm) (6/20/1)>> loss: 0.4773
2024-07-15 00:09:01:INFO:VAL-(cmcm) >>
2024-07-15 00:09:01:INFO:M: >>  acc: 0.6032  weight_F1: 0.5686 
2024-07-15 00:10:29:INFO:VAL-(cmcm) >>
2024-07-15 00:10:29:INFO:M: >>  Has0_acc_2: 0.8776  Has0_F1_score: 0.8782  Non0_acc_2: 0.6933  Non0_F1_score: 0.6944  Mult_acc_5: 0.5810  Mult_acc_7: 0.5569  MAE: 0.5089  Corr: 0.7637 
2024-07-15 00:16:29:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.5265
2024-07-15 00:17:08:INFO:VAL-(cmcm) >>
2024-07-15 00:17:08:INFO:M: >>  acc: 0.6186  weight_F1: 0.5982 
2024-07-15 00:17:14:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2024-07-15 00:19:49:INFO:TRAIN-(cmcm) (7/21/1)>> loss: 0.4761
2024-07-15 00:21:35:INFO:VAL-(cmcm) >>
2024-07-15 00:21:35:INFO:M: >>  Has0_acc_2: 0.8733  Has0_F1_score: 0.8701  Non0_acc_2: 0.6919  Non0_F1_score: 0.6925  Mult_acc_5: 0.5826  Mult_acc_7: 0.5559  MAE: 0.5115  Corr: 0.7625 
2024-07-15 00:24:43:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.5123
2024-07-15 00:25:21:INFO:VAL-(cmcm) >>
2024-07-15 00:25:21:INFO:M: >>  acc: 0.6402  weight_F1: 0.6236 
2024-07-15 00:25:27:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2024-07-15 00:30:58:INFO:TRAIN-(cmcm) (8/22/1)>> loss: 0.4746
2024-07-15 00:32:44:INFO:VAL-(cmcm) >>
2024-07-15 00:32:44:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8647  Non0_acc_2: 0.6940  Non0_F1_score: 0.6951  Mult_acc_5: 0.5847  Mult_acc_7: 0.5639  MAE: 0.5074  Corr: 0.7625 
2024-07-15 00:32:56:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.5063
2024-07-15 00:33:34:INFO:VAL-(cmcm) >>
2024-07-15 00:33:34:INFO:M: >>  acc: 0.6231  weight_F1: 0.6099 
2024-07-15 00:41:02:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.4992
2024-07-15 00:41:40:INFO:VAL-(cmcm) >>
2024-07-15 00:41:40:INFO:M: >>  acc: 0.6583  weight_F1: 0.6362 
2024-07-15 00:41:46:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2024-07-15 00:42:06:INFO:TRAIN-(cmcm) (9/23/1)>> loss: 0.4734
2024-07-15 00:43:52:INFO:VAL-(cmcm) >>
2024-07-15 00:43:52:INFO:M: >>  Has0_acc_2: 0.8765  Has0_F1_score: 0.8736  Non0_acc_2: 0.7149  Non0_F1_score: 0.7177  Mult_acc_5: 0.5719  Mult_acc_7: 0.5457  MAE: 0.5168  Corr: 0.7694 
2024-07-15 00:49:15:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.4914
2024-07-15 00:49:54:INFO:VAL-(cmcm) >>
2024-07-15 00:49:54:INFO:M: >>  acc: 0.6447  weight_F1: 0.6256 
2024-07-15 00:53:12:INFO:TRAIN-(cmcm) (10/24/1)>> loss: 0.4724
2024-07-15 00:54:58:INFO:VAL-(cmcm) >>
2024-07-15 00:54:58:INFO:M: >>  Has0_acc_2: 0.8744  Has0_F1_score: 0.8732  Non0_acc_2: 0.7135  Non0_F1_score: 0.7161  Mult_acc_5: 0.5788  Mult_acc_7: 0.5537  MAE: 0.5106  Corr: 0.7678 
2024-07-15 00:57:22:INFO:TRAIN-(cmcm) (2/12/2)>> loss: 0.4861
2024-07-15 00:58:00:INFO:VAL-(cmcm) >>
2024-07-15 00:58:00:INFO:M: >>  acc: 0.6646  weight_F1: 0.6417 
2024-07-15 00:58:06:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2024-07-15 00:59:17:INFO:TEST-(cmcm) >>
2024-07-15 00:59:17:INFO:M: >>  Has0_acc_2: 0.8682  Has0_F1_score: 0.8652  Non0_acc_2: 0.6965  Non0_F1_score: 0.6952  Mult_acc_5: 0.5679  Mult_acc_7: 0.5471  MAE: 0.5183  Corr: 0.7746 
2024-07-15 00:59:18:INFO:Results are added to results/results/mosei-regression-30.csv...
2024-07-15 00:59:18:INFO:Start running cmcm...
2024-07-15 00:59:18:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-07-15 00:59:18:INFO:Let's use the GPU 1 !
2024-07-15 00:59:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 00:59:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720976364 HTTP/1.1" 200 280
2024-07-15 00:59:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 00:59:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 00:59:30:INFO:train samples: (16326,)
2024-07-15 00:59:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 00:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720976377 HTTP/1.1" 200 280
2024-07-15 00:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 00:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 00:59:38:INFO:valid samples: (1871,)
2024-07-15 00:59:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 00:59:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720976385 HTTP/1.1" 200 280
2024-07-15 00:59:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 00:59:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 00:59:47:INFO:test samples: (4659,)
2024-07-15 00:59:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 00:59:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720976388 HTTP/1.1" 200 280
2024-07-15 00:59:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 00:59:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 00:59:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 00:59:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720976397 HTTP/1.1" 200 280
2024-07-15 00:59:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 00:59:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 01:00:00:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-15 01:00:00:INFO:Init labels...
2024-07-15 01:00:00:INFO:Start training...
2024-07-15 01:05:35:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.4804
2024-07-15 01:06:14:INFO:VAL-(cmcm) >>
2024-07-15 01:06:14:INFO:M: >>  acc: 0.6610  weight_F1: 0.6403 
2024-07-15 01:09:30:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 0.7198
2024-07-15 01:11:14:INFO:VAL-(cmcm) >>
2024-07-15 01:11:14:INFO:M: >>  Has0_acc_2: 0.8375  Has0_F1_score: 0.8250  Non0_acc_2: 0.5549  Non0_F1_score: 0.5300  Mult_acc_5: 0.5291  Mult_acc_7: 0.5083  MAE: 0.6133  Corr: 0.6357 
2024-07-15 01:11:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-15 01:13:42:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.4771
2024-07-15 01:14:20:INFO:VAL-(cmcm) >>
2024-07-15 01:14:20:INFO:M: >>  acc: 0.6745  weight_F1: 0.6621 
2024-07-15 01:14:26:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-meld-classification.pth.
2024-07-15 01:20:28:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.5477
2024-07-15 01:21:55:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.4723
2024-07-15 01:22:11:INFO:VAL-(cmcm) >>
2024-07-15 01:22:11:INFO:M: >>  Has0_acc_2: 0.8498  Has0_F1_score: 0.8507  Non0_acc_2: 0.7990  Non0_F1_score: 0.8034  Mult_acc_5: 0.5184  Mult_acc_7: 0.5003  MAE: 0.6137  Corr: 0.7144 
2024-07-15 01:22:33:INFO:VAL-(cmcm) >>
2024-07-15 01:22:33:INFO:M: >>  acc: 0.6537  weight_F1: 0.6385 
2024-07-15 01:30:01:INFO:TRAIN-(cmcm) (2/16/2)>> loss: 0.4695
2024-07-15 01:30:39:INFO:VAL-(cmcm) >>
2024-07-15 01:30:39:INFO:M: >>  acc: 0.6637  weight_F1: 0.6553 
2024-07-15 01:31:18:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.5368
2024-07-15 01:33:01:INFO:VAL-(cmcm) >>
2024-07-15 01:33:01:INFO:M: >>  Has0_acc_2: 0.8482  Has0_F1_score: 0.8393  Non0_acc_2: 0.8018  Non0_F1_score: 0.8055  Mult_acc_5: 0.5094  Mult_acc_7: 0.4917  MAE: 0.5858  Corr: 0.7221 
2024-07-15 01:33:07:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2024-07-15 01:38:08:INFO:TRAIN-(cmcm) (3/17/2)>> loss: 0.4663
2024-07-15 01:38:46:INFO:VAL-(cmcm) >>
2024-07-15 01:38:46:INFO:M: >>  acc: 0.6673  weight_F1: 0.6471 
2024-07-15 01:42:15:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.5270
2024-07-15 01:43:58:INFO:VAL-(cmcm) >>
2024-07-15 01:43:58:INFO:M: >>  Has0_acc_2: 0.8525  Has0_F1_score: 0.8419  Non0_acc_2: 0.7399  Non0_F1_score: 0.7451  Mult_acc_5: 0.5542  Mult_acc_7: 0.5387  MAE: 0.5356  Corr: 0.7306 
2024-07-15 01:44:04:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2024-07-15 01:46:14:INFO:TRAIN-(cmcm) (4/18/2)>> loss: 0.4628
2024-07-15 01:46:53:INFO:VAL-(cmcm) >>
2024-07-15 01:46:53:INFO:M: >>  acc: 0.6646  weight_F1: 0.6457 
2024-07-15 01:53:11:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.5215
2024-07-15 01:54:21:INFO:TRAIN-(cmcm) (5/19/2)>> loss: 0.4608
2024-07-15 01:54:55:INFO:VAL-(cmcm) >>
2024-07-15 01:54:55:INFO:M: >>  Has0_acc_2: 0.8642  Has0_F1_score: 0.8585  Non0_acc_2: 0.7392  Non0_F1_score: 0.7435  Mult_acc_5: 0.5591  Mult_acc_7: 0.5425  MAE: 0.5423  Corr: 0.7411 
2024-07-15 01:55:00:INFO:VAL-(cmcm) >>
2024-07-15 01:55:00:INFO:M: >>  acc: 0.6664  weight_F1: 0.6536 
2024-07-15 02:02:27:INFO:TRAIN-(cmcm) (6/20/2)>> loss: 0.4575
2024-07-15 02:03:06:INFO:VAL-(cmcm) >>
2024-07-15 02:03:06:INFO:M: >>  acc: 0.6709  weight_F1: 0.6552 
2024-07-15 02:04:00:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.5137
2024-07-15 02:05:44:INFO:VAL-(cmcm) >>
2024-07-15 02:05:44:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8698  Non0_acc_2: 0.6273  Non0_F1_score: 0.6191  Mult_acc_5: 0.5810  Mult_acc_7: 0.5639  MAE: 0.5225  Corr: 0.7340 
2024-07-15 02:05:50:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-15 02:10:34:INFO:TRAIN-(cmcm) (7/21/2)>> loss: 0.4546
2024-07-15 02:11:12:INFO:VAL-(cmcm) >>
2024-07-15 02:11:12:INFO:M: >>  acc: 0.6727  weight_F1: 0.6607 
2024-07-15 02:15:27:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.5085
2024-07-15 02:17:11:INFO:VAL-(cmcm) >>
2024-07-15 02:17:11:INFO:M: >>  Has0_acc_2: 0.8669  Has0_F1_score: 0.8685  Non0_acc_2: 0.7503  Non0_F1_score: 0.7551  Mult_acc_5: 0.5473  Mult_acc_7: 0.5307  MAE: 0.5323  Corr: 0.7417 
2024-07-15 02:18:40:INFO:TRAIN-(cmcm) (8/22/2)>> loss: 0.4537
2024-07-15 02:19:18:INFO:VAL-(cmcm) >>
2024-07-15 02:19:18:INFO:M: >>  acc: 0.6763  weight_F1: 0.6641 
2024-07-15 02:19:24:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-meld-classification.pth.
2024-07-15 02:26:47:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.5057
2024-07-15 02:26:53:INFO:TRAIN-(cmcm) (1/23/2)>> loss: 0.4509
2024-07-15 02:27:31:INFO:VAL-(cmcm) >>
2024-07-15 02:27:31:INFO:M: >>  acc: 0.6709  weight_F1: 0.6531 
2024-07-15 02:28:30:INFO:VAL-(cmcm) >>
2024-07-15 02:28:30:INFO:M: >>  Has0_acc_2: 0.8642  Has0_F1_score: 0.8588  Non0_acc_2: 0.8081  Non0_F1_score: 0.8123  Mult_acc_5: 0.5286  Mult_acc_7: 0.5104  MAE: 0.5668  Corr: 0.7556 
2024-07-15 02:34:59:INFO:TRAIN-(cmcm) (2/24/2)>> loss: 0.4475
2024-07-15 02:35:37:INFO:VAL-(cmcm) >>
2024-07-15 02:35:37:INFO:M: >>  acc: 0.6727  weight_F1: 0.6600 
2024-07-15 02:37:40:INFO:TRAIN-(cmcm) (3/9/2)>> loss: 0.5033
2024-07-15 02:39:23:INFO:VAL-(cmcm) >>
2024-07-15 02:39:23:INFO:M: >>  Has0_acc_2: 0.8712  Has0_F1_score: 0.8681  Non0_acc_2: 0.7038  Non0_F1_score: 0.7067  Mult_acc_5: 0.5633  Mult_acc_7: 0.5462  MAE: 0.5248  Corr: 0.7386 
2024-07-15 02:43:05:INFO:TRAIN-(cmcm) (3/25/2)>> loss: 0.4450
2024-07-15 02:43:44:INFO:VAL-(cmcm) >>
2024-07-15 02:43:44:INFO:M: >>  acc: 0.6655  weight_F1: 0.6545 
2024-07-15 02:48:36:INFO:TRAIN-(cmcm) (4/10/2)>> loss: 0.5003
2024-07-15 02:50:20:INFO:VAL-(cmcm) >>
2024-07-15 02:50:20:INFO:M: >>  Has0_acc_2: 0.8813  Has0_F1_score: 0.8792  Non0_acc_2: 0.7448  Non0_F1_score: 0.7491  Mult_acc_5: 0.5692  Mult_acc_7: 0.5510  MAE: 0.5181  Corr: 0.7597 
2024-07-15 02:50:26:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2024-07-15 02:51:11:INFO:TRAIN-(cmcm) (4/26/2)>> loss: 0.4440
2024-07-15 02:51:50:INFO:VAL-(cmcm) >>
2024-07-15 02:51:50:INFO:M: >>  acc: 0.6700  weight_F1: 0.6556 
2024-07-15 02:59:18:INFO:TRAIN-(cmcm) (5/27/2)>> loss: 0.4417
2024-07-15 02:59:56:INFO:VAL-(cmcm) >>
2024-07-15 02:59:56:INFO:M: >>  acc: 0.6664  weight_F1: 0.6523 
2024-07-15 02:59:58:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.4975
2024-07-15 03:01:42:INFO:VAL-(cmcm) >>
2024-07-15 03:01:42:INFO:M: >>  Has0_acc_2: 0.8685  Has0_F1_score: 0.8628  Non0_acc_2: 0.6926  Non0_F1_score: 0.6948  Mult_acc_5: 0.5617  Mult_acc_7: 0.5462  MAE: 0.5092  Corr: 0.7484 
2024-07-15 03:01:49:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2024-07-15 03:07:24:INFO:TRAIN-(cmcm) (6/28/2)>> loss: 0.4403
2024-07-15 03:08:02:INFO:VAL-(cmcm) >>
2024-07-15 03:08:02:INFO:M: >>  acc: 0.6709  weight_F1: 0.6559 
2024-07-15 03:11:16:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.4958
2024-07-15 03:13:00:INFO:VAL-(cmcm) >>
2024-07-15 03:13:00:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8658  Non0_acc_2: 0.6780  Non0_F1_score: 0.6790  Mult_acc_5: 0.5778  Mult_acc_7: 0.5623  MAE: 0.5064  Corr: 0.7441 
2024-07-15 03:13:06:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2024-07-15 03:15:29:INFO:TRAIN-(cmcm) (7/29/2)>> loss: 0.4374
2024-07-15 03:16:08:INFO:VAL-(cmcm) >>
2024-07-15 03:16:08:INFO:M: >>  acc: 0.6628  weight_F1: 0.6487 
2024-07-15 03:22:36:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.4938
2024-07-15 03:23:34:INFO:TRAIN-(cmcm) (8/30/2)>> loss: 0.4360
2024-07-15 03:24:12:INFO:VAL-(cmcm) >>
2024-07-15 03:24:12:INFO:M: >>  acc: 0.6700  weight_F1: 0.6569 
2024-07-15 03:24:20:INFO:VAL-(cmcm) >>
2024-07-15 03:24:20:INFO:M: >>  Has0_acc_2: 0.8755  Has0_F1_score: 0.8736  Non0_acc_2: 0.7643  Non0_F1_score: 0.7693  Mult_acc_5: 0.5436  Mult_acc_7: 0.5238  MAE: 0.5469  Corr: 0.7535 
2024-07-15 03:25:43:INFO:TEST-(cmcm) >>
2024-07-15 03:25:43:INFO:M: >>  acc: 0.6789  weight_F1: 0.6622 
2024-07-15 03:25:43:INFO:Results are added to results/results/meld-classification-90.csv...
2024-07-15 03:25:43:INFO:Start running cmcm...
2024-07-15 03:25:43:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the target                                                 set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 3333}>
2024-07-15 03:25:43:INFO:Let's use the GPU 1 !
2024-07-15 03:25:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 03:25:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720985145 HTTP/1.1" 200 280
2024-07-15 03:25:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 03:25:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 03:25:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 03:25:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720985150 HTTP/1.1" 200 280
2024-07-15 03:25:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 03:25:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 03:25:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 03:25:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720985151 HTTP/1.1" 200 280
2024-07-15 03:25:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 03:25:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 03:25:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 03:25:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720985153 HTTP/1.1" 200 280
2024-07-15 03:25:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 03:25:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 03:26:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 03:26:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720985161 HTTP/1.1" 200 280
2024-07-15 03:26:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 03:26:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 03:26:04:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-15 03:26:04:INFO:Init labels...
2024-07-15 03:26:04:INFO:Start training...
2024-07-15 03:33:30:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.1759
2024-07-15 03:34:00:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.4918
2024-07-15 03:34:08:INFO:VAL-(cmcm) >>
2024-07-15 03:34:08:INFO:M: >>  acc: 0.4355  weight_F1: 0.3134 
2024-07-15 03:34:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2024-07-15 03:35:44:INFO:VAL-(cmcm) >>
2024-07-15 03:35:44:INFO:M: >>  Has0_acc_2: 0.8733  Has0_F1_score: 0.8691  Non0_acc_2: 0.8004  Non0_F1_score: 0.8048  Mult_acc_5: 0.5452  Mult_acc_7: 0.5270  MAE: 0.5134  Corr: 0.7691 
2024-07-15 03:41:41:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.7441
2024-07-15 03:42:20:INFO:VAL-(cmcm) >>
2024-07-15 03:42:20:INFO:M: >>  acc: 0.4581  weight_F1: 0.4145 
2024-07-15 03:42:26:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2024-07-15 03:45:21:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.4905
2024-07-15 03:47:05:INFO:VAL-(cmcm) >>
2024-07-15 03:47:05:INFO:M: >>  Has0_acc_2: 0.8733  Has0_F1_score: 0.8715  Non0_acc_2: 0.7058  Non0_F1_score: 0.7088  Mult_acc_5: 0.5804  Mult_acc_7: 0.5628  MAE: 0.5129  Corr: 0.7556 
2024-07-15 03:49:53:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.6686
2024-07-15 03:50:32:INFO:VAL-(cmcm) >>
2024-07-15 03:50:32:INFO:M: >>  acc: 0.5086  weight_F1: 0.4689 
2024-07-15 03:50:38:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2024-07-15 03:56:42:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.4885
2024-07-15 03:58:04:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.6172
2024-07-15 03:58:26:INFO:VAL-(cmcm) >>
2024-07-15 03:58:26:INFO:M: >>  Has0_acc_2: 0.8792  Has0_F1_score: 0.8772  Non0_acc_2: 0.7295  Non0_F1_score: 0.7340  Mult_acc_5: 0.5740  Mult_acc_7: 0.5569  MAE: 0.5014  Corr: 0.7658 
2024-07-15 03:58:32:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosei-regression.pth.
2024-07-15 03:58:43:INFO:VAL-(cmcm) >>
2024-07-15 03:58:43:INFO:M: >>  acc: 0.5356  weight_F1: 0.4982 
2024-07-15 03:58:49:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:06:16:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5853
2024-07-15 04:06:54:INFO:VAL-(cmcm) >>
2024-07-15 04:06:54:INFO:M: >>  acc: 0.5789  weight_F1: 0.5411 
2024-07-15 04:07:00:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:07:58:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.4873
2024-07-15 04:09:42:INFO:VAL-(cmcm) >>
2024-07-15 04:09:43:INFO:M: >>  Has0_acc_2: 0.8787  Has0_F1_score: 0.8763  Non0_acc_2: 0.6780  Non0_F1_score: 0.6784  Mult_acc_5: 0.5639  Mult_acc_7: 0.5462  MAE: 0.5187  Corr: 0.7526 
2024-07-15 04:14:26:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.5639
2024-07-15 04:15:04:INFO:VAL-(cmcm) >>
2024-07-15 04:15:04:INFO:M: >>  acc: 0.5924  weight_F1: 0.5723 
2024-07-15 04:15:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:18:53:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.4856
2024-07-15 04:20:37:INFO:VAL-(cmcm) >>
2024-07-15 04:20:37:INFO:M: >>  Has0_acc_2: 0.8749  Has0_F1_score: 0.8701  Non0_acc_2: 0.7406  Non0_F1_score: 0.7458  Mult_acc_5: 0.5612  Mult_acc_7: 0.5446  MAE: 0.5149  Corr: 0.7560 
2024-07-15 04:22:35:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.5515
2024-07-15 04:23:14:INFO:VAL-(cmcm) >>
2024-07-15 04:23:14:INFO:M: >>  acc: 0.6105  weight_F1: 0.5824 
2024-07-15 04:23:20:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:29:55:INFO:TRAIN-(cmcm) (3/19/2)>> loss: 0.4840
2024-07-15 04:30:45:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.5391
2024-07-15 04:31:24:INFO:VAL-(cmcm) >>
2024-07-15 04:31:24:INFO:M: >>  acc: 0.6078  weight_F1: 0.5819 
2024-07-15 04:31:39:INFO:VAL-(cmcm) >>
2024-07-15 04:31:39:INFO:M: >>  Has0_acc_2: 0.8760  Has0_F1_score: 0.8729  Non0_acc_2: 0.7239  Non0_F1_score: 0.7284  Mult_acc_5: 0.5644  Mult_acc_7: 0.5494  MAE: 0.5133  Corr: 0.7566 
2024-07-15 04:38:48:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.5304
2024-07-15 04:39:27:INFO:VAL-(cmcm) >>
2024-07-15 04:39:27:INFO:M: >>  acc: 0.6123  weight_F1: 0.5881 
2024-07-15 04:39:32:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:40:53:INFO:TRAIN-(cmcm) (4/20/2)>> loss: 0.4827
2024-07-15 04:42:38:INFO:VAL-(cmcm) >>
2024-07-15 04:42:38:INFO:M: >>  Has0_acc_2: 0.8771  Has0_F1_score: 0.8733  Non0_acc_2: 0.7371  Non0_F1_score: 0.7417  Mult_acc_5: 0.5569  Mult_acc_7: 0.5404  MAE: 0.5210  Corr: 0.7606 
2024-07-15 04:46:58:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.5204
2024-07-15 04:47:36:INFO:VAL-(cmcm) >>
2024-07-15 04:47:36:INFO:M: >>  acc: 0.6267  weight_F1: 0.6085 
2024-07-15 04:47:42:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2024-07-15 04:52:04:INFO:TRAIN-(cmcm) (5/21/2)>> loss: 0.4814
2024-07-15 04:53:47:INFO:VAL-(cmcm) >>
2024-07-15 04:53:47:INFO:M: >>  Has0_acc_2: 0.8765  Has0_F1_score: 0.8727  Non0_acc_2: 0.6996  Non0_F1_score: 0.7020  Mult_acc_5: 0.5730  Mult_acc_7: 0.5580  MAE: 0.5065  Corr: 0.7569 
2024-07-15 04:55:08:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.5124
2024-07-15 04:55:46:INFO:VAL-(cmcm) >>
2024-07-15 04:55:46:INFO:M: >>  acc: 0.6312  weight_F1: 0.6085 
2024-07-15 05:03:04:INFO:TRAIN-(cmcm) (6/22/2)>> loss: 0.4802
2024-07-15 05:03:11:INFO:TRAIN-(cmcm) (2/12/3)>> loss: 0.5056
2024-07-15 05:03:49:INFO:VAL-(cmcm) >>
2024-07-15 05:03:49:INFO:M: >>  acc: 0.6303  weight_F1: 0.6034 
2024-07-15 05:04:48:INFO:VAL-(cmcm) >>
2024-07-15 05:04:48:INFO:M: >>  Has0_acc_2: 0.8755  Has0_F1_score: 0.8708  Non0_acc_2: 0.7107  Non0_F1_score: 0.7140  Mult_acc_5: 0.5756  Mult_acc_7: 0.5596  MAE: 0.5118  Corr: 0.7550 
2024-07-15 05:11:13:INFO:TRAIN-(cmcm) (3/13/3)>> loss: 0.4994
2024-07-15 05:11:52:INFO:VAL-(cmcm) >>
2024-07-15 05:11:52:INFO:M: >>  acc: 0.6384  weight_F1: 0.6250 
2024-07-15 05:11:58:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2024-07-15 05:13:55:INFO:TRAIN-(cmcm) (7/23/2)>> loss: 0.4792
2024-07-15 05:15:39:INFO:VAL-(cmcm) >>
2024-07-15 05:15:39:INFO:M: >>  Has0_acc_2: 0.8787  Has0_F1_score: 0.8768  Non0_acc_2: 0.7038  Non0_F1_score: 0.7066  Mult_acc_5: 0.5772  Mult_acc_7: 0.5617  MAE: 0.5060  Corr: 0.7562 
2024-07-15 05:19:23:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.4939
2024-07-15 05:20:01:INFO:VAL-(cmcm) >>
2024-07-15 05:20:01:INFO:M: >>  acc: 0.6141  weight_F1: 0.6051 
2024-07-15 05:24:46:INFO:TRAIN-(cmcm) (8/24/2)>> loss: 0.4782
2024-07-15 05:26:31:INFO:VAL-(cmcm) >>
2024-07-15 05:26:31:INFO:M: >>  Has0_acc_2: 0.8771  Has0_F1_score: 0.8744  Non0_acc_2: 0.7086  Non0_F1_score: 0.7118  Mult_acc_5: 0.5714  Mult_acc_7: 0.5548  MAE: 0.5124  Corr: 0.7583 
2024-07-15 05:27:25:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.4907
2024-07-15 05:28:04:INFO:VAL-(cmcm) >>
2024-07-15 05:28:04:INFO:M: >>  acc: 0.6231  weight_F1: 0.6086 
2024-07-15 05:35:27:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.4854
2024-07-15 05:35:38:INFO:TRAIN-(cmcm) (9/25/2)>> loss: 0.4772
2024-07-15 05:36:06:INFO:VAL-(cmcm) >>
2024-07-15 05:36:06:INFO:M: >>  acc: 0.6168  weight_F1: 0.6162 
2024-07-15 05:37:22:INFO:VAL-(cmcm) >>
2024-07-15 05:37:22:INFO:M: >>  Has0_acc_2: 0.8781  Has0_F1_score: 0.8745  Non0_acc_2: 0.6905  Non0_F1_score: 0.6923  Mult_acc_5: 0.5778  Mult_acc_7: 0.5623  MAE: 0.5054  Corr: 0.7562 
2024-07-15 05:43:30:INFO:TRAIN-(cmcm) (4/17/3)>> loss: 0.4816
2024-07-15 05:44:08:INFO:VAL-(cmcm) >>
2024-07-15 05:44:08:INFO:M: >>  acc: 0.6285  weight_F1: 0.6165 
2024-07-15 05:46:29:INFO:TRAIN-(cmcm) (10/26/2)>> loss: 0.4763
2024-07-15 05:48:13:INFO:VAL-(cmcm) >>
2024-07-15 05:48:13:INFO:M: >>  Has0_acc_2: 0.8771  Has0_F1_score: 0.8747  Non0_acc_2: 0.6864  Non0_F1_score: 0.6877  Mult_acc_5: 0.5756  Mult_acc_7: 0.5607  MAE: 0.5054  Corr: 0.7575 
2024-07-15 05:51:32:INFO:TRAIN-(cmcm) (5/18/3)>> loss: 0.4792
2024-07-15 05:52:10:INFO:VAL-(cmcm) >>
2024-07-15 05:52:10:INFO:M: >>  acc: 0.6267  weight_F1: 0.6056 
2024-07-15 05:52:32:INFO:TEST-(cmcm) >>
2024-07-15 05:52:32:INFO:M: >>  Has0_acc_2: 0.8738  Has0_F1_score: 0.8726  Non0_acc_2: 0.7490  Non0_F1_score: 0.7519  Mult_acc_5: 0.5636  Mult_acc_7: 0.5435  MAE: 0.5186  Corr: 0.7853 
2024-07-15 05:52:33:INFO:Results are added to results/results/mosei-regression-30.csv...
2024-07-15 05:52:33:INFO:Start running cmcm...
2024-07-15 05:52:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-07-15 05:52:33:INFO:Let's use the GPU 1 !
2024-07-15 05:52:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 05:52:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720993959 HTTP/1.1" 200 280
2024-07-15 05:52:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 05:52:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 05:52:45:INFO:train samples: (16326,)
2024-07-15 05:52:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 05:52:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720993972 HTTP/1.1" 200 280
2024-07-15 05:52:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 05:52:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 05:52:53:INFO:valid samples: (1871,)
2024-07-15 05:53:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 05:53:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720993980 HTTP/1.1" 200 280
2024-07-15 05:53:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 05:53:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 05:53:02:INFO:test samples: (4659,)
2024-07-15 05:53:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 05:53:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720993983 HTTP/1.1" 200 280
2024-07-15 05:53:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 05:53:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 05:53:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 05:53:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1720993991 HTTP/1.1" 200 280
2024-07-15 05:53:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 05:53:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 05:53:14:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-15 05:53:14:INFO:Init labels...
2024-07-15 05:53:14:INFO:Start training...
2024-07-15 05:59:34:INFO:TRAIN-(cmcm) (6/19/3)>> loss: 0.4739
2024-07-15 06:00:13:INFO:VAL-(cmcm) >>
2024-07-15 06:00:13:INFO:M: >>  acc: 0.6258  weight_F1: 0.6195 
2024-07-15 06:02:20:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 0.8445
2024-07-15 06:04:04:INFO:VAL-(cmcm) >>
2024-07-15 06:04:04:INFO:M: >>  Has0_acc_2: 0.8466  Has0_F1_score: 0.8467  Non0_acc_2: 0.6885  Non0_F1_score: 0.6924  Mult_acc_5: 0.5094  Mult_acc_7: 0.4944  MAE: 0.6679  Corr: 0.6598 
2024-07-15 06:04:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-15 06:07:37:INFO:TRAIN-(cmcm) (7/20/3)>> loss: 0.4711
2024-07-15 06:08:15:INFO:VAL-(cmcm) >>
2024-07-15 06:08:15:INFO:M: >>  acc: 0.6330  weight_F1: 0.6128 
2024-07-15 06:13:28:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.5438
2024-07-15 06:15:11:INFO:VAL-(cmcm) >>
2024-07-15 06:15:11:INFO:M: >>  Has0_acc_2: 0.8498  Has0_F1_score: 0.8395  Non0_acc_2: 0.7392  Non0_F1_score: 0.7448  Mult_acc_5: 0.5297  Mult_acc_7: 0.5136  MAE: 0.6184  Corr: 0.6976 
2024-07-15 06:15:17:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2024-07-15 06:15:39:INFO:TRAIN-(cmcm) (8/21/3)>> loss: 0.4680
2024-07-15 06:16:17:INFO:VAL-(cmcm) >>
2024-07-15 06:16:17:INFO:M: >>  acc: 0.6456  weight_F1: 0.6262 
2024-07-15 06:16:23:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-meld-classification.pth.
2024-07-15 06:23:49:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.4654
2024-07-15 06:24:26:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.5343
2024-07-15 06:24:27:INFO:VAL-(cmcm) >>
2024-07-15 06:24:27:INFO:M: >>  acc: 0.6357  weight_F1: 0.6274 
2024-07-15 06:24:33:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-meld-classification.pth.
2024-07-15 06:26:09:INFO:VAL-(cmcm) >>
2024-07-15 06:26:09:INFO:M: >>  Has0_acc_2: 0.8536  Has0_F1_score: 0.8454  Non0_acc_2: 0.6933  Non0_F1_score: 0.6956  Mult_acc_5: 0.5414  Mult_acc_7: 0.5222  MAE: 0.5658  Corr: 0.7149 
2024-07-15 06:26:15:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2024-07-15 06:31:58:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.4626
2024-07-15 06:32:37:INFO:VAL-(cmcm) >>
2024-07-15 06:32:37:INFO:M: >>  acc: 0.6384  weight_F1: 0.6295 
2024-07-15 06:32:43:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-meld-classification.pth.
2024-07-15 06:35:23:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.5293
2024-07-15 06:37:06:INFO:VAL-(cmcm) >>
2024-07-15 06:37:06:INFO:M: >>  Has0_acc_2: 0.8616  Has0_F1_score: 0.8572  Non0_acc_2: 0.5382  Non0_F1_score: 0.5041  Mult_acc_5: 0.5441  Mult_acc_7: 0.5307  MAE: 0.5705  Corr: 0.7011 
2024-07-15 06:40:08:INFO:TRAIN-(cmcm) (1/24/3)>> loss: 0.4596
2024-07-15 06:40:46:INFO:VAL-(cmcm) >>
2024-07-15 06:40:46:INFO:M: >>  acc: 0.6510  weight_F1: 0.6375 
2024-07-15 06:40:52:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-meld-classification.pth.
2024-07-15 06:46:14:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.5245
2024-07-15 06:47:57:INFO:VAL-(cmcm) >>
2024-07-15 06:47:57:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8525  Non0_acc_2: 0.5695  Non0_F1_score: 0.5477  Mult_acc_5: 0.5601  Mult_acc_7: 0.5430  MAE: 0.5557  Corr: 0.7029 
2024-07-15 06:48:03:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosei-regression.pth.
2024-07-15 06:48:17:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.4578
2024-07-15 06:48:56:INFO:VAL-(cmcm) >>
2024-07-15 06:48:56:INFO:M: >>  acc: 0.6492  weight_F1: 0.6289 
2024-07-15 06:56:20:INFO:TRAIN-(cmcm) (2/26/3)>> loss: 0.4562
2024-07-15 06:56:58:INFO:VAL-(cmcm) >>
2024-07-15 06:56:58:INFO:M: >>  acc: 0.6321  weight_F1: 0.6160 
2024-07-15 06:57:12:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.5210
2024-07-15 06:58:55:INFO:VAL-(cmcm) >>
2024-07-15 06:58:55:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8400  Non0_acc_2: 0.6843  Non0_F1_score: 0.6854  Mult_acc_5: 0.5585  Mult_acc_7: 0.5441  MAE: 0.5359  Corr: 0.7239 
2024-07-15 06:59:01:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-15 07:04:22:INFO:TRAIN-(cmcm) (3/27/3)>> loss: 0.4528
2024-07-15 07:05:01:INFO:VAL-(cmcm) >>
2024-07-15 07:05:01:INFO:M: >>  acc: 0.6465  weight_F1: 0.6322 
2024-07-15 07:08:09:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.5181
2024-07-15 07:09:53:INFO:VAL-(cmcm) >>
2024-07-15 07:09:53:INFO:M: >>  Has0_acc_2: 0.8536  Has0_F1_score: 0.8472  Non0_acc_2: 0.5730  Non0_F1_score: 0.5521  Mult_acc_5: 0.5532  Mult_acc_7: 0.5361  MAE: 0.5602  Corr: 0.7028 
2024-07-15 07:12:25:INFO:TRAIN-(cmcm) (4/28/3)>> loss: 0.4510
2024-07-15 07:13:04:INFO:VAL-(cmcm) >>
2024-07-15 07:13:04:INFO:M: >>  acc: 0.6483  weight_F1: 0.6269 
2024-07-15 07:18:58:INFO:TRAIN-(cmcm) (2/8/3)>> loss: 0.5149
2024-07-15 07:20:28:INFO:TRAIN-(cmcm) (5/29/3)>> loss: 0.4489
2024-07-15 07:20:42:INFO:VAL-(cmcm) >>
2024-07-15 07:20:42:INFO:M: >>  Has0_acc_2: 0.8578  Has0_F1_score: 0.8590  Non0_acc_2: 0.6252  Non0_F1_score: 0.6162  Mult_acc_5: 0.5569  Mult_acc_7: 0.5398  MAE: 0.5585  Corr: 0.7293 
2024-07-15 07:21:06:INFO:VAL-(cmcm) >>
2024-07-15 07:21:06:INFO:M: >>  acc: 0.6393  weight_F1: 0.6286 
2024-07-15 07:28:31:INFO:TRAIN-(cmcm) (6/30/3)>> loss: 0.4465
2024-07-15 07:29:09:INFO:VAL-(cmcm) >>
2024-07-15 07:29:09:INFO:M: >>  acc: 0.6321  weight_F1: 0.6086 
2024-07-15 07:29:47:INFO:TRAIN-(cmcm) (3/9/3)>> loss: 0.5107
2024-07-15 07:31:30:INFO:VAL-(cmcm) >>
2024-07-15 07:31:30:INFO:M: >>  Has0_acc_2: 0.8637  Has0_F1_score: 0.8605  Non0_acc_2: 0.6127  Non0_F1_score: 0.6009  Mult_acc_5: 0.5692  Mult_acc_7: 0.5516  MAE: 0.5314  Corr: 0.7408 
2024-07-15 07:31:36:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosei-regression.pth.
2024-07-15 07:36:34:INFO:TRAIN-(cmcm) (7/31/3)>> loss: 0.4442
2024-07-15 07:37:12:INFO:VAL-(cmcm) >>
2024-07-15 07:37:12:INFO:M: >>  acc: 0.6393  weight_F1: 0.6286 
2024-07-15 07:40:43:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.5076
2024-07-15 07:42:26:INFO:VAL-(cmcm) >>
2024-07-15 07:42:26:INFO:M: >>  Has0_acc_2: 0.8632  Has0_F1_score: 0.8599  Non0_acc_2: 0.6182  Non0_F1_score: 0.6079  Mult_acc_5: 0.5740  Mult_acc_7: 0.5553  MAE: 0.5325  Corr: 0.7373 
2024-07-15 07:44:36:INFO:TRAIN-(cmcm) (8/32/3)>> loss: 0.4424
2024-07-15 07:45:15:INFO:VAL-(cmcm) >>
2024-07-15 07:45:15:INFO:M: >>  acc: 0.6402  weight_F1: 0.6134 
2024-07-15 07:46:46:INFO:TEST-(cmcm) >>
2024-07-15 07:46:46:INFO:M: >>  acc: 0.6467  weight_F1: 0.6333 
2024-07-15 07:46:47:INFO:Results are added to results/results/meld-classification-90.csv...
2024-07-15 07:46:47:INFO:Start running cmcm...
2024-07-15 07:46:47:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the target                                                 set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 4444}>
2024-07-15 07:46:47:INFO:Let's use the GPU 1 !
2024-07-15 07:46:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 07:46:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721000808 HTTP/1.1" 200 280
2024-07-15 07:46:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 07:46:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 07:46:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 07:46:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721000813 HTTP/1.1" 200 280
2024-07-15 07:46:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 07:46:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 07:46:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 07:46:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721000814 HTTP/1.1" 200 280
2024-07-15 07:46:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 07:46:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 07:46:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 07:46:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721000816 HTTP/1.1" 200 280
2024-07-15 07:46:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 07:46:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 07:47:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 07:47:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721000825 HTTP/1.1" 200 280
2024-07-15 07:47:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 07:47:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 07:47:07:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-15 07:47:07:INFO:Init labels...
2024-07-15 07:47:07:INFO:Start training...
2024-07-15 07:51:48:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.5057
2024-07-15 07:53:32:INFO:VAL-(cmcm) >>
2024-07-15 07:53:32:INFO:M: >>  Has0_acc_2: 0.8520  Has0_F1_score: 0.8433  Non0_acc_2: 0.6307  Non0_F1_score: 0.6230  Mult_acc_5: 0.5714  Mult_acc_7: 0.5537  MAE: 0.5312  Corr: 0.7323 
2024-07-15 07:53:38:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2024-07-15 07:54:32:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.6897
2024-07-15 07:55:10:INFO:VAL-(cmcm) >>
2024-07-15 07:55:10:INFO:M: >>  acc: 0.4301  weight_F1: 0.3364 
2024-07-15 07:55:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:02:43:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.6911
2024-07-15 08:02:56:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.5036
2024-07-15 08:03:21:INFO:VAL-(cmcm) >>
2024-07-15 08:03:21:INFO:M: >>  acc: 0.4644  weight_F1: 0.4350 
2024-07-15 08:03:27:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:04:40:INFO:VAL-(cmcm) >>
2024-07-15 08:04:40:INFO:M: >>  Has0_acc_2: 0.8653  Has0_F1_score: 0.8649  Non0_acc_2: 0.6106  Non0_F1_score: 0.5987  Mult_acc_5: 0.5751  Mult_acc_7: 0.5580  MAE: 0.5215  Corr: 0.7431 
2024-07-15 08:04:46:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2024-07-15 08:10:53:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.6496
2024-07-15 08:11:32:INFO:VAL-(cmcm) >>
2024-07-15 08:11:32:INFO:M: >>  acc: 0.5032  weight_F1: 0.5013 
2024-07-15 08:11:37:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:14:26:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.5017
2024-07-15 08:16:09:INFO:VAL-(cmcm) >>
2024-07-15 08:16:09:INFO:M: >>  Has0_acc_2: 0.8594  Has0_F1_score: 0.8623  Non0_acc_2: 0.6933  Non0_F1_score: 0.6950  Mult_acc_5: 0.5548  Mult_acc_7: 0.5350  MAE: 0.5616  Corr: 0.7459 
2024-07-15 08:19:03:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5986
2024-07-15 08:19:42:INFO:VAL-(cmcm) >>
2024-07-15 08:19:42:INFO:M: >>  acc: 0.5528  weight_F1: 0.5371 
2024-07-15 08:19:47:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:25:34:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.5007
2024-07-15 08:27:14:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.5619
2024-07-15 08:27:18:INFO:VAL-(cmcm) >>
2024-07-15 08:27:18:INFO:M: >>  Has0_acc_2: 0.8658  Has0_F1_score: 0.8645  Non0_acc_2: 0.6307  Non0_F1_score: 0.6232  Mult_acc_5: 0.5842  Mult_acc_7: 0.5655  MAE: 0.5202  Corr: 0.7464 
2024-07-15 08:27:24:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosei-regression.pth.
2024-07-15 08:27:53:INFO:VAL-(cmcm) >>
2024-07-15 08:27:53:INFO:M: >>  acc: 0.5555  weight_F1: 0.5517 
2024-07-15 08:27:59:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:35:25:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.5471
2024-07-15 08:36:04:INFO:VAL-(cmcm) >>
2024-07-15 08:36:04:INFO:M: >>  acc: 0.5672  weight_F1: 0.5597 
2024-07-15 08:36:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:36:32:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.4990
2024-07-15 08:38:16:INFO:VAL-(cmcm) >>
2024-07-15 08:38:16:INFO:M: >>  Has0_acc_2: 0.8653  Has0_F1_score: 0.8656  Non0_acc_2: 0.6620  Non0_F1_score: 0.6604  Mult_acc_5: 0.5799  Mult_acc_7: 0.5628  MAE: 0.5195  Corr: 0.7505 
2024-07-15 08:38:22:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosei-regression.pth.
2024-07-15 08:43:35:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.5345
2024-07-15 08:44:14:INFO:VAL-(cmcm) >>
2024-07-15 08:44:14:INFO:M: >>  acc: 0.6150  weight_F1: 0.6023 
2024-07-15 08:44:20:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:47:30:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.4978
2024-07-15 08:49:14:INFO:VAL-(cmcm) >>
2024-07-15 08:49:14:INFO:M: >>  Has0_acc_2: 0.8680  Has0_F1_score: 0.8668  Non0_acc_2: 0.6419  Non0_F1_score: 0.6363  Mult_acc_5: 0.5820  Mult_acc_7: 0.5633  MAE: 0.5144  Corr: 0.7513 
2024-07-15 08:49:20:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosei-regression.pth.
2024-07-15 08:51:45:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.5222
2024-07-15 08:52:24:INFO:VAL-(cmcm) >>
2024-07-15 08:52:24:INFO:M: >>  acc: 0.6258  weight_F1: 0.6153 
2024-07-15 08:52:30:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2024-07-15 08:58:31:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.4963
2024-07-15 08:59:55:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.5157
2024-07-15 09:00:15:INFO:VAL-(cmcm) >>
2024-07-15 09:00:15:INFO:M: >>  Has0_acc_2: 0.8621  Has0_F1_score: 0.8601  Non0_acc_2: 0.7079  Non0_F1_score: 0.7109  Mult_acc_5: 0.5697  Mult_acc_7: 0.5537  MAE: 0.5190  Corr: 0.7543 
2024-07-15 09:00:34:INFO:VAL-(cmcm) >>
2024-07-15 09:00:34:INFO:M: >>  acc: 0.6384  weight_F1: 0.6176 
2024-07-15 09:00:40:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2024-07-15 09:08:06:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.5048
2024-07-15 09:08:45:INFO:VAL-(cmcm) >>
2024-07-15 09:08:45:INFO:M: >>  acc: 0.6483  weight_F1: 0.6283 
2024-07-15 09:08:50:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2024-07-15 09:09:27:INFO:TRAIN-(cmcm) (2/18/3)>> loss: 0.4947
2024-07-15 09:11:10:INFO:VAL-(cmcm) >>
2024-07-15 09:11:10:INFO:M: >>  Has0_acc_2: 0.8621  Has0_F1_score: 0.8559  Non0_acc_2: 0.6586  Non0_F1_score: 0.6561  Mult_acc_5: 0.5714  Mult_acc_7: 0.5494  MAE: 0.5190  Corr: 0.7457 
2024-07-15 09:16:17:INFO:TRAIN-(cmcm) (1/11/4)>> loss: 0.4957
2024-07-15 09:16:55:INFO:VAL-(cmcm) >>
2024-07-15 09:16:55:INFO:M: >>  acc: 0.6348  weight_F1: 0.6249 
2024-07-15 09:20:49:INFO:TRAIN-(cmcm) (3/19/3)>> loss: 0.4936
2024-07-15 09:22:33:INFO:VAL-(cmcm) >>
2024-07-15 09:22:33:INFO:M: >>  Has0_acc_2: 0.8653  Has0_F1_score: 0.8623  Non0_acc_2: 0.6787  Non0_F1_score: 0.6791  Mult_acc_5: 0.5671  Mult_acc_7: 0.5478  MAE: 0.5164  Corr: 0.7517 
2024-07-15 09:24:20:INFO:TRAIN-(cmcm) (2/12/4)>> loss: 0.4905
2024-07-15 09:24:58:INFO:VAL-(cmcm) >>
2024-07-15 09:24:58:INFO:M: >>  acc: 0.6384  weight_F1: 0.6196 
2024-07-15 09:32:08:INFO:TRAIN-(cmcm) (4/20/3)>> loss: 0.4928
2024-07-15 09:32:24:INFO:TRAIN-(cmcm) (3/13/4)>> loss: 0.4833
2024-07-15 09:33:02:INFO:VAL-(cmcm) >>
2024-07-15 09:33:02:INFO:M: >>  acc: 0.6411  weight_F1: 0.6257 
2024-07-15 09:33:52:INFO:VAL-(cmcm) >>
2024-07-15 09:33:52:INFO:M: >>  Has0_acc_2: 0.8658  Has0_F1_score: 0.8627  Non0_acc_2: 0.6523  Non0_F1_score: 0.6490  Mult_acc_5: 0.5778  Mult_acc_7: 0.5569  MAE: 0.5193  Corr: 0.7524 
2024-07-15 09:40:27:INFO:TRAIN-(cmcm) (4/14/4)>> loss: 0.4777
2024-07-15 09:41:06:INFO:VAL-(cmcm) >>
2024-07-15 09:41:06:INFO:M: >>  acc: 0.6357  weight_F1: 0.6221 
2024-07-15 09:43:18:INFO:TRAIN-(cmcm) (5/21/3)>> loss: 0.4916
2024-07-15 09:45:02:INFO:VAL-(cmcm) >>
2024-07-15 09:45:02:INFO:M: >>  Has0_acc_2: 0.8632  Has0_F1_score: 0.8578  Non0_acc_2: 0.6502  Non0_F1_score: 0.6468  Mult_acc_5: 0.5772  Mult_acc_7: 0.5569  MAE: 0.5166  Corr: 0.7533 
2024-07-15 09:48:30:INFO:TRAIN-(cmcm) (5/15/4)>> loss: 0.4745
2024-07-15 09:49:09:INFO:VAL-(cmcm) >>
2024-07-15 09:49:09:INFO:M: >>  acc: 0.6537  weight_F1: 0.6439 
2024-07-15 09:49:15:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-meld-classification.pth.
2024-07-15 09:54:41:INFO:TRAIN-(cmcm) (6/22/3)>> loss: 0.4906
2024-07-15 09:56:25:INFO:VAL-(cmcm) >>
2024-07-15 09:56:25:INFO:M: >>  Has0_acc_2: 0.8685  Has0_F1_score: 0.8640  Non0_acc_2: 0.6822  Non0_F1_score: 0.6831  Mult_acc_5: 0.5703  Mult_acc_7: 0.5516  MAE: 0.5209  Corr: 0.7558 
2024-07-15 09:56:41:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.4698
2024-07-15 09:57:20:INFO:VAL-(cmcm) >>
2024-07-15 09:57:20:INFO:M: >>  acc: 0.6465  weight_F1: 0.6295 
2024-07-15 10:04:45:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 0.4644
2024-07-15 10:05:23:INFO:VAL-(cmcm) >>
2024-07-15 10:05:23:INFO:M: >>  acc: 0.6564  weight_F1: 0.6440 
2024-07-15 10:05:29:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-meld-classification.pth.
2024-07-15 10:06:00:INFO:TRAIN-(cmcm) (7/23/3)>> loss: 0.4897
2024-07-15 10:07:44:INFO:VAL-(cmcm) >>
2024-07-15 10:07:44:INFO:M: >>  Has0_acc_2: 0.8685  Has0_F1_score: 0.8677  Non0_acc_2: 0.6648  Non0_F1_score: 0.6638  Mult_acc_5: 0.5740  Mult_acc_7: 0.5537  MAE: 0.5233  Corr: 0.7529 
2024-07-15 10:12:55:INFO:TRAIN-(cmcm) (1/18/4)>> loss: 0.4636
2024-07-15 10:13:33:INFO:VAL-(cmcm) >>
2024-07-15 10:13:33:INFO:M: >>  acc: 0.6583  weight_F1: 0.6398 
2024-07-15 10:17:20:INFO:TRAIN-(cmcm) (8/24/3)>> loss: 0.4887
2024-07-15 10:19:04:INFO:VAL-(cmcm) >>
2024-07-15 10:19:04:INFO:M: >>  Has0_acc_2: 0.8669  Has0_F1_score: 0.8635  Non0_acc_2: 0.6655  Non0_F1_score: 0.6646  Mult_acc_5: 0.5697  Mult_acc_7: 0.5489  MAE: 0.5218  Corr: 0.7536 
2024-07-15 10:20:58:INFO:TRAIN-(cmcm) (2/19/4)>> loss: 0.4602
2024-07-15 10:21:37:INFO:VAL-(cmcm) >>
2024-07-15 10:21:37:INFO:M: >>  acc: 0.6537  weight_F1: 0.6420 
2024-07-15 10:28:41:INFO:TRAIN-(cmcm) (9/25/3)>> loss: 0.4880
2024-07-15 10:29:01:INFO:TRAIN-(cmcm) (3/20/4)>> loss: 0.4563
2024-07-15 10:29:39:INFO:VAL-(cmcm) >>
2024-07-15 10:29:39:INFO:M: >>  acc: 0.6537  weight_F1: 0.6462 
2024-07-15 10:29:45:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-meld-classification.pth.
2024-07-15 10:30:25:INFO:VAL-(cmcm) >>
2024-07-15 10:30:25:INFO:M: >>  Has0_acc_2: 0.8675  Has0_F1_score: 0.8651  Non0_acc_2: 0.6586  Non0_F1_score: 0.6561  Mult_acc_5: 0.5735  Mult_acc_7: 0.5510  MAE: 0.5235  Corr: 0.7552 
2024-07-15 10:37:10:INFO:TRAIN-(cmcm) (1/21/4)>> loss: 0.4530
2024-07-15 10:37:49:INFO:VAL-(cmcm) >>
2024-07-15 10:37:49:INFO:M: >>  acc: 0.6465  weight_F1: 0.6392 
2024-07-15 10:40:02:INFO:TRAIN-(cmcm) (10/26/3)>> loss: 0.4875
2024-07-15 10:41:46:INFO:VAL-(cmcm) >>
2024-07-15 10:41:46:INFO:M: >>  Has0_acc_2: 0.8675  Has0_F1_score: 0.8652  Non0_acc_2: 0.6537  Non0_F1_score: 0.6509  Mult_acc_5: 0.5794  Mult_acc_7: 0.5580  MAE: 0.5191  Corr: 0.7569 
2024-07-15 10:45:12:INFO:TRAIN-(cmcm) (2/22/4)>> loss: 0.4505
2024-07-15 10:45:51:INFO:VAL-(cmcm) >>
2024-07-15 10:45:51:INFO:M: >>  acc: 0.6564  weight_F1: 0.6431 
2024-07-15 10:46:06:INFO:TEST-(cmcm) >>
2024-07-15 10:46:06:INFO:M: >>  Has0_acc_2: 0.8656  Has0_F1_score: 0.8645  Non0_acc_2: 0.6761  Non0_F1_score: 0.6720  Mult_acc_5: 0.5712  Mult_acc_7: 0.5486  MAE: 0.5276  Corr: 0.7710 
2024-07-15 10:46:06:INFO:Results are added to results/results/mosei-regression-30.csv...
2024-07-15 10:46:06:INFO:Start running cmcm...
2024-07-15 10:46:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-07-15 10:46:06:INFO:Let's use the GPU 1 !
2024-07-15 10:46:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 10:46:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721011573 HTTP/1.1" 200 280
2024-07-15 10:46:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 10:46:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 10:46:18:INFO:train samples: (16326,)
2024-07-15 10:46:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 10:46:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721011585 HTTP/1.1" 200 280
2024-07-15 10:46:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 10:46:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 10:46:26:INFO:valid samples: (1871,)
2024-07-15 10:46:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 10:46:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721011593 HTTP/1.1" 200 280
2024-07-15 10:46:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 10:46:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 10:46:35:INFO:test samples: (4659,)
2024-07-15 10:46:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 10:46:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721011596 HTTP/1.1" 200 280
2024-07-15 10:46:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 10:46:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 10:46:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 10:46:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721011605 HTTP/1.1" 200 280
2024-07-15 10:46:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 10:46:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 10:46:47:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-15 10:46:47:INFO:Init labels...
2024-07-15 10:46:47:INFO:Start training...
2024-07-15 10:53:15:INFO:TRAIN-(cmcm) (3/23/4)>> loss: 0.4480
2024-07-15 10:53:53:INFO:VAL-(cmcm) >>
2024-07-15 10:53:53:INFO:M: >>  acc: 0.6411  weight_F1: 0.6353 
2024-07-15 10:55:52:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 0.7159
2024-07-15 10:57:36:INFO:VAL-(cmcm) >>
2024-07-15 10:57:36:INFO:M: >>  Has0_acc_2: 0.8365  Has0_F1_score: 0.8213  Non0_acc_2: 0.7065  Non0_F1_score: 0.7116  Mult_acc_5: 0.5008  Mult_acc_7: 0.4816  MAE: 0.6371  Corr: 0.6796 
2024-07-15 10:57:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-15 11:01:17:INFO:TRAIN-(cmcm) (4/24/4)>> loss: 0.4454
2024-07-15 11:01:56:INFO:VAL-(cmcm) >>
2024-07-15 11:01:56:INFO:M: >>  acc: 0.6646  weight_F1: 0.6595 
2024-07-15 11:02:01:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-meld-classification.pth.
2024-07-15 11:07:18:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.5501
2024-07-15 11:09:01:INFO:VAL-(cmcm) >>
2024-07-15 11:09:01:INFO:M: >>  Has0_acc_2: 0.8536  Has0_F1_score: 0.8472  Non0_acc_2: 0.7497  Non0_F1_score: 0.7552  Mult_acc_5: 0.4853  Mult_acc_7: 0.4570  MAE: 0.6457  Corr: 0.6970 
2024-07-15 11:09:27:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.4423
2024-07-15 11:10:06:INFO:VAL-(cmcm) >>
2024-07-15 11:10:06:INFO:M: >>  acc: 0.6465  weight_F1: 0.6323 
2024-07-15 11:14:42:INFO:Start running cmcm...
2024-07-15 11:14:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 11:14:42:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 11:14:42:INFO:Let's use the GPU 1 !
2024-07-15 11:14:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:14:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013282 HTTP/1.1" 200 280
2024-07-15 11:14:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:14:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:14:43:INFO:train samples: (1284,)
2024-07-15 11:14:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:14:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013284 HTTP/1.1" 200 280
2024-07-15 11:14:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:14:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:14:45:INFO:valid samples: (229,)
2024-07-15 11:14:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:14:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013286 HTTP/1.1" 200 280
2024-07-15 11:14:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:14:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:14:46:INFO:test samples: (686,)
2024-07-15 11:14:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:14:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013287 HTTP/1.1" 200 280
2024-07-15 11:14:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:14:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:14:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:14:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013296 HTTP/1.1" 200 280
2024-07-15 11:14:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:14:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:15:00:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 11:15:00:INFO:Init labels...
2024-07-15 11:15:00:INFO:Start training...
2024-07-15 11:15:39:INFO:Start running cmcm...
2024-07-15 11:15:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 11:15:39:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 11:15:39:INFO:Let's use the GPU 1 !
2024-07-15 11:15:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:15:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013340 HTTP/1.1" 200 280
2024-07-15 11:15:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:15:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:15:42:INFO:train samples: (1284,)
2024-07-15 11:15:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013343 HTTP/1.1" 200 280
2024-07-15 11:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:15:44:INFO:valid samples: (229,)
2024-07-15 11:15:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:15:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013345 HTTP/1.1" 200 280
2024-07-15 11:15:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:15:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:15:46:INFO:test samples: (686,)
2024-07-15 11:15:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013347 HTTP/1.1" 200 280
2024-07-15 11:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:15:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:15:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013357 HTTP/1.1" 200 280
2024-07-15 11:15:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:15:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:16:00:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 11:16:00:INFO:Init labels...
2024-07-15 11:16:00:INFO:Start training...
2024-07-15 11:17:31:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.4406
2024-07-15 11:17:32:INFO:Start running cmcm...
2024-07-15 11:17:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 11:17:32:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 11:17:32:INFO:Let's use the GPU 1 !
2024-07-15 11:17:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:17:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013452 HTTP/1.1" 200 280
2024-07-15 11:17:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:17:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:17:34:INFO:train samples: (1284,)
2024-07-15 11:17:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:17:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013455 HTTP/1.1" 200 280
2024-07-15 11:17:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:17:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:17:36:INFO:valid samples: (229,)
2024-07-15 11:17:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:17:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013457 HTTP/1.1" 200 280
2024-07-15 11:17:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:17:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:17:39:INFO:test samples: (686,)
2024-07-15 11:17:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:17:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013459 HTTP/1.1" 200 280
2024-07-15 11:17:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:17:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:17:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013468 HTTP/1.1" 200 280
2024-07-15 11:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:17:52:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 11:17:52:INFO:Init labels...
2024-07-15 11:17:52:INFO:Start training...
2024-07-15 11:18:10:INFO:VAL-(cmcm) >>
2024-07-15 11:18:10:INFO:M: >>  acc: 0.6610  weight_F1: 0.6495 
2024-07-15 11:18:17:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.5430
2024-07-15 11:18:24:INFO:Start running cmcm...
2024-07-15 11:18:24:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 11:18:24:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 11:18:24:INFO:Let's use the GPU 1 !
2024-07-15 11:18:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:18:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013505 HTTP/1.1" 200 280
2024-07-15 11:18:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:18:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:18:27:INFO:train samples: (1284,)
2024-07-15 11:18:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:18:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013508 HTTP/1.1" 200 280
2024-07-15 11:18:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:18:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:18:29:INFO:valid samples: (229,)
2024-07-15 11:18:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:18:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013510 HTTP/1.1" 200 280
2024-07-15 11:18:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:18:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:18:31:INFO:test samples: (686,)
2024-07-15 11:18:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013512 HTTP/1.1" 200 280
2024-07-15 11:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:18:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013521 HTTP/1.1" 200 280
2024-07-15 11:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:18:44:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 11:18:44:INFO:Init labels...
2024-07-15 11:18:44:INFO:Start training...
2024-07-15 11:19:27:INFO:Start running cmcm...
2024-07-15 11:19:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 11:19:27:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 11:19:27:INFO:Let's use the GPU 1 !
2024-07-15 11:19:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:19:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013568 HTTP/1.1" 200 280
2024-07-15 11:19:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:19:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:19:30:INFO:train samples: (1284,)
2024-07-15 11:19:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013571 HTTP/1.1" 200 280
2024-07-15 11:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:19:32:INFO:valid samples: (229,)
2024-07-15 11:19:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:19:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013573 HTTP/1.1" 200 280
2024-07-15 11:19:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:19:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:19:34:INFO:test samples: (686,)
2024-07-15 11:19:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013574 HTTP/1.1" 200 280
2024-07-15 11:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:19:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:19:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 11:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721013582 HTTP/1.1" 200 280
2024-07-15 11:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 11:19:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 11:19:46:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 11:19:46:INFO:Init labels...
2024-07-15 11:19:46:INFO:Start training...
2024-07-15 11:20:02:INFO:VAL-(cmcm) >>
2024-07-15 11:20:02:INFO:M: >>  Has0_acc_2: 0.8525  Has0_F1_score: 0.8506  Non0_acc_2: 0.7775  Non0_F1_score: 0.7825  Mult_acc_5: 0.5243  Mult_acc_7: 0.5099  MAE: 0.5663  Corr: 0.7203 
2024-07-15 11:20:08:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2024-07-15 11:25:35:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 0.4379
2024-07-15 11:26:14:INFO:VAL-(cmcm) >>
2024-07-15 11:26:14:INFO:M: >>  acc: 0.6546  weight_F1: 0.6445 
2024-07-15 11:29:45:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5336
2024-07-15 11:31:29:INFO:VAL-(cmcm) >>
2024-07-15 11:31:29:INFO:M: >>  Has0_acc_2: 0.8621  Has0_F1_score: 0.8602  Non0_acc_2: 0.7942  Non0_F1_score: 0.7987  Mult_acc_5: 0.5206  Mult_acc_7: 0.5045  MAE: 0.5712  Corr: 0.7187 
2024-07-15 11:33:39:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 0.4354
2024-07-15 11:34:17:INFO:VAL-(cmcm) >>
2024-07-15 11:34:17:INFO:M: >>  acc: 0.6474  weight_F1: 0.6344 
2024-07-15 11:40:37:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.5255
2024-07-15 11:41:42:INFO:TRAIN-(cmcm) (5/29/4)>> loss: 0.4325
2024-07-15 11:42:20:INFO:VAL-(cmcm) >>
2024-07-15 11:42:20:INFO:M: >>  acc: 0.6564  weight_F1: 0.6500 
2024-07-15 11:42:21:INFO:VAL-(cmcm) >>
2024-07-15 11:42:21:INFO:M: >>  Has0_acc_2: 0.8568  Has0_F1_score: 0.8590  Non0_acc_2: 0.7962  Non0_F1_score: 0.8008  Mult_acc_5: 0.5580  Mult_acc_7: 0.5430  MAE: 0.5218  Corr: 0.7372 
2024-07-15 11:42:27:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosei-regression.pth.
2024-07-15 11:49:45:INFO:TRAIN-(cmcm) (6/30/4)>> loss: 0.4307
2024-07-15 11:50:24:INFO:VAL-(cmcm) >>
2024-07-15 11:50:24:INFO:M: >>  acc: 0.6519  weight_F1: 0.6465 
2024-07-15 11:51:36:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.5176
2024-07-15 11:53:20:INFO:VAL-(cmcm) >>
2024-07-15 11:53:20:INFO:M: >>  Has0_acc_2: 0.8632  Has0_F1_score: 0.8577  Non0_acc_2: 0.7907  Non0_F1_score: 0.7953  Mult_acc_5: 0.5612  Mult_acc_7: 0.5457  MAE: 0.5160  Corr: 0.7535 
2024-07-15 11:53:25:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-15 11:57:49:INFO:TRAIN-(cmcm) (7/31/4)>> loss: 0.4291
2024-07-15 11:58:28:INFO:VAL-(cmcm) >>
2024-07-15 11:58:28:INFO:M: >>  acc: 0.6528  weight_F1: 0.6480 
2024-07-15 12:02:33:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.5112
2024-07-15 12:04:17:INFO:VAL-(cmcm) >>
2024-07-15 12:04:17:INFO:M: >>  Has0_acc_2: 0.8653  Has0_F1_score: 0.8632  Non0_acc_2: 0.7997  Non0_F1_score: 0.8041  Mult_acc_5: 0.5505  Mult_acc_7: 0.5329  MAE: 0.5135  Corr: 0.7590 
2024-07-15 12:04:22:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2024-07-15 12:05:52:INFO:TRAIN-(cmcm) (8/32/4)>> loss: 0.4258
2024-07-15 12:06:31:INFO:VAL-(cmcm) >>
2024-07-15 12:06:31:INFO:M: >>  acc: 0.6501  weight_F1: 0.6430 
2024-07-15 12:08:02:INFO:TEST-(cmcm) >>
2024-07-15 12:08:02:INFO:M: >>  acc: 0.6640  weight_F1: 0.6570 
2024-07-15 12:08:02:INFO:Results are added to results/results/meld-classification-90.csv...
2024-07-15 12:08:02:INFO:Start running cmcm...
2024-07-15 12:08:02:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (4096, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the target                                                 set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. response: The emotion is', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 5555}>
2024-07-15 12:08:02:INFO:Let's use the GPU 1 !
2024-07-15 12:08:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 12:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721016484 HTTP/1.1" 200 280
2024-07-15 12:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 12:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 12:08:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 12:08:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721016489 HTTP/1.1" 200 280
2024-07-15 12:08:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 12:08:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 12:08:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 12:08:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721016490 HTTP/1.1" 200 280
2024-07-15 12:08:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 12:08:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 12:08:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 12:08:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721016492 HTTP/1.1" 200 280
2024-07-15 12:08:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 12:08:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 12:08:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 12:08:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721016500 HTTP/1.1" 200 280
2024-07-15 12:08:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 12:08:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 12:08:23:INFO:trainable params: 2632844 || all params: 6246216844 || trainable%: 0.04215101822039786
2024-07-15 12:08:23:INFO:Init labels...
2024-07-15 12:08:23:INFO:Start training...
2024-07-15 12:13:30:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.5072
2024-07-15 12:15:14:INFO:VAL-(cmcm) >>
2024-07-15 12:15:14:INFO:M: >>  Has0_acc_2: 0.8520  Has0_F1_score: 0.8556  Non0_acc_2: 0.7928  Non0_F1_score: 0.7974  Mult_acc_5: 0.5623  Mult_acc_7: 0.5452  MAE: 0.5295  Corr: 0.7494 
2024-07-15 12:15:47:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.4674
2024-07-15 12:16:26:INFO:VAL-(cmcm) >>
2024-07-15 12:16:26:INFO:M: >>  acc: 0.4238  weight_F1: 0.2634 
2024-07-15 12:16:32:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2024-07-15 12:23:58:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.7259
2024-07-15 12:24:36:INFO:VAL-(cmcm) >>
2024-07-15 12:24:36:INFO:M: >>  acc: 0.4743  weight_F1: 0.4228 
2024-07-15 12:24:42:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2024-07-15 12:24:51:INFO:TRAIN-(cmcm) (2/9/4)>> loss: 0.5036
2024-07-15 12:26:34:INFO:VAL-(cmcm) >>
2024-07-15 12:26:34:INFO:M: >>  Has0_acc_2: 0.8696  Has0_F1_score: 0.8708  Non0_acc_2: 0.8164  Non0_F1_score: 0.8203  Mult_acc_5: 0.5564  Mult_acc_7: 0.5420  MAE: 0.5068  Corr: 0.7661 
2024-07-15 12:26:40:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosei-regression.pth.
2024-07-15 12:32:08:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.6811
2024-07-15 12:32:47:INFO:VAL-(cmcm) >>
2024-07-15 12:32:47:INFO:M: >>  acc: 0.4869  weight_F1: 0.4057 
2024-07-15 12:36:19:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.5004
2024-07-15 12:38:02:INFO:VAL-(cmcm) >>
2024-07-15 12:38:02:INFO:M: >>  Has0_acc_2: 0.8712  Has0_F1_score: 0.8717  Non0_acc_2: 0.8526  Non0_F1_score: 0.8547  Mult_acc_5: 0.5265  Mult_acc_7: 0.5083  MAE: 0.5156  Corr: 0.7734 
2024-07-15 12:40:11:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.6369
2024-07-15 12:40:50:INFO:VAL-(cmcm) >>
2024-07-15 12:40:50:INFO:M: >>  acc: 0.5356  weight_F1: 0.4673 
2024-07-15 12:40:56:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2024-07-15 12:47:39:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.4981
2024-07-15 12:48:22:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5848
2024-07-15 12:49:01:INFO:VAL-(cmcm) >>
2024-07-15 12:49:01:INFO:M: >>  acc: 0.5753  weight_F1: 0.5597 
2024-07-15 12:49:07:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2024-07-15 12:49:23:INFO:VAL-(cmcm) >>
2024-07-15 12:49:23:INFO:M: >>  Has0_acc_2: 0.8781  Has0_F1_score: 0.8758  Non0_acc_2: 0.8414  Non0_F1_score: 0.8442  Mult_acc_5: 0.5307  Mult_acc_7: 0.5163  MAE: 0.5039  Corr: 0.7666 
2024-07-15 12:49:29:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2024-07-15 12:56:33:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.5536
2024-07-15 12:57:12:INFO:VAL-(cmcm) >>
2024-07-15 12:57:12:INFO:M: >>  acc: 0.6213  weight_F1: 0.5923 
2024-07-15 12:57:17:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2024-07-15 12:58:40:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 0.4958
2024-07-15 13:00:23:INFO:VAL-(cmcm) >>
2024-07-15 13:00:23:INFO:M: >>  Has0_acc_2: 0.8691  Has0_F1_score: 0.8705  Non0_acc_2: 0.8234  Non0_F1_score: 0.8271  Mult_acc_5: 0.5473  Mult_acc_7: 0.5313  MAE: 0.5170  Corr: 0.7704 
2024-07-15 13:04:43:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.5287
2024-07-15 13:05:22:INFO:VAL-(cmcm) >>
2024-07-15 13:05:22:INFO:M: >>  acc: 0.6420  weight_F1: 0.6179 
2024-07-15 13:05:28:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2024-07-15 13:09:34:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 0.4940
2024-07-15 13:11:19:INFO:VAL-(cmcm) >>
2024-07-15 13:11:19:INFO:M: >>  Has0_acc_2: 0.8765  Has0_F1_score: 0.8739  Non0_acc_2: 0.8449  Non0_F1_score: 0.8476  Mult_acc_5: 0.5676  Mult_acc_7: 0.5542  MAE: 0.4959  Corr: 0.7734 
2024-07-15 13:11:25:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosei-regression.pth.
2024-07-15 13:12:54:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.5139
2024-07-15 13:13:33:INFO:VAL-(cmcm) >>
2024-07-15 13:13:33:INFO:M: >>  acc: 0.6492  weight_F1: 0.6235 
2024-07-15 13:13:39:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2024-07-15 13:20:34:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.4923
2024-07-15 13:21:04:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.5036
2024-07-15 13:21:43:INFO:VAL-(cmcm) >>
2024-07-15 13:21:43:INFO:M: >>  acc: 0.6321  weight_F1: 0.6131 
2024-07-15 13:22:19:INFO:VAL-(cmcm) >>
2024-07-15 13:22:19:INFO:M: >>  Has0_acc_2: 0.8723  Has0_F1_score: 0.8691  Non0_acc_2: 0.8324  Non0_F1_score: 0.8355  Mult_acc_5: 0.5596  Mult_acc_7: 0.5457  MAE: 0.4899  Corr: 0.7734 
2024-07-15 13:22:25:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosei-regression.pth.
2024-07-15 13:29:08:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.4942
2024-07-15 13:29:46:INFO:VAL-(cmcm) >>
2024-07-15 13:29:46:INFO:M: >>  acc: 0.6592  weight_F1: 0.6433 
2024-07-15 13:29:52:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2024-07-15 13:31:50:INFO:TRAIN-(cmcm) (1/15/4)>> loss: 0.4904
2024-07-15 13:33:34:INFO:VAL-(cmcm) >>
2024-07-15 13:33:34:INFO:M: >>  Has0_acc_2: 0.8781  Has0_F1_score: 0.8767  Non0_acc_2: 0.8449  Non0_F1_score: 0.8477  Mult_acc_5: 0.5436  Mult_acc_7: 0.5291  MAE: 0.5013  Corr: 0.7845 
2024-07-15 13:37:18:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.4867
2024-07-15 13:37:57:INFO:VAL-(cmcm) >>
2024-07-15 13:37:57:INFO:M: >>  acc: 0.6564  weight_F1: 0.6436 
2024-07-15 13:38:03:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2024-07-15 13:42:52:INFO:TRAIN-(cmcm) (2/16/4)>> loss: 0.4890
2024-07-15 13:44:36:INFO:VAL-(cmcm) >>
2024-07-15 13:44:36:INFO:M: >>  Has0_acc_2: 0.8760  Has0_F1_score: 0.8750  Non0_acc_2: 0.8129  Non0_F1_score: 0.8171  Mult_acc_5: 0.5559  Mult_acc_7: 0.5409  MAE: 0.4968  Corr: 0.7803 
2024-07-15 13:45:29:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.4799
2024-07-15 13:46:08:INFO:VAL-(cmcm) >>
2024-07-15 13:46:08:INFO:M: >>  acc: 0.6573  weight_F1: 0.6506 
2024-07-15 13:46:13:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2024-07-15 13:53:39:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.4748
2024-07-15 13:53:41:INFO:TRAIN-(cmcm) (3/17/4)>> loss: 0.4876
2024-07-15 13:54:18:INFO:VAL-(cmcm) >>
2024-07-15 13:54:18:INFO:M: >>  acc: 0.6564  weight_F1: 0.6366 
2024-07-15 13:55:25:INFO:VAL-(cmcm) >>
2024-07-15 13:55:25:INFO:M: >>  Has0_acc_2: 0.8787  Has0_F1_score: 0.8753  Non0_acc_2: 0.8435  Non0_F1_score: 0.8463  Mult_acc_5: 0.5494  Mult_acc_7: 0.5297  MAE: 0.5138  Corr: 0.7831 
2024-07-15 14:01:43:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.4706
2024-07-15 14:02:21:INFO:VAL-(cmcm) >>
2024-07-15 14:02:21:INFO:M: >>  acc: 0.6646  weight_F1: 0.6479 
2024-07-15 14:04:45:INFO:TRAIN-(cmcm) (4/18/4)>> loss: 0.4858
2024-07-15 14:06:29:INFO:VAL-(cmcm) >>
2024-07-15 14:06:29:INFO:M: >>  Has0_acc_2: 0.8744  Has0_F1_score: 0.8737  Non0_acc_2: 0.8644  Non0_F1_score: 0.8658  Mult_acc_5: 0.5462  Mult_acc_7: 0.5307  MAE: 0.4943  Corr: 0.7874 
2024-07-15 14:09:46:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.4666
2024-07-15 14:10:24:INFO:VAL-(cmcm) >>
2024-07-15 14:10:24:INFO:M: >>  acc: 0.6601  weight_F1: 0.6435 
2024-07-15 14:15:48:INFO:TRAIN-(cmcm) (5/19/4)>> loss: 0.4842
2024-07-15 14:17:31:INFO:VAL-(cmcm) >>
2024-07-15 14:17:31:INFO:M: >>  Has0_acc_2: 0.8787  Has0_F1_score: 0.8764  Non0_acc_2: 0.8637  Non0_F1_score: 0.8649  Mult_acc_5: 0.5516  Mult_acc_7: 0.5339  MAE: 0.5006  Corr: 0.7888 
2024-07-15 14:17:49:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.4623
2024-07-15 14:18:28:INFO:VAL-(cmcm) >>
2024-07-15 14:18:28:INFO:M: >>  acc: 0.6528  weight_F1: 0.6396 
2024-07-15 14:19:02:INFO:Start running cmcm...
2024-07-15 14:19:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 14:19:02:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 14:19:02:INFO:Let's use the GPU 1 !
2024-07-15 14:19:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 14:19:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721024343 HTTP/1.1" 200 280
2024-07-15 14:19:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 14:19:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 14:19:04:INFO:train samples: (1284,)
2024-07-15 14:19:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 14:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721024345 HTTP/1.1" 200 280
2024-07-15 14:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 14:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 14:19:05:INFO:valid samples: (229,)
2024-07-15 14:19:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 14:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721024346 HTTP/1.1" 200 280
2024-07-15 14:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 14:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 14:19:06:INFO:test samples: (686,)
2024-07-15 14:19:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 14:19:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721024347 HTTP/1.1" 200 280
2024-07-15 14:19:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 14:19:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 14:19:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 14:19:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721024356 HTTP/1.1" 200 280
2024-07-15 14:19:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 14:19:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 14:19:19:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 14:19:19:INFO:Init labels...
2024-07-15 14:19:19:INFO:Start training...
2024-07-15 14:25:53:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 0.4595
2024-07-15 14:26:32:INFO:VAL-(cmcm) >>
2024-07-15 14:26:32:INFO:M: >>  acc: 0.6700  weight_F1: 0.6602 
2024-07-15 14:26:36:INFO:TRAIN-(cmcm) (6/20/4)>> loss: 0.4829
2024-07-15 14:26:38:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-meld-classification.pth.
2024-07-15 14:28:20:INFO:VAL-(cmcm) >>
2024-07-15 14:28:20:INFO:M: >>  Has0_acc_2: 0.8723  Has0_F1_score: 0.8711  Non0_acc_2: 0.8310  Non0_F1_score: 0.8344  Mult_acc_5: 0.5500  Mult_acc_7: 0.5339  MAE: 0.4992  Corr: 0.7847 
2024-07-15 14:34:04:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.4578
2024-07-15 14:34:43:INFO:VAL-(cmcm) >>
2024-07-15 14:34:43:INFO:M: >>  acc: 0.6510  weight_F1: 0.6444 
2024-07-15 14:37:54:INFO:TRAIN-(cmcm) (7/21/4)>> loss: 0.4815
2024-07-15 14:39:37:INFO:VAL-(cmcm) >>
2024-07-15 14:39:37:INFO:M: >>  Has0_acc_2: 0.8749  Has0_F1_score: 0.8737  Non0_acc_2: 0.8150  Non0_F1_score: 0.8191  Mult_acc_5: 0.5553  Mult_acc_7: 0.5398  MAE: 0.4881  Corr: 0.7890 
2024-07-15 14:39:43:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosei-regression.pth.
2024-07-15 14:42:08:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.4532
2024-07-15 14:42:46:INFO:VAL-(cmcm) >>
2024-07-15 14:42:46:INFO:M: >>  acc: 0.6564  weight_F1: 0.6457 
2024-07-15 14:49:18:INFO:TRAIN-(cmcm) (1/22/4)>> loss: 0.4804
2024-07-15 14:50:11:INFO:TRAIN-(cmcm) (3/20/5)>> loss: 0.4505
2024-07-15 14:50:50:INFO:VAL-(cmcm) >>
2024-07-15 14:50:50:INFO:M: >>  acc: 0.6510  weight_F1: 0.6443 
2024-07-15 14:51:02:INFO:VAL-(cmcm) >>
2024-07-15 14:51:02:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8732  Non0_acc_2: 0.8352  Non0_F1_score: 0.8385  Mult_acc_5: 0.5633  Mult_acc_7: 0.5473  MAE: 0.4824  Corr: 0.7860 
2024-07-15 14:51:07:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosei-regression.pth.
2024-07-15 14:58:15:INFO:TRAIN-(cmcm) (4/21/5)>> loss: 0.4495
2024-07-15 14:58:54:INFO:VAL-(cmcm) >>
2024-07-15 14:58:54:INFO:M: >>  acc: 0.6610  weight_F1: 0.6528 
2024-07-15 15:00:43:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 0.4792
2024-07-15 15:02:27:INFO:VAL-(cmcm) >>
2024-07-15 15:02:27:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8736  Non0_acc_2: 0.8609  Non0_F1_score: 0.8626  Mult_acc_5: 0.5510  Mult_acc_7: 0.5323  MAE: 0.5055  Corr: 0.7901 
2024-07-15 15:06:19:INFO:TRAIN-(cmcm) (5/22/5)>> loss: 0.4456
2024-07-15 15:06:58:INFO:VAL-(cmcm) >>
2024-07-15 15:06:58:INFO:M: >>  acc: 0.6528  weight_F1: 0.6461 
2024-07-15 15:11:52:INFO:TRAIN-(cmcm) (2/24/4)>> loss: 0.4782
2024-07-15 15:13:36:INFO:VAL-(cmcm) >>
2024-07-15 15:13:36:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8693  Non0_acc_2: 0.8484  Non0_F1_score: 0.8510  Mult_acc_5: 0.5575  Mult_acc_7: 0.5414  MAE: 0.4922  Corr: 0.7867 
2024-07-15 15:14:22:INFO:TRAIN-(cmcm) (6/23/5)>> loss: 0.4439
2024-07-15 15:15:01:INFO:VAL-(cmcm) >>
2024-07-15 15:15:01:INFO:M: >>  acc: 0.6537  weight_F1: 0.6431 
2024-07-15 15:22:26:INFO:TRAIN-(cmcm) (7/24/5)>> loss: 0.4405
2024-07-15 15:22:43:INFO:TRAIN-(cmcm) (3/25/4)>> loss: 0.4772
2024-07-15 15:23:04:INFO:VAL-(cmcm) >>
2024-07-15 15:23:04:INFO:M: >>  acc: 0.6691  weight_F1: 0.6549 
2024-07-15 15:24:27:INFO:VAL-(cmcm) >>
2024-07-15 15:24:27:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8715  Non0_acc_2: 0.8255  Non0_F1_score: 0.8291  Mult_acc_5: 0.5532  Mult_acc_7: 0.5355  MAE: 0.4940  Corr: 0.7838 
2024-07-15 15:30:29:INFO:TRAIN-(cmcm) (8/25/5)>> loss: 0.4382
2024-07-15 15:31:08:INFO:VAL-(cmcm) >>
2024-07-15 15:31:08:INFO:M: >>  acc: 0.6709  weight_F1: 0.6583 
2024-07-15 15:32:39:INFO:TEST-(cmcm) >>
2024-07-15 15:32:39:INFO:M: >>  acc: 0.6552  weight_F1: 0.6471 
2024-07-15 15:32:39:INFO:Results are added to results/results/meld-classification-90.csv...
2024-07-15 15:32:39:INFO:Start running cmcm...
2024-07-15 15:32:39:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 1111}>
2024-07-15 15:32:39:INFO:Let's use the GPU 1 !
2024-07-15 15:33:34:INFO:TRAIN-(cmcm) (4/26/4)>> loss: 0.4764
2024-07-15 15:35:18:INFO:VAL-(cmcm) >>
2024-07-15 15:35:18:INFO:M: >>  Has0_acc_2: 0.8728  Has0_F1_score: 0.8708  Non0_acc_2: 0.8282  Non0_F1_score: 0.8317  Mult_acc_5: 0.5542  Mult_acc_7: 0.5377  MAE: 0.4921  Corr: 0.7845 
2024-07-15 15:39:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 15:39:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721029192 HTTP/1.1" 200 280
2024-07-15 15:39:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 15:39:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 15:40:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 15:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721029221 HTTP/1.1" 200 280
2024-07-15 15:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 15:40:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 15:41:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 15:41:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721029266 HTTP/1.1" 200 280
2024-07-15 15:41:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 15:41:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 15:41:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 15:41:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721029268 HTTP/1.1" 200 280
2024-07-15 15:41:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 15:41:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 15:41:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 15:41:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721029278 HTTP/1.1" 200 280
2024-07-15 15:41:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 15:41:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 15:41:20:INFO:trainable params: 2842380 || all params: 6246426380 || trainable%: 0.04550409829692093
2024-07-15 15:41:20:INFO:Init labels...
2024-07-15 15:41:20:INFO:Start training...
2024-07-15 15:44:50:INFO:TRAIN-(cmcm) (5/27/4)>> loss: 0.4758
2024-07-15 15:46:35:INFO:VAL-(cmcm) >>
2024-07-15 15:46:35:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8682  Non0_acc_2: 0.8220  Non0_F1_score: 0.8257  Mult_acc_5: 0.5537  Mult_acc_7: 0.5355  MAE: 0.4960  Corr: 0.7813 
2024-07-15 15:55:08:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1913
2024-07-15 15:56:15:INFO:TRAIN-(cmcm) (6/28/4)>> loss: 0.4753
2024-07-15 15:57:59:INFO:VAL-(cmcm) >>
2024-07-15 15:57:59:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8696  Non0_acc_2: 0.8310  Non0_F1_score: 0.8344  Mult_acc_5: 0.5559  Mult_acc_7: 0.5377  MAE: 0.4918  Corr: 0.7831 
2024-07-15 15:58:51:INFO:VAL-(cmcm) >>
2024-07-15 15:58:51:INFO:M: >>  acc: 0.4564  weight_F1: 0.4452 
2024-07-15 15:58:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2024-07-15 16:07:28:INFO:TRAIN-(cmcm) (7/29/4)>> loss: 0.4749
2024-07-15 16:09:12:INFO:VAL-(cmcm) >>
2024-07-15 16:09:12:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8699  Non0_acc_2: 0.8338  Non0_F1_score: 0.8370  Mult_acc_5: 0.5575  Mult_acc_7: 0.5398  MAE: 0.4910  Corr: 0.7843 
2024-07-15 16:12:58:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6450
2024-07-15 16:16:41:INFO:VAL-(cmcm) >>
2024-07-15 16:16:41:INFO:M: >>  acc: 0.4815  weight_F1: 0.4417 
2024-07-15 16:18:56:INFO:TRAIN-(cmcm) (8/30/4)>> loss: 0.4747
2024-07-15 16:20:40:INFO:VAL-(cmcm) >>
2024-07-15 16:20:40:INFO:M: >>  Has0_acc_2: 0.8723  Has0_F1_score: 0.8703  Non0_acc_2: 0.8373  Non0_F1_score: 0.8404  Mult_acc_5: 0.5564  Mult_acc_7: 0.5382  MAE: 0.4924  Corr: 0.7829 
2024-07-15 16:30:21:INFO:TRAIN-(cmcm) (9/31/4)>> loss: 0.4746
2024-07-15 16:30:45:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.5086
2024-07-15 16:32:06:INFO:VAL-(cmcm) >>
2024-07-15 16:32:06:INFO:M: >>  Has0_acc_2: 0.8728  Has0_F1_score: 0.8711  Non0_acc_2: 0.8359  Non0_F1_score: 0.8390  Mult_acc_5: 0.5542  Mult_acc_7: 0.5361  MAE: 0.4924  Corr: 0.7830 
2024-07-15 16:34:29:INFO:VAL-(cmcm) >>
2024-07-15 16:34:29:INFO:M: >>  acc: 0.6375  weight_F1: 0.6010 
2024-07-15 16:34:34:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2024-07-15 16:41:45:INFO:TRAIN-(cmcm) (10/32/4)>> loss: 0.4748
2024-07-15 16:43:29:INFO:VAL-(cmcm) >>
2024-07-15 16:43:29:INFO:M: >>  Has0_acc_2: 0.8728  Has0_F1_score: 0.8715  Non0_acc_2: 0.8401  Non0_F1_score: 0.8431  Mult_acc_5: 0.5516  Mult_acc_7: 0.5350  MAE: 0.4932  Corr: 0.7858 
2024-07-15 16:47:48:INFO:TEST-(cmcm) >>
2024-07-15 16:47:48:INFO:M: >>  Has0_acc_2: 0.8682  Has0_F1_score: 0.8672  Non0_acc_2: 0.8159  Non0_F1_score: 0.8189  Mult_acc_5: 0.5639  Mult_acc_7: 0.5430  MAE: 0.5050  Corr: 0.7983 
2024-07-15 16:47:49:INFO:Results are added to results/results/mosei-regression-30.csv...
2024-07-15 16:47:49:INFO:Start running cmcm...
2024-07-15 16:47:49:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-07-15 16:47:49:INFO:Let's use the GPU 1 !
2024-07-15 16:47:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 16:47:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721033275 HTTP/1.1" 200 280
2024-07-15 16:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 16:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 16:48:00:INFO:train samples: (16326,)
2024-07-15 16:48:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 16:48:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721033288 HTTP/1.1" 200 280
2024-07-15 16:48:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 16:48:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 16:48:09:INFO:valid samples: (1871,)
2024-07-15 16:48:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 16:48:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721033295 HTTP/1.1" 200 280
2024-07-15 16:48:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 16:48:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 16:48:17:INFO:test samples: (4659,)
2024-07-15 16:48:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 16:48:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721033298 HTTP/1.1" 200 280
2024-07-15 16:48:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 16:48:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 16:48:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 16:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721033307 HTTP/1.1" 200 280
2024-07-15 16:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 16:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 16:48:29:INFO:trainable params: 2631692 || all params: 6246215692 || trainable%: 0.042132582827240604
2024-07-15 16:48:29:INFO:Init labels...
2024-07-15 16:48:29:INFO:Start training...
2024-07-15 16:48:39:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.3563
2024-07-15 16:52:22:INFO:VAL-(cmcm) >>
2024-07-15 16:52:22:INFO:M: >>  acc: 0.7050  weight_F1: 0.6952 
2024-07-15 16:52:27:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2024-07-15 16:58:00:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 0.6982
2024-07-15 16:59:44:INFO:VAL-(cmcm) >>
2024-07-15 16:59:44:INFO:M: >>  Has0_acc_2: 0.8343  Has0_F1_score: 0.8194  Non0_acc_2: 0.8108  Non0_F1_score: 0.8004  Mult_acc_5: 0.4965  Mult_acc_7: 0.4810  MAE: 0.6201  Corr: 0.6916 
2024-07-15 16:59:50:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-15 17:06:30:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.3305
2024-07-15 17:09:26:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.5400
2024-07-15 17:10:15:INFO:VAL-(cmcm) >>
2024-07-15 17:10:15:INFO:M: >>  acc: 0.7352  weight_F1: 0.7330 
2024-07-15 17:10:20:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2024-07-15 17:11:10:INFO:VAL-(cmcm) >>
2024-07-15 17:11:10:INFO:M: >>  Has0_acc_2: 0.8552  Has0_F1_score: 0.8525  Non0_acc_2: 0.8491  Non0_F1_score: 0.8458  Mult_acc_5: 0.5371  Mult_acc_7: 0.5227  MAE: 0.5676  Corr: 0.7154 
2024-07-15 17:11:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2024-07-15 17:20:59:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.5310
2024-07-15 17:22:43:INFO:VAL-(cmcm) >>
2024-07-15 17:22:43:INFO:M: >>  Has0_acc_2: 0.8578  Has0_F1_score: 0.8517  Non0_acc_2: 0.8310  Non0_F1_score: 0.8323  Mult_acc_5: 0.5355  Mult_acc_7: 0.5206  MAE: 0.5361  Corr: 0.7434 
2024-07-15 17:22:49:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2024-07-15 17:24:23:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.3142
2024-07-15 17:28:06:INFO:VAL-(cmcm) >>
2024-07-15 17:28:06:INFO:M: >>  acc: 0.7372  weight_F1: 0.7322 
2024-07-15 17:32:28:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.5238
2024-07-15 17:34:13:INFO:VAL-(cmcm) >>
2024-07-15 17:34:13:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8581  Non0_acc_2: 0.8755  Non0_F1_score: 0.8761  Mult_acc_5: 0.5478  Mult_acc_7: 0.5355  MAE: 0.5193  Corr: 0.7523 
2024-07-15 17:34:18:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2024-07-15 17:42:10:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.3023
2024-07-15 17:43:56:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5186
2024-07-15 17:45:41:INFO:VAL-(cmcm) >>
2024-07-15 17:45:41:INFO:M: >>  Has0_acc_2: 0.8669  Has0_F1_score: 0.8675  Non0_acc_2: 0.8734  Non0_F1_score: 0.8728  Mult_acc_5: 0.5484  Mult_acc_7: 0.5323  MAE: 0.5395  Corr: 0.7568 
2024-07-15 17:45:54:INFO:VAL-(cmcm) >>
2024-07-15 17:45:54:INFO:M: >>  acc: 0.7500  weight_F1: 0.7489 
2024-07-15 17:45:59:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-cherma-classification.pth.
2024-07-15 17:55:20:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.5139
2024-07-15 17:57:04:INFO:VAL-(cmcm) >>
2024-07-15 17:57:04:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8686  Non0_acc_2: 0.7448  Non0_F1_score: 0.7499  Mult_acc_5: 0.5366  Mult_acc_7: 0.5216  MAE: 0.5080  Corr: 0.7519 
2024-07-15 17:57:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-15 18:00:07:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.2960
2024-07-15 18:03:52:INFO:VAL-(cmcm) >>
2024-07-15 18:03:52:INFO:M: >>  acc: 0.7538  weight_F1: 0.7509 
2024-07-15 18:03:57:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2024-07-15 18:06:54:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.5108
2024-07-15 18:08:40:INFO:VAL-(cmcm) >>
2024-07-15 18:08:40:INFO:M: >>  Has0_acc_2: 0.8717  Has0_F1_score: 0.8711  Non0_acc_2: 0.8547  Non0_F1_score: 0.8560  Mult_acc_5: 0.5211  Mult_acc_7: 0.5029  MAE: 0.5310  Corr: 0.7774 
2024-07-15 18:18:02:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.2877
2024-07-15 18:18:21:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.5077
2024-07-15 18:20:06:INFO:VAL-(cmcm) >>
2024-07-15 18:20:06:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8705  Non0_acc_2: 0.7559  Non0_F1_score: 0.7607  Mult_acc_5: 0.5596  Mult_acc_7: 0.5414  MAE: 0.4968  Corr: 0.7676 
2024-07-15 18:20:11:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosei-regression.pth.
2024-07-15 18:21:46:INFO:VAL-(cmcm) >>
2024-07-15 18:21:46:INFO:M: >>  acc: 0.7486  weight_F1: 0.7469 
2024-07-15 18:30:01:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.5057
2024-07-15 18:31:46:INFO:VAL-(cmcm) >>
2024-07-15 18:31:46:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8718  Non0_acc_2: 0.7024  Non0_F1_score: 0.7046  Mult_acc_5: 0.5751  Mult_acc_7: 0.5591  MAE: 0.4951  Corr: 0.7619 
2024-07-15 18:31:51:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosei-regression.pth.
2024-07-15 18:35:42:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.2809
2024-07-15 18:39:26:INFO:VAL-(cmcm) >>
2024-07-15 18:39:26:INFO:M: >>  acc: 0.7449  weight_F1: 0.7472 
2024-07-15 18:41:28:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.5016
2024-07-15 18:43:12:INFO:VAL-(cmcm) >>
2024-07-15 18:43:12:INFO:M: >>  Has0_acc_2: 0.8776  Has0_F1_score: 0.8761  Non0_acc_2: 0.8122  Non0_F1_score: 0.8163  Mult_acc_5: 0.5751  Mult_acc_7: 0.5585  MAE: 0.4850  Corr: 0.7820 
2024-07-15 18:43:18:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2024-07-15 18:52:56:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.4973
2024-07-15 18:53:31:INFO:TRAIN-(cmcm) (3/11/1)>> loss: 0.2753
2024-07-15 18:54:08:INFO:Start running cmcm...
2024-07-15 18:54:08:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 18:54:08:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 18:54:08:INFO:Let's use the GPU 1 !
2024-07-15 18:54:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:54:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721040849 HTTP/1.1" 200 280
2024-07-15 18:54:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:54:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:54:10:INFO:train samples: (1284,)
2024-07-15 18:54:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:54:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721040850 HTTP/1.1" 200 280
2024-07-15 18:54:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:54:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:54:11:INFO:valid samples: (229,)
2024-07-15 18:54:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:54:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721040852 HTTP/1.1" 200 280
2024-07-15 18:54:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:54:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:54:13:INFO:test samples: (686,)
2024-07-15 18:54:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:54:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721040853 HTTP/1.1" 200 280
2024-07-15 18:54:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:54:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:54:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:54:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721040862 HTTP/1.1" 200 280
2024-07-15 18:54:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:54:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:54:26:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 18:54:26:INFO:Init labels...
2024-07-15 18:54:26:INFO:Start training...
2024-07-15 18:54:40:INFO:VAL-(cmcm) >>
2024-07-15 18:54:40:INFO:M: >>  Has0_acc_2: 0.8739  Has0_F1_score: 0.8748  Non0_acc_2: 0.8039  Non0_F1_score: 0.8083  Mult_acc_5: 0.5612  Mult_acc_7: 0.5436  MAE: 0.4891  Corr: 0.7803 
2024-07-15 18:56:46:INFO:Start running cmcm...
2024-07-15 18:56:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 18:56:46:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 18:56:46:INFO:Let's use the GPU 1 !
2024-07-15 18:56:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:56:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721041006 HTTP/1.1" 200 280
2024-07-15 18:56:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:56:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:56:47:INFO:train samples: (1284,)
2024-07-15 18:56:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:56:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721041008 HTTP/1.1" 200 280
2024-07-15 18:56:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:56:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:56:49:INFO:valid samples: (229,)
2024-07-15 18:56:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:56:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721041010 HTTP/1.1" 200 280
2024-07-15 18:56:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:56:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:56:50:INFO:test samples: (686,)
2024-07-15 18:56:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:56:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721041011 HTTP/1.1" 200 280
2024-07-15 18:56:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:56:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:57:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 18:57:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721041020 HTTP/1.1" 200 280
2024-07-15 18:57:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 18:57:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 18:57:04:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 18:57:04:INFO:Init labels...
2024-07-15 18:57:04:INFO:Start training...
2024-07-15 18:57:17:INFO:VAL-(cmcm) >>
2024-07-15 18:57:17:INFO:M: >>  acc: 0.7479  weight_F1: 0.7464 
2024-07-15 18:57:50:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.5646
2024-07-15 18:58:03:INFO:VAL-(cmcm) >>
2024-07-15 18:58:03:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8352  Non0_acc_2: 0.8287  Non0_F1_score: 0.8293  Mult_acc_5: 0.5415  Mult_acc_7: 0.3231  MAE: 1.0499  Corr: 0.7951 
2024-07-15 18:58:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 18:58:56:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.5426
2024-07-15 18:59:09:INFO:VAL-(cmcm) >>
2024-07-15 18:59:09:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8393  Non0_acc_2: 0.8426  Non0_F1_score: 0.8433  Mult_acc_5: 0.5459  Mult_acc_7: 0.3319  MAE: 1.0031  Corr: 0.8133 
2024-07-15 18:59:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:00:02:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 1.4229
2024-07-15 19:00:15:INFO:VAL-(cmcm) >>
2024-07-15 19:00:15:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8611  Non0_F1_score: 0.8619  Mult_acc_5: 0.5502  Mult_acc_7: 0.3799  MAE: 0.8953  Corr: 0.8284 
2024-07-15 19:00:21:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:01:07:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8595
2024-07-15 19:01:20:INFO:VAL-(cmcm) >>
2024-07-15 19:01:20:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8473  Non0_acc_2: 0.8657  Non0_F1_score: 0.8663  Mult_acc_5: 0.5764  Mult_acc_7: 0.4629  MAE: 0.7149  Corr: 0.8470 
2024-07-15 19:01:26:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:02:13:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.6651
2024-07-15 19:02:26:INFO:VAL-(cmcm) >>
2024-07-15 19:02:26:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8700  Non0_acc_2: 0.8935  Non0_F1_score: 0.8939  Mult_acc_5: 0.5022  Mult_acc_7: 0.3930  MAE: 0.7049  Corr: 0.8386 
2024-07-15 19:02:32:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:03:19:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.5882
2024-07-15 19:03:32:INFO:VAL-(cmcm) >>
2024-07-15 19:03:32:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8650  Non0_acc_2: 0.8935  Non0_F1_score: 0.8938  Mult_acc_5: 0.5371  Mult_acc_7: 0.4105  MAE: 0.7049  Corr: 0.8366 
2024-07-15 19:04:18:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.5656
2024-07-15 19:04:31:INFO:TRAIN-(cmcm) (2/12/5)>> loss: 0.4952
2024-07-15 19:04:31:INFO:VAL-(cmcm) >>
2024-07-15 19:04:31:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8569  Non0_acc_2: 0.8981  Non0_F1_score: 0.8987  Mult_acc_5: 0.5633  Mult_acc_7: 0.4410  MAE: 0.6560  Corr: 0.8541 
2024-07-15 19:04:37:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:05:23:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.5523
2024-07-15 19:05:37:INFO:VAL-(cmcm) >>
2024-07-15 19:05:37:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8699  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.4978  Mult_acc_7: 0.3886  MAE: 0.6905  Corr: 0.8451 
2024-07-15 19:06:18:INFO:VAL-(cmcm) >>
2024-07-15 19:06:18:INFO:M: >>  Has0_acc_2: 0.8691  Has0_F1_score: 0.8699  Non0_acc_2: 0.8157  Non0_F1_score: 0.8197  Mult_acc_5: 0.5772  Mult_acc_7: 0.5596  MAE: 0.4869  Corr: 0.7826 
2024-07-15 19:06:22:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.5473
2024-07-15 19:06:35:INFO:VAL-(cmcm) >>
2024-07-15 19:06:35:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8889  Non0_F1_score: 0.8895  Mult_acc_5: 0.5633  Mult_acc_7: 0.4454  MAE: 0.6398  Corr: 0.8591 
2024-07-15 19:06:42:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:07:29:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.5399
2024-07-15 19:07:43:INFO:VAL-(cmcm) >>
2024-07-15 19:07:43:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8773  Non0_acc_2: 0.8796  Non0_F1_score: 0.8802  Mult_acc_5: 0.5502  Mult_acc_7: 0.4367  MAE: 0.6455  Corr: 0.8586 
2024-07-15 19:08:27:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.5350
2024-07-15 19:08:41:INFO:VAL-(cmcm) >>
2024-07-15 19:08:41:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8935  Non0_F1_score: 0.8941  Mult_acc_5: 0.5284  Mult_acc_7: 0.4192  MAE: 0.6616  Corr: 0.8539 
2024-07-15 19:09:26:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.5320
2024-07-15 19:09:39:INFO:VAL-(cmcm) >>
2024-07-15 19:09:39:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8775  Non0_acc_2: 0.8796  Non0_F1_score: 0.8800  Mult_acc_5: 0.5546  Mult_acc_7: 0.4410  MAE: 0.6547  Corr: 0.8537 
2024-07-15 19:10:23:INFO:TRAIN-(cmcm) (4/13/1)>> loss: 0.5297
2024-07-15 19:10:36:INFO:VAL-(cmcm) >>
2024-07-15 19:10:36:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8652  Non0_acc_2: 0.8889  Non0_F1_score: 0.8895  Mult_acc_5: 0.5546  Mult_acc_7: 0.4410  MAE: 0.6503  Corr: 0.8576 
2024-07-15 19:11:20:INFO:TRAIN-(cmcm) (5/14/1)>> loss: 0.5267
2024-07-15 19:11:33:INFO:TRAIN-(cmcm) (4/12/1)>> loss: 0.2695
2024-07-15 19:11:34:INFO:VAL-(cmcm) >>
2024-07-15 19:11:34:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8560  Non0_acc_2: 0.8843  Non0_F1_score: 0.8849  Mult_acc_5: 0.5066  Mult_acc_7: 0.3974  MAE: 0.6979  Corr: 0.8409 
2024-07-15 19:12:21:INFO:TRAIN-(cmcm) (6/15/1)>> loss: 0.5250
2024-07-15 19:12:34:INFO:VAL-(cmcm) >>
2024-07-15 19:12:34:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8548  Non0_acc_2: 0.8935  Non0_F1_score: 0.8941  Mult_acc_5: 0.5590  Mult_acc_7: 0.4454  MAE: 0.6394  Corr: 0.8625 
2024-07-15 19:12:40:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:13:28:INFO:TRAIN-(cmcm) (1/16/1)>> loss: 0.5207
2024-07-15 19:13:41:INFO:VAL-(cmcm) >>
2024-07-15 19:13:41:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8555  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5371  Mult_acc_7: 0.4236  MAE: 0.6577  Corr: 0.8579 
2024-07-15 19:14:26:INFO:TRAIN-(cmcm) (2/17/1)>> loss: 0.5164
2024-07-15 19:14:40:INFO:VAL-(cmcm) >>
2024-07-15 19:14:40:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8730  Non0_acc_2: 0.8981  Non0_F1_score: 0.8983  Mult_acc_5: 0.5415  Mult_acc_7: 0.4192  MAE: 0.6634  Corr: 0.8546 
2024-07-15 19:15:20:INFO:VAL-(cmcm) >>
2024-07-15 19:15:20:INFO:M: >>  acc: 0.7433  weight_F1: 0.7411 
2024-07-15 19:15:27:INFO:TRAIN-(cmcm) (3/18/1)>> loss: 0.5166
2024-07-15 19:15:41:INFO:VAL-(cmcm) >>
2024-07-15 19:15:41:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8653  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6804  Corr: 0.8465 
2024-07-15 19:16:26:INFO:TRAIN-(cmcm) (4/19/1)>> loss: 0.5148
2024-07-15 19:16:35:INFO:TRAIN-(cmcm) (3/13/5)>> loss: 0.4934
2024-07-15 19:16:39:INFO:VAL-(cmcm) >>
2024-07-15 19:16:39:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.5415  Mult_acc_7: 0.4279  MAE: 0.6616  Corr: 0.8561 
2024-07-15 19:17:24:INFO:TRAIN-(cmcm) (5/20/1)>> loss: 0.5128
2024-07-15 19:17:38:INFO:VAL-(cmcm) >>
2024-07-15 19:17:38:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5066  Mult_acc_7: 0.3974  MAE: 0.6839  Corr: 0.8477 
2024-07-15 19:18:20:INFO:VAL-(cmcm) >>
2024-07-15 19:18:20:INFO:M: >>  Has0_acc_2: 0.8803  Has0_F1_score: 0.8792  Non0_acc_2: 0.7566  Non0_F1_score: 0.7614  Mult_acc_5: 0.5799  Mult_acc_7: 0.5655  MAE: 0.4816  Corr: 0.7745 
2024-07-15 19:18:24:INFO:TRAIN-(cmcm) (6/21/1)>> loss: 0.5112
2024-07-15 19:18:26:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosei-regression.pth.
2024-07-15 19:18:37:INFO:VAL-(cmcm) >>
2024-07-15 19:18:37:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.5328  Mult_acc_7: 0.4192  MAE: 0.6774  Corr: 0.8485 
2024-07-15 19:19:23:INFO:TRAIN-(cmcm) (7/22/1)>> loss: 0.5099
2024-07-15 19:19:36:INFO:VAL-(cmcm) >>
2024-07-15 19:19:36:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8682  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6713  Corr: 0.8526 
2024-07-15 19:20:22:INFO:TRAIN-(cmcm) (8/23/1)>> loss: 0.5079
2024-07-15 19:20:35:INFO:VAL-(cmcm) >>
2024-07-15 19:20:35:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5328  Mult_acc_7: 0.4192  MAE: 0.6603  Corr: 0.8568 
2024-07-15 19:21:20:INFO:TRAIN-(cmcm) (9/24/1)>> loss: 0.5070
2024-07-15 19:21:34:INFO:VAL-(cmcm) >>
2024-07-15 19:21:34:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6669  Corr: 0.8550 
2024-07-15 19:22:19:INFO:TRAIN-(cmcm) (10/25/1)>> loss: 0.5052
2024-07-15 19:22:33:INFO:VAL-(cmcm) >>
2024-07-15 19:22:33:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8940  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6726  Corr: 0.8536 
2024-07-15 19:23:13:INFO:TEST-(cmcm) >>
2024-07-15 19:23:13:INFO:M: >>  Has0_acc_2: 0.8644  Has0_F1_score: 0.8645  Non0_acc_2: 0.8643  Non0_F1_score: 0.8616  Mult_acc_5: 0.5087  Mult_acc_7: 0.4315  MAE: 0.6928  Corr: 0.8222 
2024-07-15 19:23:14:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 19:23:14:INFO:Start running cmcm...
2024-07-15 19:23:14:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-07-15 19:23:14:INFO:Let's use the GPU 1 !
2024-07-15 19:23:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:23:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721042595 HTTP/1.1" 200 280
2024-07-15 19:23:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:23:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:23:15:INFO:train samples: (1284,)
2024-07-15 19:23:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:23:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721042596 HTTP/1.1" 200 280
2024-07-15 19:23:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:23:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:23:17:INFO:valid samples: (229,)
2024-07-15 19:23:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721042598 HTTP/1.1" 200 280
2024-07-15 19:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:23:18:INFO:test samples: (686,)
2024-07-15 19:23:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721042599 HTTP/1.1" 200 280
2024-07-15 19:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:23:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:23:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721042608 HTTP/1.1" 200 280
2024-07-15 19:23:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:23:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:23:30:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 19:23:30:INFO:Init labels...
2024-07-15 19:23:30:INFO:Start training...
2024-07-15 19:24:16:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.6451
2024-07-15 19:24:29:INFO:VAL-(cmcm) >>
2024-07-15 19:24:29:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7657  Non0_acc_2: 0.8056  Non0_F1_score: 0.8046  Mult_acc_5: 0.4760  Mult_acc_7: 0.2707  MAE: 1.2573  Corr: 0.7020 
2024-07-15 19:24:35:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:25:24:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.3273
2024-07-15 19:25:37:INFO:VAL-(cmcm) >>
2024-07-15 19:25:37:INFO:M: >>  Has0_acc_2: 0.8122  Has0_F1_score: 0.8141  Non0_acc_2: 0.8287  Non0_F1_score: 0.8288  Mult_acc_5: 0.4934  Mult_acc_7: 0.3319  MAE: 1.0232  Corr: 0.7782 
2024-07-15 19:25:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:26:30:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.7483
2024-07-15 19:26:44:INFO:VAL-(cmcm) >>
2024-07-15 19:26:44:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8435  Non0_acc_2: 0.8750  Non0_F1_score: 0.8749  Mult_acc_5: 0.5721  Mult_acc_7: 0.4803  MAE: 0.7398  Corr: 0.8101 
2024-07-15 19:26:50:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:27:37:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.6324
2024-07-15 19:27:50:INFO:VAL-(cmcm) >>
2024-07-15 19:27:50:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8480  Non0_acc_2: 0.8750  Non0_F1_score: 0.8749  Mult_acc_5: 0.5415  Mult_acc_7: 0.4323  MAE: 0.7961  Corr: 0.7973 
2024-07-15 19:28:35:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.6082
2024-07-15 19:28:45:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.4917
2024-07-15 19:28:49:INFO:VAL-(cmcm) >>
2024-07-15 19:28:49:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8650  Non0_acc_2: 0.8843  Non0_F1_score: 0.8840  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.7721  Corr: 0.8067 
2024-07-15 19:29:28:INFO:TRAIN-(cmcm) (5/13/1)>> loss: 0.2643
2024-07-15 19:29:32:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.5930
2024-07-15 19:29:45:INFO:VAL-(cmcm) >>
2024-07-15 19:29:45:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8587  Non0_acc_2: 0.8704  Non0_F1_score: 0.8685  Mult_acc_5: 0.5371  Mult_acc_7: 0.4279  MAE: 0.7935  Corr: 0.8060 
2024-07-15 19:30:31:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.5832
2024-07-15 19:30:31:INFO:VAL-(cmcm) >>
2024-07-15 19:30:31:INFO:M: >>  Has0_acc_2: 0.8744  Has0_F1_score: 0.8732  Non0_acc_2: 0.8261  Non0_F1_score: 0.8295  Mult_acc_5: 0.5548  Mult_acc_7: 0.5361  MAE: 0.5089  Corr: 0.7822 
2024-07-15 19:30:44:INFO:VAL-(cmcm) >>
2024-07-15 19:30:44:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8609  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5459  Mult_acc_7: 0.4279  MAE: 0.8053  Corr: 0.7947 
2024-07-15 19:31:30:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.5760
2024-07-15 19:31:43:INFO:VAL-(cmcm) >>
2024-07-15 19:31:43:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8484  Non0_acc_2: 0.8750  Non0_F1_score: 0.8754  Mult_acc_5: 0.5677  Mult_acc_7: 0.4410  MAE: 0.7499  Corr: 0.8146 
2024-07-15 19:32:29:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.5718
2024-07-15 19:32:42:INFO:VAL-(cmcm) >>
2024-07-15 19:32:42:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8520  Non0_acc_2: 0.8796  Non0_F1_score: 0.8792  Mult_acc_5: 0.5153  Mult_acc_7: 0.4105  MAE: 0.7905  Corr: 0.7957 
2024-07-15 19:33:14:INFO:VAL-(cmcm) >>
2024-07-15 19:33:14:INFO:M: >>  acc: 0.7567  weight_F1: 0.7568 
2024-07-15 19:33:19:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-cherma-classification.pth.
2024-07-15 19:33:29:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.5686
2024-07-15 19:33:42:INFO:VAL-(cmcm) >>
2024-07-15 19:33:42:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8645  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5328  Mult_acc_7: 0.4236  MAE: 0.7795  Corr: 0.8060 
2024-07-15 19:34:27:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.5602
2024-07-15 19:34:40:INFO:VAL-(cmcm) >>
2024-07-15 19:34:40:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8566  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5197  Mult_acc_7: 0.4279  MAE: 0.7979  Corr: 0.7968 
2024-07-15 19:35:26:INFO:TRAIN-(cmcm) (9/12/2)>> loss: 0.5622
2024-07-15 19:35:39:INFO:VAL-(cmcm) >>
2024-07-15 19:35:39:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8843  Non0_F1_score: 0.8838  Mult_acc_5: 0.4978  Mult_acc_7: 0.4017  MAE: 0.8547  Corr: 0.7902 
2024-07-15 19:36:24:INFO:TRAIN-(cmcm) (10/13/2)>> loss: 0.5575
2024-07-15 19:36:38:INFO:VAL-(cmcm) >>
2024-07-15 19:36:38:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8484  Non0_acc_2: 0.8796  Non0_F1_score: 0.8799  Mult_acc_5: 0.5633  Mult_acc_7: 0.4629  MAE: 0.7171  Corr: 0.8233 
2024-07-15 19:36:44:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:37:30:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.5555
2024-07-15 19:37:43:INFO:VAL-(cmcm) >>
2024-07-15 19:37:43:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8522  Non0_acc_2: 0.8796  Non0_F1_score: 0.8794  Mult_acc_5: 0.5590  Mult_acc_7: 0.4498  MAE: 0.7167  Corr: 0.8240 
2024-07-15 19:37:49:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:38:38:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.5508
2024-07-15 19:38:51:INFO:VAL-(cmcm) >>
2024-07-15 19:38:51:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8843  Non0_F1_score: 0.8833  Mult_acc_5: 0.5371  Mult_acc_7: 0.4323  MAE: 0.7734  Corr: 0.8189 
2024-07-15 19:39:36:INFO:TRAIN-(cmcm) (2/16/2)>> loss: 0.5441
2024-07-15 19:39:50:INFO:VAL-(cmcm) >>
2024-07-15 19:39:50:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8609  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5546  Mult_acc_7: 0.4629  MAE: 0.7197  Corr: 0.8253 
2024-07-15 19:40:35:INFO:TRAIN-(cmcm) (3/17/2)>> loss: 0.5435
2024-07-15 19:40:43:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.4901
2024-07-15 19:40:48:INFO:VAL-(cmcm) >>
2024-07-15 19:40:48:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8518  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5415  Mult_acc_7: 0.4410  MAE: 0.7416  Corr: 0.8193 
2024-07-15 19:41:34:INFO:TRAIN-(cmcm) (4/18/2)>> loss: 0.5412
2024-07-15 19:41:48:INFO:VAL-(cmcm) >>
2024-07-15 19:41:48:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8481  Non0_acc_2: 0.8796  Non0_F1_score: 0.8796  Mult_acc_5: 0.5502  Mult_acc_7: 0.4498  MAE: 0.7472  Corr: 0.8203 
2024-07-15 19:42:28:INFO:VAL-(cmcm) >>
2024-07-15 19:42:28:INFO:M: >>  Has0_acc_2: 0.8797  Has0_F1_score: 0.8788  Non0_acc_2: 0.7969  Non0_F1_score: 0.8015  Mult_acc_5: 0.5655  Mult_acc_7: 0.5473  MAE: 0.4916  Corr: 0.7791 
2024-07-15 19:42:34:INFO:TRAIN-(cmcm) (5/19/2)>> loss: 0.5357
2024-07-15 19:42:47:INFO:VAL-(cmcm) >>
2024-07-15 19:42:47:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8515  Non0_acc_2: 0.8704  Non0_F1_score: 0.8697  Mult_acc_5: 0.5459  Mult_acc_7: 0.4323  MAE: 0.7276  Corr: 0.8280 
2024-07-15 19:43:34:INFO:TRAIN-(cmcm) (6/20/2)>> loss: 0.5353
2024-07-15 19:43:47:INFO:VAL-(cmcm) >>
2024-07-15 19:43:47:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8612  Non0_acc_2: 0.8889  Non0_F1_score: 0.8890  Mult_acc_5: 0.5284  Mult_acc_7: 0.4279  MAE: 0.7306  Corr: 0.8245 
2024-07-15 19:44:33:INFO:TRAIN-(cmcm) (7/21/2)>> loss: 0.5322
2024-07-15 19:44:46:INFO:VAL-(cmcm) >>
2024-07-15 19:44:46:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8558  Non0_acc_2: 0.8704  Non0_F1_score: 0.8700  Mult_acc_5: 0.5502  Mult_acc_7: 0.4367  MAE: 0.7324  Corr: 0.8241 
2024-07-15 19:45:32:INFO:TRAIN-(cmcm) (8/22/2)>> loss: 0.5289
2024-07-15 19:45:45:INFO:VAL-(cmcm) >>
2024-07-15 19:45:45:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.8796  Non0_F1_score: 0.8794  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.7302  Corr: 0.8247 
2024-07-15 19:46:30:INFO:TRAIN-(cmcm) (9/23/2)>> loss: 0.5259
2024-07-15 19:46:44:INFO:VAL-(cmcm) >>
2024-07-15 19:46:44:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8515  Non0_acc_2: 0.8704  Non0_F1_score: 0.8700  Mult_acc_5: 0.5546  Mult_acc_7: 0.4454  MAE: 0.7311  Corr: 0.8238 
2024-07-15 19:47:29:INFO:TRAIN-(cmcm) (10/24/2)>> loss: 0.5225
2024-07-15 19:47:35:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.2584
2024-07-15 19:47:43:INFO:VAL-(cmcm) >>
2024-07-15 19:47:43:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8515  Non0_acc_2: 0.8704  Non0_F1_score: 0.8697  Mult_acc_5: 0.5371  Mult_acc_7: 0.4323  MAE: 0.7184  Corr: 0.8308 
2024-07-15 19:48:23:INFO:TEST-(cmcm) >>
2024-07-15 19:48:23:INFO:M: >>  Has0_acc_2: 0.8630  Has0_F1_score: 0.8623  Non0_acc_2: 0.8857  Non0_F1_score: 0.8855  Mult_acc_5: 0.5029  Mult_acc_7: 0.4140  MAE: 0.7412  Corr: 0.8121 
2024-07-15 19:48:23:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 19:48:23:INFO:Start running cmcm...
2024-07-15 19:48:23:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-07-15 19:48:23:INFO:Let's use the GPU 1 !
2024-07-15 19:48:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:48:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721044104 HTTP/1.1" 200 280
2024-07-15 19:48:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:48:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:48:25:INFO:train samples: (1284,)
2024-07-15 19:48:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:48:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721044105 HTTP/1.1" 200 280
2024-07-15 19:48:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:48:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:48:26:INFO:valid samples: (229,)
2024-07-15 19:48:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721044107 HTTP/1.1" 200 280
2024-07-15 19:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:48:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:48:28:INFO:test samples: (686,)
2024-07-15 19:48:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:48:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721044108 HTTP/1.1" 200 280
2024-07-15 19:48:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:48:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:48:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 19:48:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721044117 HTTP/1.1" 200 280
2024-07-15 19:48:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 19:48:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 19:48:39:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 19:48:39:INFO:Init labels...
2024-07-15 19:48:39:INFO:Start training...
2024-07-15 19:49:26:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.4614
2024-07-15 19:49:39:INFO:VAL-(cmcm) >>
2024-07-15 19:49:39:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8395  Non0_acc_2: 0.8426  Non0_F1_score: 0.8434  Mult_acc_5: 0.5415  Mult_acc_7: 0.3581  MAE: 0.9800  Corr: 0.7991 
2024-07-15 19:49:45:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:50:32:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.7881
2024-07-15 19:50:46:INFO:VAL-(cmcm) >>
2024-07-15 19:50:46:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8653  Non0_acc_2: 0.8935  Non0_F1_score: 0.8937  Mult_acc_5: 0.5197  Mult_acc_7: 0.3930  MAE: 0.7114  Corr: 0.8302 
2024-07-15 19:50:52:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:51:22:INFO:VAL-(cmcm) >>
2024-07-15 19:51:22:INFO:M: >>  acc: 0.7574  weight_F1: 0.7549 
2024-07-15 19:51:39:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.6157
2024-07-15 19:51:52:INFO:VAL-(cmcm) >>
2024-07-15 19:51:52:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.9028  Non0_F1_score: 0.9030  Mult_acc_5: 0.4541  Mult_acc_7: 0.3537  MAE: 0.7206  Corr: 0.8320 
2024-07-15 19:52:37:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.5755
2024-07-15 19:52:42:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.4881
2024-07-15 19:52:50:INFO:VAL-(cmcm) >>
2024-07-15 19:52:50:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8633  Non0_acc_2: 0.8843  Non0_F1_score: 0.8848  Mult_acc_5: 0.5109  Mult_acc_7: 0.3974  MAE: 0.6861  Corr: 0.8490 
2024-07-15 19:52:56:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:53:45:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5602
2024-07-15 19:53:58:INFO:VAL-(cmcm) >>
2024-07-15 19:53:58:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5764  Mult_acc_7: 0.4585  MAE: 0.6237  Corr: 0.8663 
2024-07-15 19:54:04:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-07-15 19:54:28:INFO:VAL-(cmcm) >>
2024-07-15 19:54:28:INFO:M: >>  Has0_acc_2: 0.8749  Has0_F1_score: 0.8706  Non0_acc_2: 0.8359  Non0_F1_score: 0.8385  Mult_acc_5: 0.5671  Mult_acc_7: 0.5505  MAE: 0.5022  Corr: 0.7774 
2024-07-15 19:54:51:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.5481
2024-07-15 19:55:05:INFO:VAL-(cmcm) >>
2024-07-15 19:55:05:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8812  Non0_acc_2: 0.8981  Non0_F1_score: 0.8972  Mult_acc_5: 0.5109  Mult_acc_7: 0.3886  MAE: 0.6429  Corr: 0.8658 
2024-07-15 19:55:50:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.5349
2024-07-15 19:56:03:INFO:VAL-(cmcm) >>
2024-07-15 19:56:03:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8475  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5677  Mult_acc_7: 0.4410  MAE: 0.6398  Corr: 0.8630 
2024-07-15 19:56:49:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.5288
2024-07-15 19:57:03:INFO:VAL-(cmcm) >>
2024-07-15 19:57:03:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8935  Non0_F1_score: 0.8926  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6333  Corr: 0.8685 
2024-07-15 19:57:48:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.5263
2024-07-15 19:58:01:INFO:VAL-(cmcm) >>
2024-07-15 19:58:01:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8935  Non0_F1_score: 0.8926  Mult_acc_5: 0.5197  Mult_acc_7: 0.3974  MAE: 0.6507  Corr: 0.8619 
2024-07-15 19:58:46:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.5190
2024-07-15 19:58:59:INFO:VAL-(cmcm) >>
2024-07-15 19:58:59:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8767  Non0_acc_2: 0.8981  Non0_F1_score: 0.8974  Mult_acc_5: 0.5459  Mult_acc_7: 0.4236  MAE: 0.6267  Corr: 0.8679 
2024-07-15 19:59:44:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.5157
2024-07-15 19:59:58:INFO:VAL-(cmcm) >>
2024-07-15 19:59:58:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8730  Non0_acc_2: 0.9028  Non0_F1_score: 0.9022  Mult_acc_5: 0.5590  Mult_acc_7: 0.4367  MAE: 0.6127  Corr: 0.8766 
2024-07-15 20:00:04:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:00:50:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.5081
2024-07-15 20:01:04:INFO:VAL-(cmcm) >>
2024-07-15 20:01:04:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8727  Non0_acc_2: 0.9028  Non0_F1_score: 0.9022  Mult_acc_5: 0.5240  Mult_acc_7: 0.4148  MAE: 0.6018  Corr: 0.8765 
2024-07-15 20:01:10:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:01:56:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.5027
2024-07-15 20:02:09:INFO:VAL-(cmcm) >>
2024-07-15 20:02:10:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8721  Non0_acc_2: 0.8889  Non0_F1_score: 0.8878  Mult_acc_5: 0.5633  Mult_acc_7: 0.4454  MAE: 0.6127  Corr: 0.8703 
2024-07-15 20:02:57:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.4989
2024-07-15 20:03:10:INFO:VAL-(cmcm) >>
2024-07-15 20:03:10:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8981  Non0_F1_score: 0.8976  Mult_acc_5: 0.5415  Mult_acc_7: 0.4236  MAE: 0.6075  Corr: 0.8734 
2024-07-15 20:03:54:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.4935
2024-07-15 20:04:08:INFO:VAL-(cmcm) >>
2024-07-15 20:04:08:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8981  Non0_F1_score: 0.8974  Mult_acc_5: 0.5415  Mult_acc_7: 0.4236  MAE: 0.6293  Corr: 0.8689 
2024-07-15 20:04:39:INFO:TRAIN-(cmcm) (4/17/5)>> loss: 0.4872
2024-07-15 20:04:55:INFO:TRAIN-(cmcm) (4/16/3)>> loss: 0.4906
2024-07-15 20:05:08:INFO:VAL-(cmcm) >>
2024-07-15 20:05:08:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8597  Non0_acc_2: 0.9028  Non0_F1_score: 0.9022  Mult_acc_5: 0.5197  Mult_acc_7: 0.3974  MAE: 0.6223  Corr: 0.8713 
2024-07-15 20:05:35:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.2531
2024-07-15 20:05:53:INFO:TRAIN-(cmcm) (5/17/3)>> loss: 0.4861
2024-07-15 20:06:06:INFO:VAL-(cmcm) >>
2024-07-15 20:06:06:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8629  Non0_acc_2: 0.8889  Non0_F1_score: 0.8878  Mult_acc_5: 0.5633  Mult_acc_7: 0.4367  MAE: 0.6245  Corr: 0.8732 
2024-07-15 20:06:24:INFO:VAL-(cmcm) >>
2024-07-15 20:06:24:INFO:M: >>  Has0_acc_2: 0.8749  Has0_F1_score: 0.8718  Non0_acc_2: 0.7955  Non0_F1_score: 0.8001  Mult_acc_5: 0.5740  Mult_acc_7: 0.5580  MAE: 0.4896  Corr: 0.7774 
2024-07-15 20:06:51:INFO:TRAIN-(cmcm) (6/18/3)>> loss: 0.4837
2024-07-15 20:07:04:INFO:VAL-(cmcm) >>
2024-07-15 20:07:04:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8682  Non0_acc_2: 0.9074  Non0_F1_score: 0.9073  Mult_acc_5: 0.5590  Mult_acc_7: 0.4410  MAE: 0.5769  Corr: 0.8848 
2024-07-15 20:07:10:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:07:58:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.4752
2024-07-15 20:08:11:INFO:VAL-(cmcm) >>
2024-07-15 20:08:11:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8597  Non0_acc_2: 0.9120  Non0_F1_score: 0.9118  Mult_acc_5: 0.5721  Mult_acc_7: 0.4541  MAE: 0.5909  Corr: 0.8804 
2024-07-15 20:08:56:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.4718
2024-07-15 20:09:09:INFO:VAL-(cmcm) >>
2024-07-15 20:09:09:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8520  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5284  Mult_acc_7: 0.4148  MAE: 0.6306  Corr: 0.8682 
2024-07-15 20:09:22:INFO:VAL-(cmcm) >>
2024-07-15 20:09:22:INFO:M: >>  acc: 0.7576  weight_F1: 0.7567 
2024-07-15 20:09:56:INFO:TRAIN-(cmcm) (3/21/3)>> loss: 0.4696
2024-07-15 20:10:10:INFO:VAL-(cmcm) >>
2024-07-15 20:10:10:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8636  Non0_acc_2: 0.8981  Non0_F1_score: 0.8974  Mult_acc_5: 0.5546  Mult_acc_7: 0.4367  MAE: 0.6114  Corr: 0.8746 
2024-07-15 20:10:56:INFO:TRAIN-(cmcm) (4/22/3)>> loss: 0.4648
2024-07-15 20:11:09:INFO:VAL-(cmcm) >>
2024-07-15 20:11:09:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8591  Non0_acc_2: 0.8935  Non0_F1_score: 0.8926  Mult_acc_5: 0.5677  Mult_acc_7: 0.4454  MAE: 0.5870  Corr: 0.8839 
2024-07-15 20:11:55:INFO:TRAIN-(cmcm) (5/23/3)>> loss: 0.4640
2024-07-15 20:12:09:INFO:VAL-(cmcm) >>
2024-07-15 20:12:09:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8513  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5546  Mult_acc_7: 0.4454  MAE: 0.5961  Corr: 0.8799 
2024-07-15 20:12:54:INFO:TRAIN-(cmcm) (6/24/3)>> loss: 0.4584
2024-07-15 20:13:07:INFO:VAL-(cmcm) >>
2024-07-15 20:13:07:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.5721  Mult_acc_7: 0.4629  MAE: 0.5944  Corr: 0.8799 
2024-07-15 20:13:53:INFO:TRAIN-(cmcm) (7/25/3)>> loss: 0.4562
2024-07-15 20:14:06:INFO:VAL-(cmcm) >>
2024-07-15 20:14:06:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8552  Non0_acc_2: 0.8981  Non0_F1_score: 0.8976  Mult_acc_5: 0.5546  Mult_acc_7: 0.4410  MAE: 0.5996  Corr: 0.8802 
2024-07-15 20:14:53:INFO:TRAIN-(cmcm) (8/26/3)>> loss: 0.4535
2024-07-15 20:15:06:INFO:VAL-(cmcm) >>
2024-07-15 20:15:06:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5677  Mult_acc_7: 0.4541  MAE: 0.5944  Corr: 0.8818 
2024-07-15 20:15:52:INFO:TRAIN-(cmcm) (9/27/3)>> loss: 0.4510
2024-07-15 20:16:05:INFO:VAL-(cmcm) >>
2024-07-15 20:16:05:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8981  Non0_F1_score: 0.8976  Mult_acc_5: 0.5633  Mult_acc_7: 0.4498  MAE: 0.5961  Corr: 0.8814 
2024-07-15 20:16:31:INFO:TRAIN-(cmcm) (5/18/5)>> loss: 0.4853
2024-07-15 20:16:51:INFO:TRAIN-(cmcm) (10/28/3)>> loss: 0.4500
2024-07-15 20:17:04:INFO:VAL-(cmcm) >>
2024-07-15 20:17:04:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8981  Non0_F1_score: 0.8976  Mult_acc_5: 0.5633  Mult_acc_7: 0.4498  MAE: 0.5957  Corr: 0.8818 
2024-07-15 20:17:44:INFO:TEST-(cmcm) >>
2024-07-15 20:17:44:INFO:M: >>  Has0_acc_2: 0.8761  Has0_F1_score: 0.8760  Non0_acc_2: 0.8872  Non0_F1_score: 0.8870  Mult_acc_5: 0.5408  Mult_acc_7: 0.4650  MAE: 0.6611  Corr: 0.8338 
2024-07-15 20:17:44:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 20:17:44:INFO:Start running cmcm...
2024-07-15 20:17:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-07-15 20:17:44:INFO:Let's use the GPU 1 !
2024-07-15 20:17:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721045865 HTTP/1.1" 200 280
2024-07-15 20:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:17:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:17:46:INFO:train samples: (1284,)
2024-07-15 20:17:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:17:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721045867 HTTP/1.1" 200 280
2024-07-15 20:17:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:17:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:17:48:INFO:valid samples: (229,)
2024-07-15 20:17:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721045868 HTTP/1.1" 200 280
2024-07-15 20:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:17:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:17:49:INFO:test samples: (686,)
2024-07-15 20:17:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:17:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721045870 HTTP/1.1" 200 280
2024-07-15 20:17:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:17:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:17:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:17:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721045878 HTTP/1.1" 200 280
2024-07-15 20:17:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:17:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:18:00:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 20:18:00:INFO:Init labels...
2024-07-15 20:18:00:INFO:Start training...
2024-07-15 20:18:17:INFO:VAL-(cmcm) >>
2024-07-15 20:18:17:INFO:M: >>  Has0_acc_2: 0.8701  Has0_F1_score: 0.8691  Non0_acc_2: 0.7990  Non0_F1_score: 0.8035  Mult_acc_5: 0.5644  Mult_acc_7: 0.5473  MAE: 0.4948  Corr: 0.7746 
2024-07-15 20:18:44:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.5152
2024-07-15 20:18:58:INFO:VAL-(cmcm) >>
2024-07-15 20:18:58:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8433  Non0_acc_2: 0.8704  Non0_F1_score: 0.8710  Mult_acc_5: 0.5502  Mult_acc_7: 0.3362  MAE: 1.0167  Corr: 0.8138 
2024-07-15 20:19:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:19:50:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.8710
2024-07-15 20:20:03:INFO:VAL-(cmcm) >>
2024-07-15 20:20:03:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8318  Non0_acc_2: 0.8565  Non0_F1_score: 0.8550  Mult_acc_5: 0.5153  Mult_acc_7: 0.3100  MAE: 0.8455  Corr: 0.8193 
2024-07-15 20:20:09:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:20:57:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.6025
2024-07-15 20:21:10:INFO:VAL-(cmcm) >>
2024-07-15 20:21:10:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8439  Non0_acc_2: 0.8750  Non0_F1_score: 0.8751  Mult_acc_5: 0.5502  Mult_acc_7: 0.4367  MAE: 0.6721  Corr: 0.8383 
2024-07-15 20:21:16:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:22:03:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5649
2024-07-15 20:22:16:INFO:VAL-(cmcm) >>
2024-07-15 20:22:16:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8460  Non0_acc_2: 0.8611  Non0_F1_score: 0.8595  Mult_acc_5: 0.5415  Mult_acc_7: 0.4454  MAE: 0.7167  Corr: 0.8463 
2024-07-15 20:23:01:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.5511
2024-07-15 20:23:15:INFO:VAL-(cmcm) >>
2024-07-15 20:23:15:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8509  Non0_acc_2: 0.8657  Non0_F1_score: 0.8646  Mult_acc_5: 0.5284  Mult_acc_7: 0.4017  MAE: 0.7267  Corr: 0.8440 
2024-07-15 20:23:37:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.2483
2024-07-15 20:24:00:INFO:TRAIN-(cmcm) (3/6/4)>> loss: 0.5518
2024-07-15 20:24:14:INFO:VAL-(cmcm) >>
2024-07-15 20:24:14:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8796  Non0_F1_score: 0.8794  Mult_acc_5: 0.5284  Mult_acc_7: 0.4236  MAE: 0.6909  Corr: 0.8442 
2024-07-15 20:24:59:INFO:TRAIN-(cmcm) (4/7/4)>> loss: 0.5430
2024-07-15 20:25:12:INFO:VAL-(cmcm) >>
2024-07-15 20:25:12:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8545  Non0_acc_2: 0.8704  Non0_F1_score: 0.8685  Mult_acc_5: 0.5109  Mult_acc_7: 0.4017  MAE: 0.6935  Corr: 0.8508 
2024-07-15 20:25:58:INFO:TRAIN-(cmcm) (5/8/4)>> loss: 0.5366
2024-07-15 20:26:11:INFO:VAL-(cmcm) >>
2024-07-15 20:26:11:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5109  Mult_acc_7: 0.3974  MAE: 0.6813  Corr: 0.8504 
2024-07-15 20:26:55:INFO:TRAIN-(cmcm) (6/9/4)>> loss: 0.5355
2024-07-15 20:27:09:INFO:VAL-(cmcm) >>
2024-07-15 20:27:09:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8796  Non0_F1_score: 0.8792  Mult_acc_5: 0.5284  Mult_acc_7: 0.3799  MAE: 0.7459  Corr: 0.8584 
2024-07-15 20:27:24:INFO:VAL-(cmcm) >>
2024-07-15 20:27:24:INFO:M: >>  acc: 0.7534  weight_F1: 0.7541 
2024-07-15 20:27:54:INFO:TRAIN-(cmcm) (7/10/4)>> loss: 0.5282
2024-07-15 20:28:07:INFO:VAL-(cmcm) >>
2024-07-15 20:28:07:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8843  Non0_F1_score: 0.8833  Mult_acc_5: 0.5153  Mult_acc_7: 0.4061  MAE: 0.6752  Corr: 0.8587 
2024-07-15 20:28:30:INFO:TRAIN-(cmcm) (6/19/5)>> loss: 0.4840
2024-07-15 20:28:54:INFO:TRAIN-(cmcm) (8/11/4)>> loss: 0.5242
2024-07-15 20:29:07:INFO:VAL-(cmcm) >>
2024-07-15 20:29:07:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8478  Non0_acc_2: 0.8750  Non0_F1_score: 0.8747  Mult_acc_5: 0.5415  Mult_acc_7: 0.4541  MAE: 0.6765  Corr: 0.8546 
2024-07-15 20:29:54:INFO:TRAIN-(cmcm) (9/12/4)>> loss: 0.5230
2024-07-15 20:30:07:INFO:VAL-(cmcm) >>
2024-07-15 20:30:07:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8587  Non0_acc_2: 0.8657  Non0_F1_score: 0.8640  Mult_acc_5: 0.5240  Mult_acc_7: 0.4148  MAE: 0.6878  Corr: 0.8639 
2024-07-15 20:30:16:INFO:VAL-(cmcm) >>
2024-07-15 20:30:16:INFO:M: >>  Has0_acc_2: 0.8760  Has0_F1_score: 0.8743  Non0_acc_2: 0.8053  Non0_F1_score: 0.8096  Mult_acc_5: 0.5772  Mult_acc_7: 0.5607  MAE: 0.4847  Corr: 0.7720 
2024-07-15 20:30:53:INFO:TRAIN-(cmcm) (10/13/4)>> loss: 0.5201
2024-07-15 20:31:07:INFO:VAL-(cmcm) >>
2024-07-15 20:31:07:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8843  Non0_F1_score: 0.8838  Mult_acc_5: 0.5328  Mult_acc_7: 0.4148  MAE: 0.6874  Corr: 0.8685 
2024-07-15 20:31:47:INFO:TEST-(cmcm) >>
2024-07-15 20:31:47:INFO:M: >>  Has0_acc_2: 0.8601  Has0_F1_score: 0.8593  Non0_acc_2: 0.8796  Non0_F1_score: 0.8791  Mult_acc_5: 0.5073  Mult_acc_7: 0.4125  MAE: 0.7064  Corr: 0.8190 
2024-07-15 20:31:47:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 20:31:47:INFO:Start running cmcm...
2024-07-15 20:31:47:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-07-15 20:31:47:INFO:Let's use the GPU 1 !
2024-07-15 20:31:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:31:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721046708 HTTP/1.1" 200 280
2024-07-15 20:31:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:31:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:31:49:INFO:train samples: (1284,)
2024-07-15 20:31:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:31:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721046709 HTTP/1.1" 200 280
2024-07-15 20:31:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:31:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:31:50:INFO:valid samples: (229,)
2024-07-15 20:31:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:31:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721046711 HTTP/1.1" 200 280
2024-07-15 20:31:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:31:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:31:51:INFO:test samples: (686,)
2024-07-15 20:31:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:31:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721046712 HTTP/1.1" 200 280
2024-07-15 20:31:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:31:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:31:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:31:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721046720 HTTP/1.1" 200 280
2024-07-15 20:31:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:32:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:32:02:INFO:trainable params: 2612108 || all params: 6246196108 || trainable%: 0.04181918010314255
2024-07-15 20:32:02:INFO:Init labels...
2024-07-15 20:32:02:INFO:Start training...
2024-07-15 20:32:46:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.5427
2024-07-15 20:32:59:INFO:VAL-(cmcm) >>
2024-07-15 20:32:59:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8353  Non0_acc_2: 0.8565  Non0_F1_score: 0.8573  Mult_acc_5: 0.5153  Mult_acc_7: 0.3013  MAE: 1.1529  Corr: 0.7788 
2024-07-15 20:33:05:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:33:52:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1249
2024-07-15 20:34:05:INFO:VAL-(cmcm) >>
2024-07-15 20:34:05:INFO:M: >>  Has0_acc_2: 0.8122  Has0_F1_score: 0.8136  Non0_acc_2: 0.8519  Non0_F1_score: 0.8526  Mult_acc_5: 0.5808  Mult_acc_7: 0.4148  MAE: 0.8459  Corr: 0.8086 
2024-07-15 20:34:11:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:34:57:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.6787
2024-07-15 20:35:10:INFO:VAL-(cmcm) >>
2024-07-15 20:35:10:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8386  Non0_acc_2: 0.8611  Non0_F1_score: 0.8604  Mult_acc_5: 0.5066  Mult_acc_7: 0.3144  MAE: 0.8861  Corr: 0.8243 
2024-07-15 20:35:56:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.6050
2024-07-15 20:36:09:INFO:VAL-(cmcm) >>
2024-07-15 20:36:09:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8485  Non0_acc_2: 0.8796  Non0_F1_score: 0.8800  Mult_acc_5: 0.5153  Mult_acc_7: 0.3755  MAE: 0.8049  Corr: 0.8121 
2024-07-15 20:36:15:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:37:02:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5758
2024-07-15 20:37:15:INFO:VAL-(cmcm) >>
2024-07-15 20:37:15:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8560  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5240  Mult_acc_7: 0.4061  MAE: 0.7267  Corr: 0.8367 
2024-07-15 20:37:21:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:38:09:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.5629
2024-07-15 20:38:22:INFO:VAL-(cmcm) >>
2024-07-15 20:38:22:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8393  Non0_acc_2: 0.8704  Non0_F1_score: 0.8702  Mult_acc_5: 0.5371  Mult_acc_7: 0.4148  MAE: 0.7184  Corr: 0.8359 
2024-07-15 20:38:28:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:39:14:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.5504
2024-07-15 20:39:27:INFO:VAL-(cmcm) >>
2024-07-15 20:39:27:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8425  Non0_acc_2: 0.8611  Non0_F1_score: 0.8601  Mult_acc_5: 0.5328  Mult_acc_7: 0.3974  MAE: 0.7250  Corr: 0.8428 
2024-07-15 20:40:12:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.5434
2024-07-15 20:40:24:INFO:TRAIN-(cmcm) (7/20/5)>> loss: 0.4831
2024-07-15 20:40:25:INFO:VAL-(cmcm) >>
2024-07-15 20:40:25:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8464  Non0_acc_2: 0.8704  Non0_F1_score: 0.8692  Mult_acc_5: 0.5328  Mult_acc_7: 0.3886  MAE: 0.7302  Corr: 0.8502 
2024-07-15 20:41:09:INFO:TRAIN-(cmcm) (3/9/5)>> loss: 0.5351
2024-07-15 20:41:23:INFO:VAL-(cmcm) >>
2024-07-15 20:41:23:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8503  Non0_acc_2: 0.8704  Non0_F1_score: 0.8688  Mult_acc_5: 0.5459  Mult_acc_7: 0.4192  MAE: 0.7009  Corr: 0.8485 
2024-07-15 20:41:28:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:41:42:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.2439
2024-07-15 20:42:08:INFO:VAL-(cmcm) >>
2024-07-15 20:42:08:INFO:M: >>  Has0_acc_2: 0.8771  Has0_F1_score: 0.8738  Non0_acc_2: 0.8178  Non0_F1_score: 0.8215  Mult_acc_5: 0.5772  Mult_acc_7: 0.5580  MAE: 0.4936  Corr: 0.7778 
2024-07-15 20:42:13:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.5316
2024-07-15 20:42:27:INFO:VAL-(cmcm) >>
2024-07-15 20:42:27:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8548  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.5546  Mult_acc_7: 0.4192  MAE: 0.6852  Corr: 0.8614 
2024-07-15 20:42:33:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:43:22:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.5279
2024-07-15 20:43:36:INFO:VAL-(cmcm) >>
2024-07-15 20:43:36:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8560  Non0_acc_2: 0.8750  Non0_F1_score: 0.8745  Mult_acc_5: 0.5939  Mult_acc_7: 0.4891  MAE: 0.6298  Corr: 0.8684 
2024-07-15 20:43:41:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:44:28:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.5240
2024-07-15 20:44:42:INFO:VAL-(cmcm) >>
2024-07-15 20:44:42:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8513  Non0_acc_2: 0.8704  Non0_F1_score: 0.8694  Mult_acc_5: 0.5808  Mult_acc_7: 0.4716  MAE: 0.6573  Corr: 0.8510 
2024-07-15 20:45:26:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.5198
2024-07-15 20:45:28:INFO:VAL-(cmcm) >>
2024-07-15 20:45:28:INFO:M: >>  acc: 0.7569  weight_F1: 0.7556 
2024-07-15 20:45:40:INFO:VAL-(cmcm) >>
2024-07-15 20:45:40:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8473  Non0_acc_2: 0.8704  Non0_F1_score: 0.8697  Mult_acc_5: 0.5546  Mult_acc_7: 0.4367  MAE: 0.7066  Corr: 0.8363 
2024-07-15 20:46:25:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.5178
2024-07-15 20:46:39:INFO:VAL-(cmcm) >>
2024-07-15 20:46:39:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8509  Non0_acc_2: 0.8704  Non0_F1_score: 0.8692  Mult_acc_5: 0.5895  Mult_acc_7: 0.4891  MAE: 0.6477  Corr: 0.8596 
2024-07-15 20:47:24:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.5128
2024-07-15 20:47:38:INFO:VAL-(cmcm) >>
2024-07-15 20:47:38:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.5895  Mult_acc_7: 0.4803  MAE: 0.6057  Corr: 0.8742 
2024-07-15 20:47:44:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-07-15 20:48:30:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.5099
2024-07-15 20:48:43:INFO:VAL-(cmcm) >>
2024-07-15 20:48:43:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8555  Non0_acc_2: 0.8750  Non0_F1_score: 0.8740  Mult_acc_5: 0.5546  Mult_acc_7: 0.4410  MAE: 0.6756  Corr: 0.8521 
2024-07-15 20:49:27:INFO:TRAIN-(cmcm) (2/17/5)>> loss: 0.5071
2024-07-15 20:49:40:INFO:VAL-(cmcm) >>
2024-07-15 20:49:40:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8473  Non0_acc_2: 0.8704  Non0_F1_score: 0.8697  Mult_acc_5: 0.5852  Mult_acc_7: 0.4803  MAE: 0.6499  Corr: 0.8567 
2024-07-15 20:50:26:INFO:TRAIN-(cmcm) (3/18/5)>> loss: 0.5048
2024-07-15 20:50:39:INFO:VAL-(cmcm) >>
2024-07-15 20:50:39:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8509  Non0_acc_2: 0.8704  Non0_F1_score: 0.8692  Mult_acc_5: 0.5939  Mult_acc_7: 0.4760  MAE: 0.6713  Corr: 0.8544 
2024-07-15 20:51:24:INFO:TRAIN-(cmcm) (4/19/5)>> loss: 0.5022
2024-07-15 20:51:38:INFO:VAL-(cmcm) >>
2024-07-15 20:51:38:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.6026  Mult_acc_7: 0.4891  MAE: 0.6538  Corr: 0.8556 
2024-07-15 20:52:13:INFO:TRAIN-(cmcm) (8/21/5)>> loss: 0.4815
2024-07-15 20:52:23:INFO:TRAIN-(cmcm) (5/20/5)>> loss: 0.4995
2024-07-15 20:52:36:INFO:VAL-(cmcm) >>
2024-07-15 20:52:36:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8470  Non0_acc_2: 0.8657  Non0_F1_score: 0.8649  Mult_acc_5: 0.5721  Mult_acc_7: 0.4541  MAE: 0.6909  Corr: 0.8396 
2024-07-15 20:53:23:INFO:TRAIN-(cmcm) (6/21/5)>> loss: 0.4961
2024-07-15 20:53:37:INFO:VAL-(cmcm) >>
2024-07-15 20:53:37:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8555  Non0_acc_2: 0.8750  Non0_F1_score: 0.8740  Mult_acc_5: 0.6245  Mult_acc_7: 0.5022  MAE: 0.6193  Corr: 0.8641 
2024-07-15 20:53:58:INFO:VAL-(cmcm) >>
2024-07-15 20:53:58:INFO:M: >>  Has0_acc_2: 0.8787  Has0_F1_score: 0.8762  Non0_acc_2: 0.8088  Non0_F1_score: 0.8130  Mult_acc_5: 0.5783  Mult_acc_7: 0.5617  MAE: 0.4845  Corr: 0.7737 
2024-07-15 20:54:23:INFO:TRAIN-(cmcm) (7/22/5)>> loss: 0.4953
2024-07-15 20:54:36:INFO:VAL-(cmcm) >>
2024-07-15 20:54:36:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8552  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.6070  Mult_acc_7: 0.4978  MAE: 0.6451  Corr: 0.8573 
2024-07-15 20:55:24:INFO:TRAIN-(cmcm) (8/23/5)>> loss: 0.4928
2024-07-15 20:55:37:INFO:VAL-(cmcm) >>
2024-07-15 20:55:37:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.6070  Mult_acc_7: 0.4978  MAE: 0.6512  Corr: 0.8569 
2024-07-15 20:56:22:INFO:TRAIN-(cmcm) (9/24/5)>> loss: 0.4903
2024-07-15 20:56:36:INFO:VAL-(cmcm) >>
2024-07-15 20:56:36:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8467  Non0_acc_2: 0.8657  Non0_F1_score: 0.8646  Mult_acc_5: 0.6026  Mult_acc_7: 0.4803  MAE: 0.6485  Corr: 0.8480 
2024-07-15 20:57:21:INFO:TRAIN-(cmcm) (10/25/5)>> loss: 0.4891
2024-07-15 20:57:35:INFO:VAL-(cmcm) >>
2024-07-15 20:57:35:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.6157  Mult_acc_7: 0.5022  MAE: 0.6407  Corr: 0.8602 
2024-07-15 20:58:15:INFO:TEST-(cmcm) >>
2024-07-15 20:58:15:INFO:M: >>  Has0_acc_2: 0.8586  Has0_F1_score: 0.8586  Non0_acc_2: 0.8735  Non0_F1_score: 0.8739  Mult_acc_5: 0.5029  Mult_acc_7: 0.4169  MAE: 0.7130  Corr: 0.8148 
2024-07-15 20:58:15:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 20:59:23:INFO:Start running cmcm...
2024-07-15 20:59:23:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-15 20:59:23:INFO:Find gpu: 3, with memory: 378273792 left!
2024-07-15 20:59:23:INFO:Let's use the GPU 1 !
2024-07-15 20:59:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:59:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721048364 HTTP/1.1" 200 280
2024-07-15 20:59:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:59:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:59:25:INFO:train samples: (1284,)
2024-07-15 20:59:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:59:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721048366 HTTP/1.1" 200 280
2024-07-15 20:59:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:59:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:59:26:INFO:valid samples: (229,)
2024-07-15 20:59:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:59:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721048367 HTTP/1.1" 200 280
2024-07-15 20:59:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:59:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:59:27:INFO:test samples: (686,)
2024-07-15 20:59:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:59:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721048368 HTTP/1.1" 200 280
2024-07-15 20:59:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:59:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:59:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 20:59:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721048377 HTTP/1.1" 200 280
2024-07-15 20:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 20:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 20:59:40:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-15 20:59:40:INFO:Init labels...
2024-07-15 20:59:40:INFO:Start training...
2024-07-15 20:59:42:INFO:TRAIN-(cmcm) (5/18/1)>> loss: 0.2384
2024-07-15 21:00:25:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.2160
2024-07-15 21:00:39:INFO:VAL-(cmcm) >>
2024-07-15 21:00:39:INFO:M: >>  Has0_acc_2: 0.8253  Has0_F1_score: 0.8270  Non0_acc_2: 0.8657  Non0_F1_score: 0.8665  Mult_acc_5: 0.5459  Mult_acc_7: 0.4105  MAE: 0.8197  Corr: 0.8024 
2024-07-15 21:00:46:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:01:34:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6895
2024-07-15 21:01:48:INFO:VAL-(cmcm) >>
2024-07-15 21:01:48:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8386  Non0_acc_2: 0.8565  Non0_F1_score: 0.8571  Mult_acc_5: 0.5459  Mult_acc_7: 0.4105  MAE: 0.7900  Corr: 0.8113 
2024-07-15 21:01:55:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:02:41:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.6205
2024-07-15 21:02:55:INFO:VAL-(cmcm) >>
2024-07-15 21:02:55:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8558  Non0_acc_2: 0.8657  Non0_F1_score: 0.8656  Mult_acc_5: 0.5808  Mult_acc_7: 0.3930  MAE: 0.8023  Corr: 0.8335 
2024-07-15 21:03:30:INFO:VAL-(cmcm) >>
2024-07-15 21:03:30:INFO:M: >>  acc: 0.7522  weight_F1: 0.7512 
2024-07-15 21:03:41:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.6046
2024-07-15 21:03:46:INFO:TRAIN-(cmcm) (9/22/5)>> loss: 0.4803
2024-07-15 21:03:55:INFO:VAL-(cmcm) >>
2024-07-15 21:03:55:INFO:M: >>  Has0_acc_2: 0.8253  Has0_F1_score: 0.8269  Non0_acc_2: 0.8796  Non0_F1_score: 0.8803  Mult_acc_5: 0.5502  Mult_acc_7: 0.3712  MAE: 0.7922  Corr: 0.8293 
2024-07-15 21:04:39:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 0.5917
2024-07-15 21:04:52:INFO:VAL-(cmcm) >>
2024-07-15 21:04:52:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5240  Mult_acc_7: 0.3362  MAE: 0.8446  Corr: 0.8414 
2024-07-15 21:05:30:INFO:VAL-(cmcm) >>
2024-07-15 21:05:30:INFO:M: >>  Has0_acc_2: 0.8781  Has0_F1_score: 0.8752  Non0_acc_2: 0.7747  Non0_F1_score: 0.7797  Mult_acc_5: 0.5826  Mult_acc_7: 0.5655  MAE: 0.4903  Corr: 0.7678 
2024-07-15 21:05:38:INFO:TRAIN-(cmcm) (4/6/1)>> loss: 0.5807
2024-07-15 21:05:51:INFO:VAL-(cmcm) >>
2024-07-15 21:05:51:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8357  Non0_acc_2: 0.8796  Non0_F1_score: 0.8802  Mult_acc_5: 0.5852  Mult_acc_7: 0.4672  MAE: 0.6813  Corr: 0.8399 
2024-07-15 21:05:58:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:06:46:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5743
2024-07-15 21:06:59:INFO:VAL-(cmcm) >>
2024-07-15 21:06:59:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8569  Non0_acc_2: 0.8981  Non0_F1_score: 0.8983  Mult_acc_5: 0.5677  Mult_acc_7: 0.4498  MAE: 0.7354  Corr: 0.8411 
2024-07-15 21:07:44:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.5626
2024-07-15 21:07:57:INFO:VAL-(cmcm) >>
2024-07-15 21:07:57:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8470  Non0_acc_2: 0.8796  Non0_F1_score: 0.8799  Mult_acc_5: 0.5721  Mult_acc_7: 0.4498  MAE: 0.7066  Corr: 0.8451 
2024-07-15 21:08:41:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.5651
2024-07-15 21:08:55:INFO:VAL-(cmcm) >>
2024-07-15 21:08:55:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8513  Non0_acc_2: 0.8704  Non0_F1_score: 0.8702  Mult_acc_5: 0.5633  Mult_acc_7: 0.4585  MAE: 0.7088  Corr: 0.8352 
2024-07-15 21:09:40:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.5541
2024-07-15 21:09:54:INFO:VAL-(cmcm) >>
2024-07-15 21:09:54:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8513  Non0_acc_2: 0.8657  Non0_F1_score: 0.8654  Mult_acc_5: 0.5590  Mult_acc_7: 0.4541  MAE: 0.6756  Corr: 0.8424 
2024-07-15 21:10:01:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:10:47:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.5495
2024-07-15 21:11:00:INFO:VAL-(cmcm) >>
2024-07-15 21:11:00:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8843  Non0_F1_score: 0.8843  Mult_acc_5: 0.5808  Mult_acc_7: 0.4847  MAE: 0.6791  Corr: 0.8409 
2024-07-15 21:11:44:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 0.5426
2024-07-15 21:11:57:INFO:VAL-(cmcm) >>
2024-07-15 21:11:57:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8625  Non0_acc_2: 0.8750  Non0_F1_score: 0.8734  Mult_acc_5: 0.5939  Mult_acc_7: 0.5022  MAE: 0.6857  Corr: 0.8631 
2024-07-15 21:12:42:INFO:TRAIN-(cmcm) (3/13/1)>> loss: 0.5387
2024-07-15 21:12:55:INFO:VAL-(cmcm) >>
2024-07-15 21:12:55:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8629  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5852  Mult_acc_7: 0.4803  MAE: 0.6586  Corr: 0.8622 
2024-07-15 21:13:02:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:13:48:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.5387
2024-07-15 21:14:01:INFO:VAL-(cmcm) >>
2024-07-15 21:14:01:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8597  Non0_acc_2: 0.8935  Non0_F1_score: 0.8937  Mult_acc_5: 0.5895  Mult_acc_7: 0.4891  MAE: 0.6691  Corr: 0.8473 
2024-07-15 21:14:47:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.5328
2024-07-15 21:15:00:INFO:VAL-(cmcm) >>
2024-07-15 21:15:00:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8605  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5022  Mult_acc_7: 0.4192  MAE: 0.7271  Corr: 0.8419 
2024-07-15 21:15:22:INFO:TRAIN-(cmcm) (10/23/5)>> loss: 0.4794
2024-07-15 21:15:47:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.5274
2024-07-15 21:16:01:INFO:VAL-(cmcm) >>
2024-07-15 21:16:01:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8727  Non0_acc_2: 0.8889  Non0_F1_score: 0.8885  Mult_acc_5: 0.5764  Mult_acc_7: 0.4672  MAE: 0.6302  Corr: 0.8654 
2024-07-15 21:16:08:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:16:54:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.5265
2024-07-15 21:17:06:INFO:VAL-(cmcm) >>
2024-07-15 21:17:06:INFO:M: >>  Has0_acc_2: 0.8749  Has0_F1_score: 0.8730  Non0_acc_2: 0.8032  Non0_F1_score: 0.8076  Mult_acc_5: 0.5815  Mult_acc_7: 0.5623  MAE: 0.4945  Corr: 0.7685 
2024-07-15 21:17:07:INFO:VAL-(cmcm) >>
2024-07-15 21:17:07:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8527  Non0_acc_2: 0.8935  Non0_F1_score: 0.8938  Mult_acc_5: 0.5415  Mult_acc_7: 0.4454  MAE: 0.6957  Corr: 0.8454 
2024-07-15 21:17:43:INFO:TRAIN-(cmcm) (6/19/1)>> loss: 0.2350
2024-07-15 21:17:52:INFO:TRAIN-(cmcm) (2/18/1)>> loss: 0.5240
2024-07-15 21:18:05:INFO:VAL-(cmcm) >>
2024-07-15 21:18:05:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8682  Non0_acc_2: 0.8935  Non0_F1_score: 0.8929  Mult_acc_5: 0.5677  Mult_acc_7: 0.4672  MAE: 0.6586  Corr: 0.8641 
2024-07-15 21:18:51:INFO:TRAIN-(cmcm) (3/19/1)>> loss: 0.5178
2024-07-15 21:19:04:INFO:VAL-(cmcm) >>
2024-07-15 21:19:04:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.8935  Non0_F1_score: 0.8934  Mult_acc_5: 0.5153  Mult_acc_7: 0.4148  MAE: 0.7084  Corr: 0.8510 
2024-07-15 21:19:49:INFO:TRAIN-(cmcm) (4/20/1)>> loss: 0.5178
2024-07-15 21:20:02:INFO:VAL-(cmcm) >>
2024-07-15 21:20:02:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8727  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.6070  Mult_acc_7: 0.5153  MAE: 0.6162  Corr: 0.8720 
2024-07-15 21:20:09:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:20:55:INFO:TRAIN-(cmcm) (1/21/1)>> loss: 0.5132
2024-07-15 21:21:08:INFO:VAL-(cmcm) >>
2024-07-15 21:21:08:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8520  Non0_acc_2: 0.8935  Non0_F1_score: 0.8937  Mult_acc_5: 0.6157  Mult_acc_7: 0.5153  MAE: 0.6420  Corr: 0.8656 
2024-07-15 21:21:27:INFO:TEST-(cmcm) >>
2024-07-15 21:21:27:INFO:M: >>  Has0_acc_2: 0.8699  Has0_F1_score: 0.8689  Non0_acc_2: 0.7639  Non0_F1_score: 0.7670  Mult_acc_5: 0.5639  Mult_acc_7: 0.5456  MAE: 0.5040  Corr: 0.7853 
2024-07-15 21:21:28:INFO:Results are added to results/results/mosei-regression-30.csv...
2024-07-15 21:21:28:INFO:Start running cmcm...
2024-07-15 21:21:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-07-15 21:21:28:INFO:Let's use the GPU 1 !
2024-07-15 21:21:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:21:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721049690 HTTP/1.1" 200 280
2024-07-15 21:21:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:21:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:21:31:INFO:train samples: (2722,)
2024-07-15 21:21:31:INFO:VAL-(cmcm) >>
2024-07-15 21:21:31:INFO:M: >>  acc: 0.7533  weight_F1: 0.7504 
2024-07-15 21:21:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:21:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721049693 HTTP/1.1" 200 280
2024-07-15 21:21:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:21:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:21:34:INFO:valid samples: (647,)
2024-07-15 21:21:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:21:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721049696 HTTP/1.1" 200 280
2024-07-15 21:21:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:21:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:21:37:INFO:test samples: (1034,)
2024-07-15 21:21:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721049697 HTTP/1.1" 200 280
2024-07-15 21:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:21:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:21:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721049705 HTTP/1.1" 200 280
2024-07-15 21:21:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:21:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:21:47:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-15 21:21:47:INFO:Init labels...
2024-07-15 21:21:47:INFO:Start training...
2024-07-15 21:21:53:INFO:TRAIN-(cmcm) (2/22/1)>> loss: 0.5109
2024-07-15 21:22:06:INFO:VAL-(cmcm) >>
2024-07-15 21:22:06:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8889  Non0_F1_score: 0.8885  Mult_acc_5: 0.5546  Mult_acc_7: 0.4541  MAE: 0.7084  Corr: 0.8662 
2024-07-15 21:22:52:INFO:TRAIN-(cmcm) (3/23/1)>> loss: 0.5077
2024-07-15 21:23:05:INFO:VAL-(cmcm) >>
2024-07-15 21:23:05:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8889  Non0_F1_score: 0.8883  Mult_acc_5: 0.5677  Mult_acc_7: 0.4716  MAE: 0.6590  Corr: 0.8618 
2024-07-15 21:23:31:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.0606
2024-07-15 21:23:49:INFO:TRAIN-(cmcm) (4/24/1)>> loss: 0.5053
2024-07-15 21:24:02:INFO:VAL-(cmcm) >>
2024-07-15 21:24:02:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5895  Mult_acc_7: 0.4934  MAE: 0.6485  Corr: 0.8608 
2024-07-15 21:24:08:INFO:VAL-(cmcm) >>
2024-07-15 21:24:08:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7094  Mult_acc_5: 0.4235  F1_score: 0.7741  MAE: 0.4434  Corr: 0.6394  R_squre: 0.0931 
2024-07-15 21:24:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 21:24:46:INFO:TRAIN-(cmcm) (5/25/1)>> loss: 0.5050
2024-07-15 21:25:00:INFO:VAL-(cmcm) >>
2024-07-15 21:25:00:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8889  Non0_F1_score: 0.8889  Mult_acc_5: 0.5983  Mult_acc_7: 0.5022  MAE: 0.6368  Corr: 0.8682 
2024-07-15 21:25:44:INFO:TRAIN-(cmcm) (6/26/1)>> loss: 0.5006
2024-07-15 21:25:58:INFO:VAL-(cmcm) >>
2024-07-15 21:25:58:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5852  Mult_acc_7: 0.4891  MAE: 0.6608  Corr: 0.8647 
2024-07-15 21:25:58:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6628
2024-07-15 21:26:35:INFO:VAL-(cmcm) >>
2024-07-15 21:26:35:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7465  Mult_acc_5: 0.4730  F1_score: 0.8172  MAE: 0.3614  Corr: 0.6818  R_squre: 0.3214 
2024-07-15 21:26:42:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 21:26:43:INFO:TRAIN-(cmcm) (7/27/1)>> loss: 0.4987
2024-07-15 21:26:56:INFO:VAL-(cmcm) >>
2024-07-15 21:26:56:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8563  Non0_acc_2: 0.8796  Non0_F1_score: 0.8796  Mult_acc_5: 0.5633  Mult_acc_7: 0.4672  MAE: 0.6669  Corr: 0.8611 
2024-07-15 21:27:41:INFO:TRAIN-(cmcm) (8/28/1)>> loss: 0.4980
2024-07-15 21:27:54:INFO:VAL-(cmcm) >>
2024-07-15 21:27:54:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8518  Non0_acc_2: 0.8796  Non0_F1_score: 0.8796  Mult_acc_5: 0.5677  Mult_acc_7: 0.4716  MAE: 0.6664  Corr: 0.8602 
2024-07-15 21:28:27:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.6407
2024-07-15 21:28:39:INFO:TRAIN-(cmcm) (9/29/1)>> loss: 0.4959
2024-07-15 21:28:52:INFO:VAL-(cmcm) >>
2024-07-15 21:28:52:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5808  Mult_acc_7: 0.4847  MAE: 0.6573  Corr: 0.8633 
2024-07-15 21:29:03:INFO:VAL-(cmcm) >>
2024-07-15 21:29:03:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7063  Mult_acc_5: 0.4513  F1_score: 0.8142  MAE: 0.3484  Corr: 0.6876  R_squre: 0.3704 
2024-07-15 21:29:09:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 21:29:38:INFO:TRAIN-(cmcm) (10/30/1)>> loss: 0.4952
2024-07-15 21:29:51:INFO:VAL-(cmcm) >>
2024-07-15 21:29:51:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8843  Non0_F1_score: 0.8842  Mult_acc_5: 0.5852  Mult_acc_7: 0.4891  MAE: 0.6564  Corr: 0.8633 
2024-07-15 21:30:31:INFO:TEST-(cmcm) >>
2024-07-15 21:30:31:INFO:M: >>  Has0_acc_2: 0.8732  Has0_F1_score: 0.8732  Non0_acc_2: 0.8872  Non0_F1_score: 0.8872  Mult_acc_5: 0.5321  Mult_acc_7: 0.4636  MAE: 0.6796  Corr: 0.8416 
2024-07-15 21:30:32:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 21:30:32:INFO:Start running cmcm...
2024-07-15 21:30:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-07-15 21:30:32:INFO:Let's use the GPU 1 !
2024-07-15 21:30:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:30:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721050233 HTTP/1.1" 200 280
2024-07-15 21:30:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:30:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:30:34:INFO:train samples: (1284,)
2024-07-15 21:30:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721050235 HTTP/1.1" 200 280
2024-07-15 21:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:30:35:INFO:valid samples: (229,)
2024-07-15 21:30:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:30:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721050236 HTTP/1.1" 200 280
2024-07-15 21:30:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:30:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:30:37:INFO:test samples: (686,)
2024-07-15 21:30:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721050238 HTTP/1.1" 200 280
2024-07-15 21:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:30:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 21:30:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721050247 HTTP/1.1" 200 280
2024-07-15 21:30:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 21:30:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 21:30:49:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-15 21:30:49:INFO:Init labels...
2024-07-15 21:30:49:INFO:Start training...
2024-07-15 21:30:55:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.6241
2024-07-15 21:31:31:INFO:VAL-(cmcm) >>
2024-07-15 21:31:31:INFO:M: >>  Mult_acc_2: 0.7311  Mult_acc_2_weak: 0.6235  Mult_acc_3: 0.5981  Mult_acc_5: 0.3833  F1_score: 0.7345  MAE: 0.4054  Corr: 0.5850  R_squre: 0.1573 
2024-07-15 21:31:33:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.3762
2024-07-15 21:31:46:INFO:VAL-(cmcm) >>
2024-07-15 21:31:47:INFO:M: >>  Has0_acc_2: 0.8079  Has0_F1_score: 0.8004  Non0_acc_2: 0.8519  Non0_F1_score: 0.8501  Mult_acc_5: 0.5284  Mult_acc_7: 0.4323  MAE: 0.7865  Corr: 0.8169 
2024-07-15 21:31:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:32:40:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.7052
2024-07-15 21:32:53:INFO:VAL-(cmcm) >>
2024-07-15 21:32:53:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8750  Non0_F1_score: 0.8754  Mult_acc_5: 0.5590  Mult_acc_7: 0.4498  MAE: 0.7145  Corr: 0.8263 
2024-07-15 21:32:59:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:33:14:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.5504
2024-07-15 21:33:45:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.6645
2024-07-15 21:33:51:INFO:VAL-(cmcm) >>
2024-07-15 21:33:51:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.7295  Mult_acc_5: 0.4714  F1_score: 0.7741  MAE: 0.3771  Corr: 0.6135  R_squre: 0.1828 
2024-07-15 21:33:58:INFO:VAL-(cmcm) >>
2024-07-15 21:33:58:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8843  Non0_F1_score: 0.8848  Mult_acc_5: 0.6201  Mult_acc_7: 0.5197  MAE: 0.6381  Corr: 0.8527 
2024-07-15 21:34:04:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:34:51:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.5872
2024-07-15 21:35:04:INFO:VAL-(cmcm) >>
2024-07-15 21:35:04:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8473  Non0_acc_2: 0.8935  Non0_F1_score: 0.8938  Mult_acc_5: 0.5546  Mult_acc_7: 0.4367  MAE: 0.7193  Corr: 0.8423 
2024-07-15 21:35:34:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.5056
2024-07-15 21:35:48:INFO:TRAIN-(cmcm) (7/20/1)>> loss: 0.2299
2024-07-15 21:35:50:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.5636
2024-07-15 21:36:03:INFO:VAL-(cmcm) >>
2024-07-15 21:36:03:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8484  Non0_acc_2: 0.8843  Non0_F1_score: 0.8849  Mult_acc_5: 0.5590  Mult_acc_7: 0.4629  MAE: 0.6411  Corr: 0.8565 
2024-07-15 21:36:10:INFO:VAL-(cmcm) >>
2024-07-15 21:36:10:INFO:M: >>  Mult_acc_2: 0.7434  Mult_acc_2_weak: 0.6078  Mult_acc_3: 0.7156  Mult_acc_5: 0.4235  F1_score: 0.7452  MAE: 0.4039  Corr: 0.6203  R_squre: 0.0881 
2024-07-15 21:36:47:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.5527
2024-07-15 21:37:00:INFO:VAL-(cmcm) >>
2024-07-15 21:37:00:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8475  Non0_acc_2: 0.8704  Non0_F1_score: 0.8704  Mult_acc_5: 0.5590  Mult_acc_7: 0.4541  MAE: 0.6512  Corr: 0.8583 
2024-07-15 21:37:45:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.5455
2024-07-15 21:37:52:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.4958
2024-07-15 21:37:58:INFO:VAL-(cmcm) >>
2024-07-15 21:37:58:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8563  Non0_acc_2: 0.8889  Non0_F1_score: 0.8892  Mult_acc_5: 0.5808  Mult_acc_7: 0.4716  MAE: 0.6407  Corr: 0.8601 
2024-07-15 21:38:29:INFO:VAL-(cmcm) >>
2024-07-15 21:38:29:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7434  Mult_acc_5: 0.4791  F1_score: 0.7894  MAE: 0.3637  Corr: 0.6258  R_squre: 0.2344 
2024-07-15 21:38:43:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.5417
2024-07-15 21:38:57:INFO:VAL-(cmcm) >>
2024-07-15 21:38:57:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8467  Non0_acc_2: 0.8750  Non0_F1_score: 0.8745  Mult_acc_5: 0.5939  Mult_acc_7: 0.4934  MAE: 0.6127  Corr: 0.8596 
2024-07-15 21:39:02:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:39:34:INFO:VAL-(cmcm) >>
2024-07-15 21:39:34:INFO:M: >>  acc: 0.7569  weight_F1: 0.7549 
2024-07-15 21:39:50:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.5351
2024-07-15 21:40:03:INFO:VAL-(cmcm) >>
2024-07-15 21:40:03:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8548  Non0_acc_2: 0.8750  Non0_F1_score: 0.8745  Mult_acc_5: 0.5677  Mult_acc_7: 0.4760  MAE: 0.6162  Corr: 0.8636 
2024-07-15 21:40:13:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.4905
2024-07-15 21:40:48:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.5324
2024-07-15 21:40:49:INFO:VAL-(cmcm) >>
2024-07-15 21:40:49:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7558  Mult_acc_5: 0.4930  F1_score: 0.8034  MAE: 0.3509  Corr: 0.6409  R_squre: 0.2897 
2024-07-15 21:41:02:INFO:VAL-(cmcm) >>
2024-07-15 21:41:02:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8525  Non0_acc_2: 0.8796  Non0_F1_score: 0.8798  Mult_acc_5: 0.5459  Mult_acc_7: 0.4410  MAE: 0.6568  Corr: 0.8478 
2024-07-15 21:41:48:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.5255
2024-07-15 21:42:01:INFO:VAL-(cmcm) >>
2024-07-15 21:42:01:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8692  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5895  Mult_acc_7: 0.4803  MAE: 0.6084  Corr: 0.8700 
2024-07-15 21:42:07:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:42:30:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 0.4794
2024-07-15 21:42:55:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.5223
2024-07-15 21:43:06:INFO:VAL-(cmcm) >>
2024-07-15 21:43:06:INFO:M: >>  Mult_acc_2: 0.7202  Mult_acc_2_weak: 0.5725  Mult_acc_3: 0.6986  Mult_acc_5: 0.4513  F1_score: 0.7208  MAE: 0.4096  Corr: 0.5937  R_squre: 0.0833 
2024-07-15 21:43:09:INFO:VAL-(cmcm) >>
2024-07-15 21:43:09:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8843  Non0_F1_score: 0.8840  Mult_acc_5: 0.6114  Mult_acc_7: 0.5066  MAE: 0.6092  Corr: 0.8703 
2024-07-15 21:43:54:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.5191
2024-07-15 21:44:07:INFO:VAL-(cmcm) >>
2024-07-15 21:44:07:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8650  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5983  Mult_acc_7: 0.5109  MAE: 0.6027  Corr: 0.8652 
2024-07-15 21:44:13:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:44:49:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 0.4773
2024-07-15 21:45:00:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.5162
2024-07-15 21:45:14:INFO:VAL-(cmcm) >>
2024-07-15 21:45:14:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8779  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5983  Mult_acc_7: 0.4891  MAE: 0.6057  Corr: 0.8746 
2024-07-15 21:45:25:INFO:VAL-(cmcm) >>
2024-07-15 21:45:25:INFO:M: >>  Mult_acc_2: 0.7635  Mult_acc_2_weak: 0.6314  Mult_acc_3: 0.7372  Mult_acc_5: 0.4822  F1_score: 0.7660  MAE: 0.3781  Corr: 0.6342  R_squre: 0.1862 
2024-07-15 21:46:00:INFO:TRAIN-(cmcm) (2/15/2)>> loss: 0.5136
2024-07-15 21:46:13:INFO:VAL-(cmcm) >>
2024-07-15 21:46:13:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5852  Mult_acc_7: 0.4847  MAE: 0.6237  Corr: 0.8686 
2024-07-15 21:47:00:INFO:TRAIN-(cmcm) (3/16/2)>> loss: 0.5155
2024-07-15 21:47:11:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 0.4752
2024-07-15 21:47:13:INFO:VAL-(cmcm) >>
2024-07-15 21:47:13:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.8889  Non0_F1_score: 0.8890  Mult_acc_5: 0.6419  Mult_acc_7: 0.5415  MAE: 0.5966  Corr: 0.8630 
2024-07-15 21:47:19:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:47:47:INFO:VAL-(cmcm) >>
2024-07-15 21:47:47:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7481  Mult_acc_5: 0.4374  F1_score: 0.7847  MAE: 0.3781  Corr: 0.6530  R_squre: 0.1960 
2024-07-15 21:48:08:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.5103
2024-07-15 21:48:22:INFO:VAL-(cmcm) >>
2024-07-15 21:48:22:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.8889  Non0_F1_score: 0.8892  Mult_acc_5: 0.5983  Mult_acc_7: 0.4891  MAE: 0.5996  Corr: 0.8659 
2024-07-15 21:49:06:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.5054
2024-07-15 21:49:19:INFO:VAL-(cmcm) >>
2024-07-15 21:49:19:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.6288  Mult_acc_7: 0.5328  MAE: 0.6088  Corr: 0.8650 
2024-07-15 21:49:28:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 0.4711
2024-07-15 21:50:05:INFO:TRAIN-(cmcm) (3/19/2)>> loss: 0.5026
2024-07-15 21:50:05:INFO:VAL-(cmcm) >>
2024-07-15 21:50:05:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7543  Mult_acc_5: 0.5023  F1_score: 0.8103  MAE: 0.3419  Corr: 0.6748  R_squre: 0.3304 
2024-07-15 21:50:12:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 21:50:18:INFO:VAL-(cmcm) >>
2024-07-15 21:50:18:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8721  Non0_acc_2: 0.9120  Non0_F1_score: 0.9121  Mult_acc_5: 0.6463  Mult_acc_7: 0.5371  MAE: 0.5586  Corr: 0.8861 
2024-07-15 21:50:24:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:51:12:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.4997
2024-07-15 21:51:25:INFO:VAL-(cmcm) >>
2024-07-15 21:51:25:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.6376  Mult_acc_7: 0.5371  MAE: 0.5616  Corr: 0.8818 
2024-07-15 21:51:58:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.4665
2024-07-15 21:52:13:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.4961
2024-07-15 21:52:26:INFO:VAL-(cmcm) >>
2024-07-15 21:52:26:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8600  Non0_acc_2: 0.8889  Non0_F1_score: 0.8885  Mult_acc_5: 0.6856  Mult_acc_7: 0.5808  MAE: 0.5782  Corr: 0.8787 
2024-07-15 21:52:35:INFO:VAL-(cmcm) >>
2024-07-15 21:52:35:INFO:M: >>  Mult_acc_2: 0.7666  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.7295  Mult_acc_5: 0.4776  F1_score: 0.7693  MAE: 0.3768  Corr: 0.6373  R_squre: 0.1899 
2024-07-15 21:53:11:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.4928
2024-07-15 21:53:24:INFO:VAL-(cmcm) >>
2024-07-15 21:53:24:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8650  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.6463  Mult_acc_7: 0.5459  MAE: 0.5573  Corr: 0.8831 
2024-07-15 21:53:30:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:53:47:INFO:TRAIN-(cmcm) (8/21/1)>> loss: 0.2257
2024-07-15 21:54:15:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.4614
2024-07-15 21:54:17:INFO:TRAIN-(cmcm) (1/23/2)>> loss: 0.4899
2024-07-15 21:54:30:INFO:VAL-(cmcm) >>
2024-07-15 21:54:30:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8636  Non0_acc_2: 0.8889  Non0_F1_score: 0.8881  Mult_acc_5: 0.6245  Mult_acc_7: 0.5240  MAE: 0.5804  Corr: 0.8742 
2024-07-15 21:54:52:INFO:VAL-(cmcm) >>
2024-07-15 21:54:52:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7558  Mult_acc_5: 0.5008  F1_score: 0.8351  MAE: 0.3107  Corr: 0.6936  R_squre: 0.4208 
2024-07-15 21:54:58:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 21:55:16:INFO:TRAIN-(cmcm) (2/24/2)>> loss: 0.4859
2024-07-15 21:55:29:INFO:VAL-(cmcm) >>
2024-07-15 21:55:29:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.6419  Mult_acc_7: 0.5415  MAE: 0.5616  Corr: 0.8832 
2024-07-15 21:56:16:INFO:TRAIN-(cmcm) (3/25/2)>> loss: 0.4846
2024-07-15 21:56:29:INFO:VAL-(cmcm) >>
2024-07-15 21:56:29:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.6419  Mult_acc_7: 0.5415  MAE: 0.5564  Corr: 0.8818 
2024-07-15 21:56:35:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-07-15 21:56:40:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.4607
2024-07-15 21:57:18:INFO:VAL-(cmcm) >>
2024-07-15 21:57:18:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7450  Mult_acc_5: 0.4930  F1_score: 0.7813  MAE: 0.3617  Corr: 0.6483  R_squre: 0.2329 
2024-07-15 21:57:23:INFO:TRAIN-(cmcm) (1/26/2)>> loss: 0.4811
2024-07-15 21:57:34:INFO:VAL-(cmcm) >>
2024-07-15 21:57:34:INFO:M: >>  acc: 0.7547  weight_F1: 0.7538 
2024-07-15 21:57:36:INFO:VAL-(cmcm) >>
2024-07-15 21:57:36:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6463  Mult_acc_7: 0.5459  MAE: 0.5599  Corr: 0.8794 
2024-07-15 21:58:23:INFO:TRAIN-(cmcm) (2/27/2)>> loss: 0.4802
2024-07-15 21:58:36:INFO:VAL-(cmcm) >>
2024-07-15 21:58:36:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6463  Mult_acc_7: 0.5459  MAE: 0.5664  Corr: 0.8795 
2024-07-15 21:58:59:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.4593
2024-07-15 21:59:22:INFO:TRAIN-(cmcm) (3/28/2)>> loss: 0.4785
2024-07-15 21:59:35:INFO:VAL-(cmcm) >>
2024-07-15 21:59:35:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6419  Mult_acc_7: 0.5415  MAE: 0.5704  Corr: 0.8774 
2024-07-15 21:59:36:INFO:VAL-(cmcm) >>
2024-07-15 21:59:36:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7666  Mult_acc_5: 0.4946  F1_score: 0.8219  MAE: 0.3263  Corr: 0.6838  R_squre: 0.3787 
2024-07-15 22:00:21:INFO:TRAIN-(cmcm) (4/29/2)>> loss: 0.4768
2024-07-15 22:00:34:INFO:VAL-(cmcm) >>
2024-07-15 22:00:34:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6463  Mult_acc_7: 0.5459  MAE: 0.5673  Corr: 0.8799 
2024-07-15 22:01:19:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.4570
2024-07-15 22:01:20:INFO:TRAIN-(cmcm) (5/30/2)>> loss: 0.4766
2024-07-15 22:01:22:INFO:TEST-(cmcm) >>
2024-07-15 22:01:22:INFO:M: >>  acc: 0.7333  weight_F1: 0.7324 
2024-07-15 22:01:24:INFO:Results are added to results/results/cherma-classification-30.csv...
2024-07-15 22:01:24:INFO:Start running cmcm...
2024-07-15 22:01:24:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 2222}>
2024-07-15 22:01:24:INFO:Let's use the GPU 1 !
2024-07-15 22:01:33:INFO:VAL-(cmcm) >>
2024-07-15 22:01:33:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6419  Mult_acc_7: 0.5415  MAE: 0.5673  Corr: 0.8799 
2024-07-15 22:01:55:INFO:VAL-(cmcm) >>
2024-07-15 22:01:55:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7512  Mult_acc_5: 0.5054  F1_score: 0.8135  MAE: 0.3320  Corr: 0.6756  R_squre: 0.3583 
2024-07-15 22:02:17:INFO:TRAIN-(cmcm) (6/31/2)>> loss: 0.4764
2024-07-15 22:02:30:INFO:VAL-(cmcm) >>
2024-07-15 22:02:30:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6550  Mult_acc_7: 0.5546  MAE: 0.5621  Corr: 0.8804 
2024-07-15 22:03:13:INFO:TRAIN-(cmcm) (7/32/2)>> loss: 0.4768
2024-07-15 22:03:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:03:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052194 HTTP/1.1" 200 280
2024-07-15 22:03:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:03:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:03:26:INFO:VAL-(cmcm) >>
2024-07-15 22:03:26:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6594  Mult_acc_7: 0.5590  MAE: 0.5630  Corr: 0.8798 
2024-07-15 22:03:35:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.4559
2024-07-15 22:03:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052221 HTTP/1.1" 200 280
2024-07-15 22:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:03:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:04:10:INFO:TRAIN-(cmcm) (8/33/2)>> loss: 0.4774
2024-07-15 22:04:12:INFO:VAL-(cmcm) >>
2024-07-15 22:04:12:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7682  Mult_acc_5: 0.5131  F1_score: 0.8107  MAE: 0.3397  Corr: 0.6788  R_squre: 0.3213 
2024-07-15 22:04:23:INFO:VAL-(cmcm) >>
2024-07-15 22:04:23:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8603  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6376  Mult_acc_7: 0.5371  MAE: 0.5678  Corr: 0.8780 
2024-07-15 22:04:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052269 HTTP/1.1" 200 280
2024-07-15 22:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:04:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052271 HTTP/1.1" 200 280
2024-07-15 22:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:04:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:04:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052279 HTTP/1.1" 200 280
2024-07-15 22:04:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:04:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:04:41:INFO:trainable params: 2842380 || all params: 6246426380 || trainable%: 0.04550409829692093
2024-07-15 22:04:41:INFO:Init labels...
2024-07-15 22:04:41:INFO:Start training...
2024-07-15 22:05:07:INFO:TRAIN-(cmcm) (9/34/2)>> loss: 0.4784
2024-07-15 22:05:21:INFO:VAL-(cmcm) >>
2024-07-15 22:05:21:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6507  Mult_acc_7: 0.5502  MAE: 0.5656  Corr: 0.8771 
2024-07-15 22:05:56:INFO:TRAIN-(cmcm) (5/19/1)>> loss: 0.4519
2024-07-15 22:06:06:INFO:TRAIN-(cmcm) (10/35/2)>> loss: 0.4793
2024-07-15 22:06:19:INFO:VAL-(cmcm) >>
2024-07-15 22:06:19:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8647  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.6463  Mult_acc_7: 0.5371  MAE: 0.5678  Corr: 0.8779 
2024-07-15 22:06:34:INFO:VAL-(cmcm) >>
2024-07-15 22:06:34:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7743  Mult_acc_5: 0.5178  F1_score: 0.8209  MAE: 0.3266  Corr: 0.6771  R_squre: 0.3551 
2024-07-15 22:06:58:INFO:TEST-(cmcm) >>
2024-07-15 22:06:58:INFO:M: >>  Has0_acc_2: 0.8805  Has0_F1_score: 0.8802  Non0_acc_2: 0.8948  Non0_F1_score: 0.8947  Mult_acc_5: 0.5481  Mult_acc_7: 0.4665  MAE: 0.6142  Corr: 0.8589 
2024-07-15 22:06:58:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 22:06:58:INFO:Start running cmcm...
2024-07-15 22:06:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-07-15 22:06:58:INFO:Let's use the GPU 1 !
2024-07-15 22:06:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:06:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052419 HTTP/1.1" 200 280
2024-07-15 22:06:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:07:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:07:00:INFO:train samples: (1284,)
2024-07-15 22:07:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:07:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052421 HTTP/1.1" 200 280
2024-07-15 22:07:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:07:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:07:01:INFO:valid samples: (229,)
2024-07-15 22:07:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:07:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052422 HTTP/1.1" 200 280
2024-07-15 22:07:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:07:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:07:03:INFO:test samples: (686,)
2024-07-15 22:07:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:07:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052423 HTTP/1.1" 200 280
2024-07-15 22:07:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:07:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:07:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:07:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721052432 HTTP/1.1" 200 280
2024-07-15 22:07:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:07:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:07:14:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-15 22:07:14:INFO:Init labels...
2024-07-15 22:07:14:INFO:Start training...
2024-07-15 22:07:58:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.5649
2024-07-15 22:08:11:INFO:VAL-(cmcm) >>
2024-07-15 22:08:11:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8481  Non0_acc_2: 0.8472  Non0_F1_score: 0.8480  Mult_acc_5: 0.5415  Mult_acc_7: 0.3188  MAE: 1.0188  Corr: 0.8057 
2024-07-15 22:08:17:INFO:TRAIN-(cmcm) (6/20/1)>> loss: 0.4490
2024-07-15 22:08:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:08:54:INFO:VAL-(cmcm) >>
2024-07-15 22:08:54:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7620  Mult_acc_5: 0.5054  F1_score: 0.8211  MAE: 0.3317  Corr: 0.6816  R_squre: 0.3712 
2024-07-15 22:09:03:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0885
2024-07-15 22:09:17:INFO:VAL-(cmcm) >>
2024-07-15 22:09:17:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8528  Non0_acc_2: 0.8241  Non0_F1_score: 0.8247  Mult_acc_5: 0.4541  Mult_acc_7: 0.3668  MAE: 0.7852  Corr: 0.7898 
2024-07-15 22:09:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:10:09:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.6739
2024-07-15 22:10:22:INFO:VAL-(cmcm) >>
2024-07-15 22:10:22:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8565  Non0_acc_2: 0.8889  Non0_F1_score: 0.8889  Mult_acc_5: 0.5066  Mult_acc_7: 0.3668  MAE: 0.7774  Corr: 0.8272 
2024-07-15 22:10:28:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:10:37:INFO:TRAIN-(cmcm) (7/21/1)>> loss: 0.4501
2024-07-15 22:11:13:INFO:VAL-(cmcm) >>
2024-07-15 22:11:13:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7805  Mult_acc_5: 0.5255  F1_score: 0.8226  MAE: 0.3286  Corr: 0.6931  R_squre: 0.3994 
2024-07-15 22:11:14:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.5911
2024-07-15 22:11:27:INFO:VAL-(cmcm) >>
2024-07-15 22:11:27:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.5284  Mult_acc_7: 0.3886  MAE: 0.7140  Corr: 0.8514 
2024-07-15 22:11:33:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:12:20:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5679
2024-07-15 22:12:33:INFO:VAL-(cmcm) >>
2024-07-15 22:12:33:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8457  Non0_acc_2: 0.8750  Non0_F1_score: 0.8737  Mult_acc_5: 0.4891  Mult_acc_7: 0.3755  MAE: 0.7280  Corr: 0.8278 
2024-07-15 22:12:53:INFO:TRAIN-(cmcm) (8/22/1)>> loss: 0.4480
2024-07-15 22:13:17:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.5564
2024-07-15 22:13:30:INFO:VAL-(cmcm) >>
2024-07-15 22:13:30:INFO:M: >>  Mult_acc_2: 0.8408  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7759  Mult_acc_5: 0.5240  F1_score: 0.8424  MAE: 0.3079  Corr: 0.7054  R_squre: 0.4210 
2024-07-15 22:13:30:INFO:VAL-(cmcm) >>
2024-07-15 22:13:30:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.4978  Mult_acc_7: 0.3537  MAE: 0.7241  Corr: 0.8466 
2024-07-15 22:13:36:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 22:14:15:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.5490
2024-07-15 22:14:28:INFO:VAL-(cmcm) >>
2024-07-15 22:14:28:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8655  Non0_acc_2: 0.8981  Non0_F1_score: 0.8983  Mult_acc_5: 0.5459  Mult_acc_7: 0.3799  MAE: 0.7586  Corr: 0.8296 
2024-07-15 22:15:13:INFO:TRAIN-(cmcm) (4/8/3)>> loss: 0.5399
2024-07-15 22:15:16:INFO:TRAIN-(cmcm) (1/23/1)>> loss: 0.4448
2024-07-15 22:15:26:INFO:VAL-(cmcm) >>
2024-07-15 22:15:26:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8696  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.5415  Mult_acc_7: 0.4236  MAE: 0.6638  Corr: 0.8504 
2024-07-15 22:15:32:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:15:53:INFO:VAL-(cmcm) >>
2024-07-15 22:15:53:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.7342  Mult_acc_5: 0.4900  F1_score: 0.7736  MAE: 0.3808  Corr: 0.6388  R_squre: 0.2026 
2024-07-15 22:16:18:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.5324
2024-07-15 22:16:31:INFO:VAL-(cmcm) >>
2024-07-15 22:16:31:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8652  Non0_acc_2: 0.9028  Non0_F1_score: 0.9027  Mult_acc_5: 0.5502  Mult_acc_7: 0.4148  MAE: 0.6966  Corr: 0.8546 
2024-07-15 22:17:16:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.5258
2024-07-15 22:17:29:INFO:VAL-(cmcm) >>
2024-07-15 22:17:29:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8481  Non0_acc_2: 0.8796  Non0_F1_score: 0.8798  Mult_acc_5: 0.5459  Mult_acc_7: 0.4148  MAE: 0.7258  Corr: 0.8513 
2024-07-15 22:17:37:INFO:TRAIN-(cmcm) (2/24/1)>> loss: 0.4388
2024-07-15 22:18:13:INFO:VAL-(cmcm) >>
2024-07-15 22:18:13:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7821  Mult_acc_5: 0.5317  F1_score: 0.8458  MAE: 0.2995  Corr: 0.7239  R_squre: 0.4840 
2024-07-15 22:18:14:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.5260
2024-07-15 22:18:19:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 22:18:28:INFO:VAL-(cmcm) >>
2024-07-15 22:18:28:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.8935  Non0_F1_score: 0.8936  Mult_acc_5: 0.5415  Mult_acc_7: 0.4105  MAE: 0.6979  Corr: 0.8505 
2024-07-15 22:19:07:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.3847
2024-07-15 22:19:14:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.5164
2024-07-15 22:19:27:INFO:VAL-(cmcm) >>
2024-07-15 22:19:27:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8524  Non0_acc_2: 0.8843  Non0_F1_score: 0.8845  Mult_acc_5: 0.5328  Mult_acc_7: 0.4017  MAE: 0.7027  Corr: 0.8478 
2024-07-15 22:20:02:INFO:TRAIN-(cmcm) (1/25/1)>> loss: 0.4269
2024-07-15 22:20:10:INFO:TRAIN-(cmcm) (5/13/3)>> loss: 0.5150
2024-07-15 22:20:24:INFO:VAL-(cmcm) >>
2024-07-15 22:20:24:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.5371  Mult_acc_7: 0.3886  MAE: 0.7031  Corr: 0.8498 
2024-07-15 22:20:39:INFO:VAL-(cmcm) >>
2024-07-15 22:20:39:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7759  Mult_acc_5: 0.5410  F1_score: 0.8286  MAE: 0.3206  Corr: 0.6913  R_squre: 0.3981 
2024-07-15 22:21:08:INFO:TRAIN-(cmcm) (6/14/3)>> loss: 0.5081
2024-07-15 22:21:21:INFO:VAL-(cmcm) >>
2024-07-15 22:21:21:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8607  Non0_acc_2: 0.8935  Non0_F1_score: 0.8934  Mult_acc_5: 0.5764  Mult_acc_7: 0.4279  MAE: 0.6913  Corr: 0.8511 
2024-07-15 22:22:05:INFO:TRAIN-(cmcm) (7/15/3)>> loss: 0.5048
2024-07-15 22:22:18:INFO:VAL-(cmcm) >>
2024-07-15 22:22:18:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8480  Non0_acc_2: 0.8796  Non0_F1_score: 0.8798  Mult_acc_5: 0.5284  Mult_acc_7: 0.3974  MAE: 0.7232  Corr: 0.8450 
2024-07-15 22:22:22:INFO:TRAIN-(cmcm) (2/26/1)>> loss: 0.4183
2024-07-15 22:22:54:INFO:VAL-(cmcm) >>
2024-07-15 22:22:54:INFO:M: >>  acc: 0.4694  weight_F1: 0.4607 
2024-07-15 22:22:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2024-07-15 22:22:58:INFO:VAL-(cmcm) >>
2024-07-15 22:22:58:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.7666  Mult_acc_5: 0.5410  F1_score: 0.8444  MAE: 0.3056  Corr: 0.7180  R_squre: 0.4556 
2024-07-15 22:23:02:INFO:TRAIN-(cmcm) (8/16/3)>> loss: 0.5019
2024-07-15 22:23:15:INFO:VAL-(cmcm) >>
2024-07-15 22:23:15:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8548  Non0_acc_2: 0.8889  Non0_F1_score: 0.8883  Mult_acc_5: 0.5371  Mult_acc_7: 0.4017  MAE: 0.7154  Corr: 0.8476 
2024-07-15 22:24:01:INFO:TRAIN-(cmcm) (9/17/3)>> loss: 0.4975
2024-07-15 22:24:14:INFO:VAL-(cmcm) >>
2024-07-15 22:24:14:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8475  Non0_acc_2: 0.8750  Non0_F1_score: 0.8749  Mult_acc_5: 0.5284  Mult_acc_7: 0.3886  MAE: 0.7341  Corr: 0.8484 
2024-07-15 22:24:39:INFO:TRAIN-(cmcm) (3/27/1)>> loss: 0.4149
2024-07-15 22:24:58:INFO:TRAIN-(cmcm) (10/18/3)>> loss: 0.4947
2024-07-15 22:25:11:INFO:VAL-(cmcm) >>
2024-07-15 22:25:11:INFO:M: >>  Has0_acc_2: 0.8428  Has0_F1_score: 0.8437  Non0_acc_2: 0.8704  Non0_F1_score: 0.8707  Mult_acc_5: 0.5284  Mult_acc_7: 0.3930  MAE: 0.7293  Corr: 0.8385 
2024-07-15 22:25:16:INFO:VAL-(cmcm) >>
2024-07-15 22:25:16:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7620  Mult_acc_5: 0.5301  F1_score: 0.8286  MAE: 0.3172  Corr: 0.7092  R_squre: 0.4522 
2024-07-15 22:25:51:INFO:TEST-(cmcm) >>
2024-07-15 22:25:51:INFO:M: >>  Has0_acc_2: 0.8571  Has0_F1_score: 0.8565  Non0_acc_2: 0.8765  Non0_F1_score: 0.8764  Mult_acc_5: 0.4913  Mult_acc_7: 0.3805  MAE: 0.7455  Corr: 0.7965 
2024-07-15 22:25:51:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 22:25:51:INFO:Start running cmcm...
2024-07-15 22:25:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-07-15 22:25:51:INFO:Let's use the GPU 1 !
2024-07-15 22:25:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:25:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721053552 HTTP/1.1" 200 280
2024-07-15 22:25:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:25:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:25:53:INFO:train samples: (1284,)
2024-07-15 22:25:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:25:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721053554 HTTP/1.1" 200 280
2024-07-15 22:25:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:25:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:25:54:INFO:valid samples: (229,)
2024-07-15 22:25:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:25:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721053555 HTTP/1.1" 200 280
2024-07-15 22:25:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:25:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:25:56:INFO:test samples: (686,)
2024-07-15 22:25:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:25:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721053557 HTTP/1.1" 200 280
2024-07-15 22:25:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:25:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:26:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:26:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721053566 HTTP/1.1" 200 280
2024-07-15 22:26:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:26:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:26:08:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-15 22:26:08:INFO:Init labels...
2024-07-15 22:26:08:INFO:Start training...
2024-07-15 22:26:52:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.4105
2024-07-15 22:26:58:INFO:TRAIN-(cmcm) (4/28/1)>> loss: 0.4108
2024-07-15 22:27:06:INFO:VAL-(cmcm) >>
2024-07-15 22:27:06:INFO:M: >>  Has0_acc_2: 0.8297  Has0_F1_score: 0.8314  Non0_acc_2: 0.8657  Non0_F1_score: 0.8665  Mult_acc_5: 0.5066  Mult_acc_7: 0.3755  MAE: 0.9210  Corr: 0.8080 
2024-07-15 22:27:11:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:27:34:INFO:VAL-(cmcm) >>
2024-07-15 22:27:34:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7743  Mult_acc_5: 0.5440  F1_score: 0.8363  MAE: 0.3036  Corr: 0.7144  R_squre: 0.4393 
2024-07-15 22:28:00:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.7083
2024-07-15 22:28:14:INFO:VAL-(cmcm) >>
2024-07-15 22:28:14:INFO:M: >>  Has0_acc_2: 0.8341  Has0_F1_score: 0.8356  Non0_acc_2: 0.8657  Non0_F1_score: 0.8663  Mult_acc_5: 0.4454  Mult_acc_7: 0.3450  MAE: 0.7787  Corr: 0.8068 
2024-07-15 22:28:19:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:29:07:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.6064
2024-07-15 22:29:12:INFO:TRAIN-(cmcm) (5/29/1)>> loss: 0.4090
2024-07-15 22:29:20:INFO:VAL-(cmcm) >>
2024-07-15 22:29:20:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8395  Non0_acc_2: 0.8889  Non0_F1_score: 0.8894  Mult_acc_5: 0.4891  Mult_acc_7: 0.3799  MAE: 0.7389  Corr: 0.8262 
2024-07-15 22:29:26:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:29:49:INFO:VAL-(cmcm) >>
2024-07-15 22:29:49:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7883  Mult_acc_5: 0.5100  F1_score: 0.8454  MAE: 0.3005  Corr: 0.7295  R_squre: 0.4672 
2024-07-15 22:30:12:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5840
2024-07-15 22:30:25:INFO:VAL-(cmcm) >>
2024-07-15 22:30:25:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8509  Non0_acc_2: 0.8843  Non0_F1_score: 0.8843  Mult_acc_5: 0.5371  Mult_acc_7: 0.4192  MAE: 0.7014  Corr: 0.8482 
2024-07-15 22:30:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:31:18:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.5652
2024-07-15 22:31:31:INFO:TRAIN-(cmcm) (6/30/1)>> loss: 0.4011
2024-07-15 22:31:31:INFO:VAL-(cmcm) >>
2024-07-15 22:31:31:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8515  Non0_acc_2: 0.8889  Non0_F1_score: 0.8889  Mult_acc_5: 0.4803  Mult_acc_7: 0.3843  MAE: 0.7162  Corr: 0.8388 
2024-07-15 22:32:09:INFO:VAL-(cmcm) >>
2024-07-15 22:32:09:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7805  Mult_acc_5: 0.5410  F1_score: 0.8394  MAE: 0.3051  Corr: 0.7120  R_squre: 0.4409 
2024-07-15 22:32:17:INFO:TRAIN-(cmcm) (2/6/4)>> loss: 0.5525
2024-07-15 22:32:30:INFO:VAL-(cmcm) >>
2024-07-15 22:32:30:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8611  Non0_acc_2: 0.8889  Non0_F1_score: 0.8890  Mult_acc_5: 0.5066  Mult_acc_7: 0.3799  MAE: 0.7520  Corr: 0.8326 
2024-07-15 22:33:15:INFO:TRAIN-(cmcm) (3/7/4)>> loss: 0.5482
2024-07-15 22:33:28:INFO:VAL-(cmcm) >>
2024-07-15 22:33:28:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8690  Non0_acc_2: 0.9074  Non0_F1_score: 0.9071  Mult_acc_5: 0.5240  Mult_acc_7: 0.4192  MAE: 0.6861  Corr: 0.8481 
2024-07-15 22:33:34:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:33:50:INFO:TRAIN-(cmcm) (7/31/1)>> loss: 0.4009
2024-07-15 22:34:22:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.5408
2024-07-15 22:34:26:INFO:VAL-(cmcm) >>
2024-07-15 22:34:26:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7922  Mult_acc_3: 0.7852  Mult_acc_5: 0.5379  F1_score: 0.8423  MAE: 0.2989  Corr: 0.7197  R_squre: 0.4582 
2024-07-15 22:34:32:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 22:34:35:INFO:VAL-(cmcm) >>
2024-07-15 22:34:35:INFO:M: >>  Has0_acc_2: 0.8472  Has0_F1_score: 0.8460  Non0_acc_2: 0.8796  Non0_F1_score: 0.8785  Mult_acc_5: 0.5590  Mult_acc_7: 0.4410  MAE: 0.7114  Corr: 0.8392 
2024-07-15 22:35:20:INFO:TRAIN-(cmcm) (2/9/4)>> loss: 0.5327
2024-07-15 22:35:33:INFO:VAL-(cmcm) >>
2024-07-15 22:35:33:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8571  Non0_acc_2: 0.9028  Non0_F1_score: 0.9033  Mult_acc_5: 0.5502  Mult_acc_7: 0.4236  MAE: 0.6573  Corr: 0.8505 
2024-07-15 22:35:39:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:36:18:INFO:TRAIN-(cmcm) (1/32/1)>> loss: 0.3952
2024-07-15 22:36:26:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.5287
2024-07-15 22:36:39:INFO:VAL-(cmcm) >>
2024-07-15 22:36:39:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8558  Non0_acc_2: 0.8843  Non0_F1_score: 0.8838  Mult_acc_5: 0.5328  Mult_acc_7: 0.4148  MAE: 0.6769  Corr: 0.8591 
2024-07-15 22:36:55:INFO:VAL-(cmcm) >>
2024-07-15 22:36:55:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7512  Mult_acc_5: 0.5394  F1_score: 0.8224  MAE: 0.3156  Corr: 0.6908  R_squre: 0.3770 
2024-07-15 22:37:24:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.5202
2024-07-15 22:37:31:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.6398
2024-07-15 22:37:37:INFO:VAL-(cmcm) >>
2024-07-15 22:37:37:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8657  Non0_acc_2: 0.8981  Non0_F1_score: 0.8984  Mult_acc_5: 0.4760  Mult_acc_7: 0.3843  MAE: 0.6944  Corr: 0.8404 
2024-07-15 22:38:21:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.5159
2024-07-15 22:38:34:INFO:VAL-(cmcm) >>
2024-07-15 22:38:34:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8698  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.5197  Mult_acc_7: 0.4279  MAE: 0.6302  Corr: 0.8595 
2024-07-15 22:38:37:INFO:TRAIN-(cmcm) (2/33/1)>> loss: 0.3940
2024-07-15 22:38:40:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:39:13:INFO:VAL-(cmcm) >>
2024-07-15 22:39:13:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7743  Mult_acc_5: 0.5410  F1_score: 0.8356  MAE: 0.3100  Corr: 0.6987  R_squre: 0.4290 
2024-07-15 22:39:27:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.5159
2024-07-15 22:39:40:INFO:VAL-(cmcm) >>
2024-07-15 22:39:40:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8699  Non0_acc_2: 0.8981  Non0_F1_score: 0.8983  Mult_acc_5: 0.5633  Mult_acc_7: 0.4498  MAE: 0.6533  Corr: 0.8596 
2024-07-15 22:40:25:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.5123
2024-07-15 22:40:38:INFO:VAL-(cmcm) >>
2024-07-15 22:40:38:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8889  Non0_F1_score: 0.8885  Mult_acc_5: 0.5502  Mult_acc_7: 0.4410  MAE: 0.6481  Corr: 0.8613 
2024-07-15 22:40:58:INFO:TRAIN-(cmcm) (3/34/1)>> loss: 0.3918
2024-07-15 22:41:21:INFO:VAL-(cmcm) >>
2024-07-15 22:41:21:INFO:M: >>  acc: 0.4896  weight_F1: 0.4795 
2024-07-15 22:41:24:INFO:TRAIN-(cmcm) (3/15/4)>> loss: 0.5068
2024-07-15 22:41:25:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2024-07-15 22:41:34:INFO:VAL-(cmcm) >>
2024-07-15 22:41:34:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7589  Mult_acc_5: 0.5363  F1_score: 0.8298  MAE: 0.3187  Corr: 0.7072  R_squre: 0.4229 
2024-07-15 22:41:38:INFO:VAL-(cmcm) >>
2024-07-15 22:41:38:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8843  Non0_F1_score: 0.8836  Mult_acc_5: 0.5721  Mult_acc_7: 0.4541  MAE: 0.6341  Corr: 0.8616 
2024-07-15 22:42:22:INFO:TRAIN-(cmcm) (4/16/4)>> loss: 0.5021
2024-07-15 22:42:35:INFO:VAL-(cmcm) >>
2024-07-15 22:42:35:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8737  Non0_acc_2: 0.8935  Non0_F1_score: 0.8933  Mult_acc_5: 0.5459  Mult_acc_7: 0.4323  MAE: 0.6442  Corr: 0.8588 
2024-07-15 22:43:19:INFO:TRAIN-(cmcm) (4/35/1)>> loss: 0.3878
2024-07-15 22:43:21:INFO:TRAIN-(cmcm) (5/17/4)>> loss: 0.4991
2024-07-15 22:43:34:INFO:VAL-(cmcm) >>
2024-07-15 22:43:34:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8587  Non0_acc_2: 0.8843  Non0_F1_score: 0.8833  Mult_acc_5: 0.5328  Mult_acc_7: 0.4323  MAE: 0.6538  Corr: 0.8702 
2024-07-15 22:43:56:INFO:VAL-(cmcm) >>
2024-07-15 22:43:56:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7666  Mult_acc_5: 0.5348  F1_score: 0.8280  MAE: 0.3097  Corr: 0.7104  R_squre: 0.4330 
2024-07-15 22:44:19:INFO:TRAIN-(cmcm) (6/18/4)>> loss: 0.4965
2024-07-15 22:44:32:INFO:VAL-(cmcm) >>
2024-07-15 22:44:32:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8636  Non0_acc_2: 0.8843  Non0_F1_score: 0.8836  Mult_acc_5: 0.5371  Mult_acc_7: 0.4192  MAE: 0.6717  Corr: 0.8619 
2024-07-15 22:45:18:INFO:TRAIN-(cmcm) (7/19/4)>> loss: 0.4917
2024-07-15 22:45:31:INFO:VAL-(cmcm) >>
2024-07-15 22:45:31:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8889  Non0_F1_score: 0.8883  Mult_acc_5: 0.5721  Mult_acc_7: 0.4629  MAE: 0.6232  Corr: 0.8731 
2024-07-15 22:45:37:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:45:39:INFO:TRAIN-(cmcm) (5/36/1)>> loss: 0.3888
2024-07-15 22:46:18:INFO:VAL-(cmcm) >>
2024-07-15 22:46:18:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.7697  Mult_acc_5: 0.5332  F1_score: 0.8393  MAE: 0.3142  Corr: 0.7066  R_squre: 0.4531 
2024-07-15 22:46:23:INFO:TRAIN-(cmcm) (1/20/4)>> loss: 0.4889
2024-07-15 22:46:36:INFO:VAL-(cmcm) >>
2024-07-15 22:46:36:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.8843  Non0_F1_score: 0.8833  Mult_acc_5: 0.5328  Mult_acc_7: 0.4148  MAE: 0.6717  Corr: 0.8658 
2024-07-15 22:47:21:INFO:TRAIN-(cmcm) (2/21/4)>> loss: 0.4860
2024-07-15 22:47:34:INFO:VAL-(cmcm) >>
2024-07-15 22:47:34:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8740  Non0_acc_2: 0.8981  Non0_F1_score: 0.8981  Mult_acc_5: 0.5459  Mult_acc_7: 0.4410  MAE: 0.6459  Corr: 0.8597 
2024-07-15 22:48:00:INFO:TRAIN-(cmcm) (6/37/1)>> loss: 0.3830
2024-07-15 22:48:19:INFO:TRAIN-(cmcm) (3/22/4)>> loss: 0.4853
2024-07-15 22:48:33:INFO:VAL-(cmcm) >>
2024-07-15 22:48:33:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8777  Non0_acc_2: 0.8935  Non0_F1_score: 0.8931  Mult_acc_5: 0.5590  Mult_acc_7: 0.4498  MAE: 0.6197  Corr: 0.8768 
2024-07-15 22:48:36:INFO:VAL-(cmcm) >>
2024-07-15 22:48:36:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7558  Mult_acc_5: 0.5286  F1_score: 0.8351  MAE: 0.3094  Corr: 0.6953  R_squre: 0.4178 
2024-07-15 22:48:39:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-07-15 22:49:25:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 0.4819
2024-07-15 22:49:38:INFO:VAL-(cmcm) >>
2024-07-15 22:49:38:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8739  Non0_acc_2: 0.8981  Non0_F1_score: 0.8980  Mult_acc_5: 0.5721  Mult_acc_7: 0.4585  MAE: 0.6263  Corr: 0.8694 
2024-07-15 22:50:18:INFO:TRAIN-(cmcm) (7/38/1)>> loss: 0.3793
2024-07-15 22:50:25:INFO:TRAIN-(cmcm) (2/24/4)>> loss: 0.4793
2024-07-15 22:50:38:INFO:VAL-(cmcm) >>
2024-07-15 22:50:38:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8796  Non0_F1_score: 0.8785  Mult_acc_5: 0.5415  Mult_acc_7: 0.4279  MAE: 0.6669  Corr: 0.8639 
2024-07-15 22:50:54:INFO:VAL-(cmcm) >>
2024-07-15 22:50:54:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7697  Mult_acc_5: 0.5317  F1_score: 0.8332  MAE: 0.3085  Corr: 0.6980  R_squre: 0.4179 
2024-07-15 22:51:23:INFO:TRAIN-(cmcm) (3/25/4)>> loss: 0.4769
2024-07-15 22:51:37:INFO:VAL-(cmcm) >>
2024-07-15 22:51:37:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8796  Non0_F1_score: 0.8785  Mult_acc_5: 0.5240  Mult_acc_7: 0.4192  MAE: 0.6782  Corr: 0.8595 
2024-07-15 22:52:20:INFO:TRAIN-(cmcm) (4/26/4)>> loss: 0.4756
2024-07-15 22:52:34:INFO:VAL-(cmcm) >>
2024-07-15 22:52:34:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8640  Non0_acc_2: 0.8796  Non0_F1_score: 0.8788  Mult_acc_5: 0.5415  Mult_acc_7: 0.4367  MAE: 0.6669  Corr: 0.8637 
2024-07-15 22:52:37:INFO:TRAIN-(cmcm) (8/39/1)>> loss: 0.3748
2024-07-15 22:53:13:INFO:VAL-(cmcm) >>
2024-07-15 22:53:13:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7790  Mult_acc_5: 0.5471  F1_score: 0.8442  MAE: 0.3011  Corr: 0.7101  R_squre: 0.4345 
2024-07-15 22:53:19:INFO:TRAIN-(cmcm) (5/27/4)>> loss: 0.4743
2024-07-15 22:53:32:INFO:VAL-(cmcm) >>
2024-07-15 22:53:32:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8640  Non0_acc_2: 0.8843  Non0_F1_score: 0.8833  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6533  Corr: 0.8673 
2024-07-15 22:54:17:INFO:TRAIN-(cmcm) (6/28/4)>> loss: 0.4733
2024-07-15 22:54:30:INFO:VAL-(cmcm) >>
2024-07-15 22:54:30:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6555  Corr: 0.8665 
2024-07-15 22:54:56:INFO:TRAIN-(cmcm) (9/40/1)>> loss: 0.3716
2024-07-15 22:55:16:INFO:TRAIN-(cmcm) (7/29/4)>> loss: 0.4723
2024-07-15 22:55:29:INFO:VAL-(cmcm) >>
2024-07-15 22:55:29:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6529  Corr: 0.8670 
2024-07-15 22:55:34:INFO:VAL-(cmcm) >>
2024-07-15 22:55:34:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7697  Mult_acc_5: 0.5410  F1_score: 0.8291  MAE: 0.3162  Corr: 0.7008  R_squre: 0.3821 
2024-07-15 22:55:47:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.5687
2024-07-15 22:56:13:INFO:TRAIN-(cmcm) (8/30/4)>> loss: 0.4722
2024-07-15 22:56:27:INFO:VAL-(cmcm) >>
2024-07-15 22:56:27:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6547  Corr: 0.8666 
2024-07-15 22:57:13:INFO:TRAIN-(cmcm) (9/31/4)>> loss: 0.4723
2024-07-15 22:57:16:INFO:TRAIN-(cmcm) (10/41/1)>> loss: 0.3683
2024-07-15 22:57:26:INFO:VAL-(cmcm) >>
2024-07-15 22:57:26:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8732  Non0_acc_2: 0.8843  Non0_F1_score: 0.8838  Mult_acc_5: 0.5502  Mult_acc_7: 0.4410  MAE: 0.6451  Corr: 0.8705 
2024-07-15 22:57:53:INFO:VAL-(cmcm) >>
2024-07-15 22:57:53:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7805  Mult_acc_5: 0.5533  F1_score: 0.8425  MAE: 0.2900  Corr: 0.7199  R_squre: 0.4662 
2024-07-15 22:57:59:INFO:Saving checkpoint at epoch 41 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 22:58:11:INFO:TRAIN-(cmcm) (10/32/4)>> loss: 0.4730
2024-07-15 22:58:24:INFO:VAL-(cmcm) >>
2024-07-15 22:58:24:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8642  Non0_acc_2: 0.8796  Non0_F1_score: 0.8790  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6608  Corr: 0.8635 
2024-07-15 22:59:03:INFO:TEST-(cmcm) >>
2024-07-15 22:59:03:INFO:M: >>  Has0_acc_2: 0.8761  Has0_F1_score: 0.8756  Non0_acc_2: 0.8902  Non0_F1_score: 0.8900  Mult_acc_5: 0.5000  Mult_acc_7: 0.4213  MAE: 0.6906  Corr: 0.8328 
2024-07-15 22:59:03:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 22:59:03:INFO:Start running cmcm...
2024-07-15 22:59:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [3], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-07-15 22:59:03:INFO:Let's use the GPU 1 !
2024-07-15 22:59:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:59:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721055544 HTTP/1.1" 200 280
2024-07-15 22:59:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:59:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:59:05:INFO:train samples: (1284,)
2024-07-15 22:59:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:59:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721055546 HTTP/1.1" 200 280
2024-07-15 22:59:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:59:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:59:06:INFO:valid samples: (229,)
2024-07-15 22:59:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:59:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721055547 HTTP/1.1" 200 280
2024-07-15 22:59:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:59:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:59:08:INFO:test samples: (686,)
2024-07-15 22:59:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:59:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721055548 HTTP/1.1" 200 280
2024-07-15 22:59:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:59:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:59:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 22:59:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721055558 HTTP/1.1" 200 280
2024-07-15 22:59:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 22:59:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 22:59:20:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-15 22:59:20:INFO:Init labels...
2024-07-15 22:59:20:INFO:Start training...
2024-07-15 22:59:34:INFO:VAL-(cmcm) >>
2024-07-15 22:59:34:INFO:M: >>  acc: 0.6174  weight_F1: 0.6140 
2024-07-15 22:59:39:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2024-07-15 22:59:42:INFO:TRAIN-(cmcm) (1/42/1)>> loss: 0.3651
2024-07-15 23:00:04:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.4634
2024-07-15 23:00:18:INFO:VAL-(cmcm) >>
2024-07-15 23:00:18:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8529  Non0_acc_2: 0.8611  Non0_F1_score: 0.8619  Mult_acc_5: 0.5284  Mult_acc_7: 0.3362  MAE: 0.9533  Corr: 0.8227 
2024-07-15 23:00:18:INFO:VAL-(cmcm) >>
2024-07-15 23:00:18:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7434  Mult_acc_5: 0.5147  F1_score: 0.8263  MAE: 0.3150  Corr: 0.6832  R_squre: 0.4049 
2024-07-15 23:00:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:01:12:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.8155
2024-07-15 23:01:25:INFO:VAL-(cmcm) >>
2024-07-15 23:01:25:INFO:M: >>  Has0_acc_2: 0.8384  Has0_F1_score: 0.8397  Non0_acc_2: 0.8796  Non0_F1_score: 0.8803  Mult_acc_5: 0.5240  Mult_acc_7: 0.4192  MAE: 0.7359  Corr: 0.8148 
2024-07-15 23:01:31:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:01:58:INFO:TRAIN-(cmcm) (2/43/1)>> loss: 0.3623
2024-07-15 23:02:16:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.6492
2024-07-15 23:02:30:INFO:VAL-(cmcm) >>
2024-07-15 23:02:30:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8499  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5197  Mult_acc_7: 0.4236  MAE: 0.6983  Corr: 0.8404 
2024-07-15 23:02:35:INFO:VAL-(cmcm) >>
2024-07-15 23:02:35:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7713  Mult_acc_5: 0.5394  F1_score: 0.8366  MAE: 0.3071  Corr: 0.7008  R_squre: 0.4290 
2024-07-15 23:02:36:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:03:24:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.5850
2024-07-15 23:03:37:INFO:VAL-(cmcm) >>
2024-07-15 23:03:37:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8594  Non0_acc_2: 0.8889  Non0_F1_score: 0.8892  Mult_acc_5: 0.5459  Mult_acc_7: 0.4367  MAE: 0.6717  Corr: 0.8550 
2024-07-15 23:03:43:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:04:16:INFO:TRAIN-(cmcm) (3/44/1)>> loss: 0.3600
2024-07-15 23:04:29:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5675
2024-07-15 23:04:42:INFO:VAL-(cmcm) >>
2024-07-15 23:04:42:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.9074  Non0_F1_score: 0.9075  Mult_acc_5: 0.5721  Mult_acc_7: 0.4672  MAE: 0.6376  Corr: 0.8635 
2024-07-15 23:04:48:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:04:53:INFO:VAL-(cmcm) >>
2024-07-15 23:04:53:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7713  Mult_acc_5: 0.5518  F1_score: 0.8406  MAE: 0.2924  Corr: 0.7217  R_squre: 0.4683 
2024-07-15 23:05:34:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.5548
2024-07-15 23:05:47:INFO:VAL-(cmcm) >>
2024-07-15 23:05:47:INFO:M: >>  Has0_acc_2: 0.8603  Has0_F1_score: 0.8613  Non0_acc_2: 0.9167  Non0_F1_score: 0.9171  Mult_acc_5: 0.5590  Mult_acc_7: 0.4454  MAE: 0.6708  Corr: 0.8557 
2024-07-15 23:06:32:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.5490
2024-07-15 23:06:35:INFO:TRAIN-(cmcm) (4/45/1)>> loss: 0.3584
2024-07-15 23:06:45:INFO:VAL-(cmcm) >>
2024-07-15 23:06:45:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8692  Non0_acc_2: 0.9213  Non0_F1_score: 0.9215  Mult_acc_5: 0.5808  Mult_acc_7: 0.4847  MAE: 0.6276  Corr: 0.8655 
2024-07-15 23:06:51:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:07:12:INFO:VAL-(cmcm) >>
2024-07-15 23:07:12:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7759  Mult_acc_5: 0.5549  F1_score: 0.8317  MAE: 0.3088  Corr: 0.7072  R_squre: 0.4162 
2024-07-15 23:07:37:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.5402
2024-07-15 23:07:50:INFO:VAL-(cmcm) >>
2024-07-15 23:07:50:INFO:M: >>  Has0_acc_2: 0.8515  Has0_F1_score: 0.8524  Non0_acc_2: 0.8935  Non0_F1_score: 0.8941  Mult_acc_5: 0.5502  Mult_acc_7: 0.4629  MAE: 0.6407  Corr: 0.8620 
2024-07-15 23:08:37:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.5332
2024-07-15 23:08:50:INFO:VAL-(cmcm) >>
2024-07-15 23:08:50:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8545  Non0_acc_2: 0.8889  Non0_F1_score: 0.8887  Mult_acc_5: 0.5764  Mult_acc_7: 0.4672  MAE: 0.6547  Corr: 0.8639 
2024-07-15 23:08:55:INFO:TRAIN-(cmcm) (5/46/1)>> loss: 0.3534
2024-07-15 23:09:31:INFO:VAL-(cmcm) >>
2024-07-15 23:09:31:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7620  Mult_acc_5: 0.5379  F1_score: 0.8268  MAE: 0.3117  Corr: 0.6934  R_squre: 0.4119 
2024-07-15 23:09:36:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.5285
2024-07-15 23:09:49:INFO:VAL-(cmcm) >>
2024-07-15 23:09:49:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8692  Non0_acc_2: 0.9213  Non0_F1_score: 0.9213  Mult_acc_5: 0.5633  Mult_acc_7: 0.4367  MAE: 0.6582  Corr: 0.8696 
2024-07-15 23:10:35:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.5242
2024-07-15 23:10:48:INFO:VAL-(cmcm) >>
2024-07-15 23:10:48:INFO:M: >>  Has0_acc_2: 0.8559  Has0_F1_score: 0.8528  Non0_acc_2: 0.9028  Non0_F1_score: 0.9027  Mult_acc_5: 0.6157  Mult_acc_7: 0.4978  MAE: 0.6315  Corr: 0.8678 
2024-07-15 23:11:14:INFO:TRAIN-(cmcm) (6/47/1)>> loss: 0.3523
2024-07-15 23:11:32:INFO:TRAIN-(cmcm) (5/12/5)>> loss: 0.5196
2024-07-15 23:11:45:INFO:VAL-(cmcm) >>
2024-07-15 23:11:45:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8650  Non0_acc_2: 0.9213  Non0_F1_score: 0.9214  Mult_acc_5: 0.5633  Mult_acc_7: 0.4454  MAE: 0.6442  Corr: 0.8659 
2024-07-15 23:11:51:INFO:VAL-(cmcm) >>
2024-07-15 23:11:51:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7589  Mult_acc_5: 0.5348  F1_score: 0.8169  MAE: 0.3185  Corr: 0.7057  R_squre: 0.3844 
2024-07-15 23:12:30:INFO:TRAIN-(cmcm) (6/13/5)>> loss: 0.5141
2024-07-15 23:12:43:INFO:VAL-(cmcm) >>
2024-07-15 23:12:43:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8730  Non0_acc_2: 0.9120  Non0_F1_score: 0.9122  Mult_acc_5: 0.5764  Mult_acc_7: 0.4585  MAE: 0.6385  Corr: 0.8671 
2024-07-15 23:13:29:INFO:TRAIN-(cmcm) (7/14/5)>> loss: 0.5041
2024-07-15 23:13:33:INFO:TRAIN-(cmcm) (7/48/1)>> loss: 0.3480
2024-07-15 23:13:42:INFO:VAL-(cmcm) >>
2024-07-15 23:13:42:INFO:M: >>  Has0_acc_2: 0.8646  Has0_F1_score: 0.8629  Non0_acc_2: 0.9028  Non0_F1_score: 0.9031  Mult_acc_5: 0.5721  Mult_acc_7: 0.4672  MAE: 0.6302  Corr: 0.8693 
2024-07-15 23:13:48:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.4139
2024-07-15 23:14:09:INFO:VAL-(cmcm) >>
2024-07-15 23:14:09:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7682  Mult_acc_5: 0.5502  F1_score: 0.8299  MAE: 0.3066  Corr: 0.7055  R_squre: 0.4128 
2024-07-15 23:14:29:INFO:TRAIN-(cmcm) (8/15/5)>> loss: 0.4962
2024-07-15 23:14:43:INFO:VAL-(cmcm) >>
2024-07-15 23:14:43:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8688  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.5590  Mult_acc_7: 0.4541  MAE: 0.6289  Corr: 0.8689 
2024-07-15 23:15:28:INFO:TRAIN-(cmcm) (9/16/5)>> loss: 0.4924
2024-07-15 23:15:41:INFO:VAL-(cmcm) >>
2024-07-15 23:15:41:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8694  Non0_acc_2: 0.9213  Non0_F1_score: 0.9213  Mult_acc_5: 0.5721  Mult_acc_7: 0.4672  MAE: 0.5848  Corr: 0.8811 
2024-07-15 23:15:47:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:15:50:INFO:TRAIN-(cmcm) (8/49/1)>> loss: 0.3451
2024-07-15 23:16:27:INFO:VAL-(cmcm) >>
2024-07-15 23:16:27:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7635  Mult_acc_5: 0.5317  F1_score: 0.8212  MAE: 0.3121  Corr: 0.6941  R_squre: 0.4080 
2024-07-15 23:16:33:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.4872
2024-07-15 23:16:46:INFO:VAL-(cmcm) >>
2024-07-15 23:16:46:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8815  Non0_acc_2: 0.9028  Non0_F1_score: 0.9028  Mult_acc_5: 0.5939  Mult_acc_7: 0.4891  MAE: 0.5961  Corr: 0.8752 
2024-07-15 23:17:30:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.4842
2024-07-15 23:17:38:INFO:VAL-(cmcm) >>
2024-07-15 23:17:38:INFO:M: >>  acc: 0.6820  weight_F1: 0.6692 
2024-07-15 23:17:42:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2024-07-15 23:17:43:INFO:VAL-(cmcm) >>
2024-07-15 23:17:43:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8764  Non0_acc_2: 0.9074  Non0_F1_score: 0.9075  Mult_acc_5: 0.6070  Mult_acc_7: 0.4978  MAE: 0.5900  Corr: 0.8777 
2024-07-15 23:18:11:INFO:TRAIN-(cmcm) (9/50/1)>> loss: 0.3433
2024-07-15 23:18:28:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.4777
2024-07-15 23:18:41:INFO:VAL-(cmcm) >>
2024-07-15 23:18:41:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8735  Non0_acc_2: 0.9028  Non0_F1_score: 0.9030  Mult_acc_5: 0.5983  Mult_acc_7: 0.5022  MAE: 0.5966  Corr: 0.8711 
2024-07-15 23:18:48:INFO:VAL-(cmcm) >>
2024-07-15 23:18:48:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7743  Mult_acc_5: 0.5425  F1_score: 0.8286  MAE: 0.3170  Corr: 0.6908  R_squre: 0.3975 
2024-07-15 23:19:25:INFO:TRAIN-(cmcm) (4/20/5)>> loss: 0.4732
2024-07-15 23:19:39:INFO:VAL-(cmcm) >>
2024-07-15 23:19:39:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8730  Non0_acc_2: 0.9120  Non0_F1_score: 0.9121  Mult_acc_5: 0.5983  Mult_acc_7: 0.4934  MAE: 0.5970  Corr: 0.8750 
2024-07-15 23:20:22:INFO:TRAIN-(cmcm) (5/21/5)>> loss: 0.4690
2024-07-15 23:20:29:INFO:TRAIN-(cmcm) (10/51/1)>> loss: 0.3410
2024-07-15 23:20:35:INFO:VAL-(cmcm) >>
2024-07-15 23:20:35:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8770  Non0_acc_2: 0.9074  Non0_F1_score: 0.9077  Mult_acc_5: 0.6201  Mult_acc_7: 0.5109  MAE: 0.5861  Corr: 0.8827 
2024-07-15 23:21:06:INFO:VAL-(cmcm) >>
2024-07-15 23:21:06:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7728  Mult_acc_5: 0.5394  F1_score: 0.8328  MAE: 0.3139  Corr: 0.6955  R_squre: 0.4238 
2024-07-15 23:21:21:INFO:TRAIN-(cmcm) (6/22/5)>> loss: 0.4657
2024-07-15 23:21:34:INFO:VAL-(cmcm) >>
2024-07-15 23:21:34:INFO:M: >>  Has0_acc_2: 0.8821  Has0_F1_score: 0.8815  Non0_acc_2: 0.9120  Non0_F1_score: 0.9121  Mult_acc_5: 0.6245  Mult_acc_7: 0.5197  MAE: 0.5844  Corr: 0.8776 
2024-07-15 23:21:40:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-07-15 23:22:04:INFO:TEST-(cmcm) >>
2024-07-15 23:22:04:INFO:M: >>  Mult_acc_2: 0.8472  Mult_acc_2_weak: 0.7702  Mult_acc_3: 0.7959  Mult_acc_5: 0.5996  F1_score: 0.8472  MAE: 0.2749  Corr: 0.7391  R_squre: 0.4830 
2024-07-15 23:22:05:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-15 23:22:05:INFO:Start running cmcm...
2024-07-15 23:22:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 2222}>
2024-07-15 23:22:05:INFO:Let's use the GPU 1 !
2024-07-15 23:22:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 23:22:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721056927 HTTP/1.1" 200 280
2024-07-15 23:22:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 23:22:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 23:22:08:INFO:train samples: (2722,)
2024-07-15 23:22:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 23:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721056930 HTTP/1.1" 200 280
2024-07-15 23:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 23:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 23:22:11:INFO:valid samples: (647,)
2024-07-15 23:22:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 23:22:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721056933 HTTP/1.1" 200 280
2024-07-15 23:22:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 23:22:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 23:22:13:INFO:test samples: (1034,)
2024-07-15 23:22:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 23:22:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721056934 HTTP/1.1" 200 280
2024-07-15 23:22:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 23:22:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 23:22:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-15 23:22:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721056942 HTTP/1.1" 200 280
2024-07-15 23:22:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-15 23:22:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-15 23:22:24:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-15 23:22:24:INFO:Init labels...
2024-07-15 23:22:24:INFO:Start training...
2024-07-15 23:22:27:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.4617
2024-07-15 23:22:40:INFO:VAL-(cmcm) >>
2024-07-15 23:22:40:INFO:M: >>  Has0_acc_2: 0.8690  Has0_F1_score: 0.8685  Non0_acc_2: 0.9074  Non0_F1_score: 0.9073  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.5979  Corr: 0.8757 
2024-07-15 23:23:25:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.4578
2024-07-15 23:23:38:INFO:VAL-(cmcm) >>
2024-07-15 23:23:38:INFO:M: >>  Has0_acc_2: 0.8777  Has0_F1_score: 0.8767  Non0_acc_2: 0.9028  Non0_F1_score: 0.9024  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.6014  Corr: 0.8742 
2024-07-15 23:24:06:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.3163
2024-07-15 23:24:23:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.4561
2024-07-15 23:24:36:INFO:VAL-(cmcm) >>
2024-07-15 23:24:36:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.9028  Non0_F1_score: 0.9024  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.6084  Corr: 0.8714 
2024-07-15 23:24:43:INFO:VAL-(cmcm) >>
2024-07-15 23:24:43:INFO:M: >>  Mult_acc_2: 0.6584  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.4714  Mult_acc_5: 0.3168  F1_score: 0.6055  MAE: 0.4251  Corr: 0.5147  R_squre: 0.2494 
2024-07-15 23:24:49:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 23:25:22:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.4526
2024-07-15 23:25:35:INFO:VAL-(cmcm) >>
2024-07-15 23:25:35:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6114  Mult_acc_7: 0.5109  MAE: 0.5966  Corr: 0.8727 
2024-07-15 23:26:19:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.4510
2024-07-15 23:26:33:INFO:VAL-(cmcm) >>
2024-07-15 23:26:33:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6201  Mult_acc_7: 0.5153  MAE: 0.6014  Corr: 0.8710 
2024-07-15 23:26:35:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.2436
2024-07-15 23:27:12:INFO:VAL-(cmcm) >>
2024-07-15 23:27:12:INFO:M: >>  Mult_acc_2: 0.7002  Mult_acc_2_weak: 0.6078  Mult_acc_3: 0.5796  Mult_acc_5: 0.3493  F1_score: 0.7038  MAE: 0.4632  Corr: 0.5717  R_squre: 0.0410 
2024-07-15 23:27:18:INFO:TRAIN-(cmcm) (6/28/5)>> loss: 0.4496
2024-07-15 23:27:31:INFO:VAL-(cmcm) >>
2024-07-15 23:27:31:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6114  Mult_acc_7: 0.5066  MAE: 0.6005  Corr: 0.8712 
2024-07-15 23:28:16:INFO:TRAIN-(cmcm) (7/29/5)>> loss: 0.4491
2024-07-15 23:28:29:INFO:VAL-(cmcm) >>
2024-07-15 23:28:29:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6114  Mult_acc_7: 0.5066  MAE: 0.6005  Corr: 0.8712 
2024-07-15 23:28:52:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9425
2024-07-15 23:29:15:INFO:TRAIN-(cmcm) (8/30/5)>> loss: 0.4483
2024-07-15 23:29:28:INFO:VAL-(cmcm) >>
2024-07-15 23:29:28:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.6027  Corr: 0.8710 
2024-07-15 23:29:28:INFO:VAL-(cmcm) >>
2024-07-15 23:29:28:INFO:M: >>  Mult_acc_2: 0.6862  Mult_acc_2_weak: 0.6000  Mult_acc_3: 0.6012  Mult_acc_5: 0.3246  F1_score: 0.6862  MAE: 0.5247  Corr: 0.5329  R_squre: -0.2054 
2024-07-15 23:30:14:INFO:TRAIN-(cmcm) (9/31/5)>> loss: 0.4479
2024-07-15 23:30:27:INFO:VAL-(cmcm) >>
2024-07-15 23:30:27:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.6027  Corr: 0.8710 
2024-07-15 23:31:11:INFO:TRAIN-(cmcm) (10/32/5)>> loss: 0.4484
2024-07-15 23:31:12:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.7233
2024-07-15 23:31:25:INFO:VAL-(cmcm) >>
2024-07-15 23:31:25:INFO:M: >>  Has0_acc_2: 0.8734  Has0_F1_score: 0.8724  Non0_acc_2: 0.8981  Non0_F1_score: 0.8978  Mult_acc_5: 0.6070  Mult_acc_7: 0.5022  MAE: 0.6027  Corr: 0.8710 
2024-07-15 23:31:50:INFO:VAL-(cmcm) >>
2024-07-15 23:31:50:INFO:M: >>  Mult_acc_2: 0.7496  Mult_acc_2_weak: 0.6392  Mult_acc_3: 0.6847  Mult_acc_5: 0.3663  F1_score: 0.7527  MAE: 0.4612  Corr: 0.5989  R_squre: -0.0948 
2024-07-15 23:32:04:INFO:TEST-(cmcm) >>
2024-07-15 23:32:04:INFO:M: >>  Has0_acc_2: 0.8688  Has0_F1_score: 0.8685  Non0_acc_2: 0.8963  Non0_F1_score: 0.8959  Mult_acc_5: 0.5452  Mult_acc_7: 0.4636  MAE: 0.6553  Corr: 0.8423 
2024-07-15 23:32:05:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-07-15 23:32:17:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.3492
2024-07-15 23:33:34:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.5889
2024-07-15 23:34:11:INFO:VAL-(cmcm) >>
2024-07-15 23:34:11:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7233  Mult_acc_5: 0.4791  F1_score: 0.7996  MAE: 0.3861  Corr: 0.6414  R_squre: 0.3132 
2024-07-15 23:34:17:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 23:36:01:INFO:VAL-(cmcm) >>
2024-07-15 23:36:01:INFO:M: >>  acc: 0.7317  weight_F1: 0.7312 
2024-07-15 23:36:02:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.4955
2024-07-15 23:36:06:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2024-07-15 23:36:39:INFO:VAL-(cmcm) >>
2024-07-15 23:36:39:INFO:M: >>  Mult_acc_2: 0.7975  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.6832  Mult_acc_5: 0.4250  F1_score: 0.7947  MAE: 0.4074  Corr: 0.6061  R_squre: 0.2559 
2024-07-15 23:38:21:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.4835
2024-07-15 23:38:57:INFO:VAL-(cmcm) >>
2024-07-15 23:38:57:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7311  Mult_acc_5: 0.4560  F1_score: 0.8026  MAE: 0.3960  Corr: 0.6199  R_squre: 0.2883 
2024-07-15 23:40:41:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.4780
2024-07-15 23:41:17:INFO:VAL-(cmcm) >>
2024-07-15 23:41:17:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7635  Mult_acc_5: 0.4900  F1_score: 0.8120  MAE: 0.3869  Corr: 0.6464  R_squre: 0.2551 
2024-07-15 23:42:57:INFO:TRAIN-(cmcm) (4/9/2)>> loss: 0.4738
2024-07-15 23:43:33:INFO:VAL-(cmcm) >>
2024-07-15 23:43:33:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7620  Mult_acc_5: 0.4807  F1_score: 0.8242  MAE: 0.3725  Corr: 0.6666  R_squre: 0.3347 
2024-07-15 23:43:39:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 23:45:21:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.4698
2024-07-15 23:45:58:INFO:VAL-(cmcm) >>
2024-07-15 23:45:58:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7573  Mult_acc_5: 0.4714  F1_score: 0.8236  MAE: 0.3798  Corr: 0.6603  R_squre: 0.2957 
2024-07-15 23:47:37:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.4687
2024-07-15 23:48:14:INFO:VAL-(cmcm) >>
2024-07-15 23:48:14:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7604  Mult_acc_5: 0.4791  F1_score: 0.8152  MAE: 0.3901  Corr: 0.6642  R_squre: 0.2641 
2024-07-15 23:49:53:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 0.4637
2024-07-15 23:50:13:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.3314
2024-07-15 23:50:30:INFO:VAL-(cmcm) >>
2024-07-15 23:50:30:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7388  Mult_acc_5: 0.4730  F1_score: 0.8241  MAE: 0.3736  Corr: 0.6792  R_squre: 0.3069 
2024-07-15 23:52:08:INFO:TRAIN-(cmcm) (4/13/2)>> loss: 0.4602
2024-07-15 23:52:45:INFO:VAL-(cmcm) >>
2024-07-15 23:52:45:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7481  Mult_acc_5: 0.4930  F1_score: 0.8140  MAE: 0.3651  Corr: 0.6598  R_squre: 0.3336 
2024-07-15 23:52:51:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 23:53:59:INFO:VAL-(cmcm) >>
2024-07-15 23:53:59:INFO:M: >>  acc: 0.7315  weight_F1: 0.7259 
2024-07-15 23:54:36:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.4586
2024-07-15 23:55:13:INFO:VAL-(cmcm) >>
2024-07-15 23:55:13:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.4745  F1_score: 0.8258  MAE: 0.3864  Corr: 0.6818  R_squre: 0.2744 
2024-07-15 23:56:53:INFO:TRAIN-(cmcm) (2/15/2)>> loss: 0.4435
2024-07-15 23:57:30:INFO:VAL-(cmcm) >>
2024-07-15 23:57:30:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7883  Mult_acc_5: 0.5209  F1_score: 0.8463  MAE: 0.3467  Corr: 0.7074  R_squre: 0.3963 
2024-07-15 23:57:36:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-15 23:59:22:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.4341
2024-07-15 23:59:58:INFO:VAL-(cmcm) >>
2024-07-15 23:59:58:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7805  Mult_acc_5: 0.4961  F1_score: 0.8443  MAE: 0.3564  Corr: 0.6973  R_squre: 0.3923 
2024-07-16 00:01:39:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.4276
2024-07-16 00:02:16:INFO:VAL-(cmcm) >>
2024-07-16 00:02:16:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7728  Mult_acc_5: 0.4992  F1_score: 0.8373  MAE: 0.3496  Corr: 0.7166  R_squre: 0.3725 
2024-07-16 00:03:58:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.4241
2024-07-16 00:04:35:INFO:VAL-(cmcm) >>
2024-07-16 00:04:35:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7635  Mult_acc_5: 0.5070  F1_score: 0.8288  MAE: 0.3366  Corr: 0.7019  R_squre: 0.3808 
2024-07-16 00:04:41:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 00:06:23:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.4191
2024-07-16 00:06:59:INFO:VAL-(cmcm) >>
2024-07-16 00:06:59:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.8000  Mult_acc_3: 0.7682  Mult_acc_5: 0.5008  F1_score: 0.8417  MAE: 0.3493  Corr: 0.7040  R_squre: 0.4038 
2024-07-16 00:08:03:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.3190
2024-07-16 00:08:41:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.4154
2024-07-16 00:09:18:INFO:VAL-(cmcm) >>
2024-07-16 00:09:18:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7589  Mult_acc_5: 0.5008  F1_score: 0.8258  MAE: 0.3598  Corr: 0.6984  R_squre: 0.3248 
2024-07-16 00:11:00:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.4129
2024-07-16 00:11:38:INFO:VAL-(cmcm) >>
2024-07-16 00:11:38:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7573  Mult_acc_5: 0.4946  F1_score: 0.8443  MAE: 0.3377  Corr: 0.7108  R_squre: 0.4215 
2024-07-16 00:11:48:INFO:VAL-(cmcm) >>
2024-07-16 00:11:48:INFO:M: >>  acc: 0.7130  weight_F1: 0.7150 
2024-07-16 00:13:17:INFO:TRAIN-(cmcm) (4/22/2)>> loss: 0.4088
2024-07-16 00:13:53:INFO:VAL-(cmcm) >>
2024-07-16 00:13:53:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7635  Mult_acc_5: 0.4946  F1_score: 0.8346  MAE: 0.3558  Corr: 0.6975  R_squre: 0.3127 
2024-07-16 00:15:32:INFO:TRAIN-(cmcm) (5/23/2)>> loss: 0.4035
2024-07-16 00:16:10:INFO:VAL-(cmcm) >>
2024-07-16 00:16:10:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7604  Mult_acc_5: 0.4977  F1_score: 0.8388  MAE: 0.3349  Corr: 0.6966  R_squre: 0.4023 
2024-07-16 00:16:16:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 00:17:59:INFO:TRAIN-(cmcm) (1/24/2)>> loss: 0.4004
2024-07-16 00:18:36:INFO:VAL-(cmcm) >>
2024-07-16 00:18:36:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7589  Mult_acc_5: 0.4884  F1_score: 0.8299  MAE: 0.3439  Corr: 0.6973  R_squre: 0.3812 
2024-07-16 00:20:18:INFO:TRAIN-(cmcm) (2/25/2)>> loss: 0.3997
2024-07-16 00:20:57:INFO:VAL-(cmcm) >>
2024-07-16 00:20:57:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7249  Mult_acc_5: 0.4637  F1_score: 0.8315  MAE: 0.3516  Corr: 0.6969  R_squre: 0.3376 
2024-07-16 00:22:33:INFO:TRAIN-(cmcm) (3/26/2)>> loss: 0.3962
2024-07-16 00:23:10:INFO:VAL-(cmcm) >>
2024-07-16 00:23:10:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.8000  Mult_acc_3: 0.7790  Mult_acc_5: 0.5070  F1_score: 0.8417  MAE: 0.3501  Corr: 0.6850  R_squre: 0.4060 
2024-07-16 00:24:47:INFO:TRAIN-(cmcm) (4/27/2)>> loss: 0.3909
2024-07-16 00:25:23:INFO:VAL-(cmcm) >>
2024-07-16 00:25:24:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7604  Mult_acc_5: 0.4900  F1_score: 0.8383  MAE: 0.3470  Corr: 0.6941  R_squre: 0.3811 
2024-07-16 00:25:55:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.3087
2024-07-16 00:27:03:INFO:TRAIN-(cmcm) (5/28/2)>> loss: 0.3896
2024-07-16 00:27:39:INFO:VAL-(cmcm) >>
2024-07-16 00:27:39:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7589  Mult_acc_5: 0.4961  F1_score: 0.8332  MAE: 0.3442  Corr: 0.6941  R_squre: 0.3762 
2024-07-16 00:29:21:INFO:TRAIN-(cmcm) (6/29/2)>> loss: 0.3856
2024-07-16 00:29:40:INFO:VAL-(cmcm) >>
2024-07-16 00:29:40:INFO:M: >>  acc: 0.7454  weight_F1: 0.7459 
2024-07-16 00:29:45:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2024-07-16 00:29:57:INFO:VAL-(cmcm) >>
2024-07-16 00:29:57:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7573  Mult_acc_5: 0.4946  F1_score: 0.8330  MAE: 0.3423  Corr: 0.6917  R_squre: 0.3765 
2024-07-16 00:31:36:INFO:TRAIN-(cmcm) (7/30/2)>> loss: 0.3830
2024-07-16 00:32:12:INFO:VAL-(cmcm) >>
2024-07-16 00:32:12:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7961  Mult_acc_3: 0.7604  Mult_acc_5: 0.4946  F1_score: 0.8341  MAE: 0.3464  Corr: 0.6903  R_squre: 0.3940 
2024-07-16 00:33:57:INFO:TRAIN-(cmcm) (8/31/2)>> loss: 0.3796
2024-07-16 00:34:34:INFO:VAL-(cmcm) >>
2024-07-16 00:34:34:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7295  Mult_acc_5: 0.4791  F1_score: 0.8152  MAE: 0.3558  Corr: 0.6774  R_squre: 0.3551 
2024-07-16 00:36:13:INFO:TRAIN-(cmcm) (9/32/2)>> loss: 0.3760
2024-07-16 00:36:50:INFO:VAL-(cmcm) >>
2024-07-16 00:36:50:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7419  Mult_acc_5: 0.4760  F1_score: 0.8293  MAE: 0.3491  Corr: 0.6866  R_squre: 0.3901 
2024-07-16 00:38:34:INFO:TRAIN-(cmcm) (10/33/2)>> loss: 0.3745
2024-07-16 00:39:11:INFO:VAL-(cmcm) >>
2024-07-16 00:39:11:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7573  Mult_acc_5: 0.5070  F1_score: 0.8343  MAE: 0.3410  Corr: 0.6852  R_squre: 0.3789 
2024-07-16 00:40:10:INFO:TEST-(cmcm) >>
2024-07-16 00:40:10:INFO:M: >>  Mult_acc_2: 0.8259  Mult_acc_2_weak: 0.7350  Mult_acc_3: 0.7718  Mult_acc_5: 0.5406  F1_score: 0.8254  MAE: 0.3070  Corr: 0.7065  R_squre: 0.4132 
2024-07-16 00:40:10:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-16 00:40:10:INFO:Start running cmcm...
2024-07-16 00:40:10:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 3333}>
2024-07-16 00:40:10:INFO:Let's use the GPU 1 !
2024-07-16 00:40:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 00:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721061612 HTTP/1.1" 200 280
2024-07-16 00:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 00:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 00:40:13:INFO:train samples: (2722,)
2024-07-16 00:40:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 00:40:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721061615 HTTP/1.1" 200 280
2024-07-16 00:40:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 00:40:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 00:40:16:INFO:valid samples: (647,)
2024-07-16 00:40:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 00:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721061619 HTTP/1.1" 200 280
2024-07-16 00:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 00:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 00:40:20:INFO:test samples: (1034,)
2024-07-16 00:40:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 00:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721061620 HTTP/1.1" 200 280
2024-07-16 00:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 00:40:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 00:40:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 00:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721061629 HTTP/1.1" 200 280
2024-07-16 00:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 00:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 00:40:31:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-16 00:40:31:INFO:Init labels...
2024-07-16 00:40:31:INFO:Start training...
2024-07-16 00:42:13:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.2908
2024-07-16 00:42:49:INFO:VAL-(cmcm) >>
2024-07-16 00:42:49:INFO:M: >>  Mult_acc_2: 0.6553  Mult_acc_2_weak: 0.6392  Mult_acc_3: 0.4637  Mult_acc_5: 0.3014  F1_score: 0.6307  MAE: 0.4459  Corr: 0.4698  R_squre: 0.1453 
2024-07-16 00:42:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 00:43:54:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.3007
2024-07-16 00:44:37:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.2192
2024-07-16 00:45:14:INFO:VAL-(cmcm) >>
2024-07-16 00:45:14:INFO:M: >>  Mult_acc_2: 0.6816  Mult_acc_2_weak: 0.5765  Mult_acc_3: 0.5765  Mult_acc_5: 0.3617  F1_score: 0.6854  MAE: 0.4713  Corr: 0.5277  R_squre: -0.0451 
2024-07-16 00:46:56:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.9476
2024-07-16 00:47:33:INFO:VAL-(cmcm) >>
2024-07-16 00:47:33:INFO:M: >>  Mult_acc_2: 0.6940  Mult_acc_2_weak: 0.6235  Mult_acc_3: 0.6167  Mult_acc_5: 0.3818  F1_score: 0.6969  MAE: 0.4496  Corr: 0.5532  R_squre: 0.0853 
2024-07-16 00:47:38:INFO:VAL-(cmcm) >>
2024-07-16 00:47:38:INFO:M: >>  acc: 0.7482  weight_F1: 0.7477 
2024-07-16 00:47:42:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2024-07-16 00:49:12:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.7311
2024-07-16 00:49:48:INFO:VAL-(cmcm) >>
2024-07-16 00:49:48:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7295  Mult_acc_5: 0.4699  F1_score: 0.7770  MAE: 0.3940  Corr: 0.6286  R_squre: 0.2921 
2024-07-16 00:49:54:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 00:51:33:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.6734
2024-07-16 00:52:09:INFO:VAL-(cmcm) >>
2024-07-16 00:52:09:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7357  Mult_acc_5: 0.4791  F1_score: 0.7858  MAE: 0.3601  Corr: 0.6637  R_squre: 0.3185 
2024-07-16 00:52:15:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 00:53:57:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.6223
2024-07-16 00:54:33:INFO:VAL-(cmcm) >>
2024-07-16 00:54:33:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7419  Mult_acc_5: 0.4776  F1_score: 0.7814  MAE: 0.3617  Corr: 0.6399  R_squre: 0.3055 
2024-07-16 00:56:12:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.5486
2024-07-16 00:56:48:INFO:VAL-(cmcm) >>
2024-07-16 00:56:48:INFO:M: >>  Mult_acc_2: 0.7233  Mult_acc_2_weak: 0.6078  Mult_acc_3: 0.6940  Mult_acc_5: 0.4389  F1_score: 0.7261  MAE: 0.4051  Corr: 0.6010  R_squre: 0.1486 
2024-07-16 00:58:30:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.5032
2024-07-16 00:59:06:INFO:VAL-(cmcm) >>
2024-07-16 00:59:06:INFO:M: >>  Mult_acc_2: 0.7141  Mult_acc_2_weak: 0.6039  Mult_acc_3: 0.6816  Mult_acc_5: 0.4467  F1_score: 0.7165  MAE: 0.4046  Corr: 0.5748  R_squre: 0.1115 
2024-07-16 01:00:48:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.4855
2024-07-16 01:01:24:INFO:VAL-(cmcm) >>
2024-07-16 01:01:24:INFO:M: >>  Mult_acc_2: 0.7589  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.7202  Mult_acc_5: 0.4776  F1_score: 0.7619  MAE: 0.3682  Corr: 0.6282  R_squre: 0.2639 
2024-07-16 01:01:47:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.2935
2024-07-16 01:03:07:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.4804
2024-07-16 01:03:44:INFO:VAL-(cmcm) >>
2024-07-16 01:03:44:INFO:M: >>  Mult_acc_2: 0.7589  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.7125  Mult_acc_5: 0.4668  F1_score: 0.7619  MAE: 0.3716  Corr: 0.6334  R_squre: 0.2750 
2024-07-16 01:05:24:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.4736
2024-07-16 01:05:32:INFO:VAL-(cmcm) >>
2024-07-16 01:05:32:INFO:M: >>  acc: 0.7186  weight_F1: 0.7168 
2024-07-16 01:06:00:INFO:VAL-(cmcm) >>
2024-07-16 01:06:00:INFO:M: >>  Mult_acc_2: 0.7202  Mult_acc_2_weak: 0.5882  Mult_acc_3: 0.6909  Mult_acc_5: 0.4374  F1_score: 0.7219  MAE: 0.4059  Corr: 0.6003  R_squre: 0.1125 
2024-07-16 01:07:41:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.4690
2024-07-16 01:08:17:INFO:VAL-(cmcm) >>
2024-07-16 01:08:17:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7481  Mult_acc_5: 0.4900  F1_score: 0.7879  MAE: 0.3447  Corr: 0.6595  R_squre: 0.3417 
2024-07-16 01:08:23:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 01:10:06:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.4655
2024-07-16 01:10:42:INFO:VAL-(cmcm) >>
2024-07-16 01:10:42:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7481  Mult_acc_5: 0.4992  F1_score: 0.8013  MAE: 0.3366  Corr: 0.6636  R_squre: 0.3604 
2024-07-16 01:10:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 01:12:32:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.4628
2024-07-16 01:13:08:INFO:VAL-(cmcm) >>
2024-07-16 01:13:08:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7342  Mult_acc_5: 0.4760  F1_score: 0.7787  MAE: 0.3459  Corr: 0.6562  R_squre: 0.3397 
2024-07-16 01:14:48:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.4604
2024-07-16 01:15:24:INFO:VAL-(cmcm) >>
2024-07-16 01:15:24:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7326  Mult_acc_5: 0.4853  F1_score: 0.7742  MAE: 0.3490  Corr: 0.6501  R_squre: 0.3240 
2024-07-16 01:17:02:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.4616
2024-07-16 01:17:39:INFO:VAL-(cmcm) >>
2024-07-16 01:17:39:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7774  Mult_acc_5: 0.5162  F1_score: 0.8273  MAE: 0.3178  Corr: 0.6889  R_squre: 0.4261 
2024-07-16 01:17:45:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 01:19:25:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.4582
2024-07-16 01:19:35:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.2878
2024-07-16 01:20:01:INFO:VAL-(cmcm) >>
2024-07-16 01:20:01:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7821  Mult_acc_5: 0.5131  F1_score: 0.8347  MAE: 0.3128  Corr: 0.6991  R_squre: 0.4475 
2024-07-16 01:20:07:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 01:21:55:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.4549
2024-07-16 01:22:32:INFO:VAL-(cmcm) >>
2024-07-16 01:22:32:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7450  Mult_acc_5: 0.4930  F1_score: 0.7848  MAE: 0.3397  Corr: 0.6680  R_squre: 0.3638 
2024-07-16 01:23:19:INFO:VAL-(cmcm) >>
2024-07-16 01:23:19:INFO:M: >>  acc: 0.7440  weight_F1: 0.7417 
2024-07-16 01:24:09:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.4530
2024-07-16 01:24:45:INFO:VAL-(cmcm) >>
2024-07-16 01:24:45:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7666  Mult_acc_5: 0.5100  F1_score: 0.8150  MAE: 0.3252  Corr: 0.6877  R_squre: 0.4044 
2024-07-16 01:26:23:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.4533
2024-07-16 01:26:59:INFO:VAL-(cmcm) >>
2024-07-16 01:26:59:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7573  Mult_acc_5: 0.5023  F1_score: 0.8060  MAE: 0.3308  Corr: 0.6759  R_squre: 0.3904 
2024-07-16 01:28:41:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.4502
2024-07-16 01:29:18:INFO:VAL-(cmcm) >>
2024-07-16 01:29:18:INFO:M: >>  Mult_acc_2: 0.7944  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7527  Mult_acc_5: 0.5023  F1_score: 0.7970  MAE: 0.3252  Corr: 0.6847  R_squre: 0.4091 
2024-07-16 01:30:59:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.4480
2024-07-16 01:31:36:INFO:VAL-(cmcm) >>
2024-07-16 01:31:36:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7573  Mult_acc_5: 0.5054  F1_score: 0.8058  MAE: 0.3187  Corr: 0.6931  R_squre: 0.4290 
2024-07-16 01:33:15:INFO:TRAIN-(cmcm) (6/23/3)>> loss: 0.4464
2024-07-16 01:33:51:INFO:VAL-(cmcm) >>
2024-07-16 01:33:51:INFO:M: >>  Mult_acc_2: 0.7944  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7573  Mult_acc_5: 0.5039  F1_score: 0.7970  MAE: 0.3261  Corr: 0.6891  R_squre: 0.4196 
2024-07-16 01:35:32:INFO:TRAIN-(cmcm) (7/24/3)>> loss: 0.4426
2024-07-16 01:36:08:INFO:VAL-(cmcm) >>
2024-07-16 01:36:08:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7434  Mult_acc_5: 0.4977  F1_score: 0.7848  MAE: 0.3329  Corr: 0.6735  R_squre: 0.3662 
2024-07-16 01:37:27:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 0.2813
2024-07-16 01:37:47:INFO:TRAIN-(cmcm) (8/25/3)>> loss: 0.4306
2024-07-16 01:38:23:INFO:VAL-(cmcm) >>
2024-07-16 01:38:23:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7666  Mult_acc_5: 0.5039  F1_score: 0.8224  MAE: 0.3116  Corr: 0.7004  R_squre: 0.4522 
2024-07-16 01:38:29:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 01:40:10:INFO:TRAIN-(cmcm) (1/26/3)>> loss: 0.4239
2024-07-16 01:40:47:INFO:VAL-(cmcm) >>
2024-07-16 01:40:47:INFO:M: >>  Mult_acc_2: 0.7944  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7481  Mult_acc_5: 0.5054  F1_score: 0.7970  MAE: 0.3246  Corr: 0.6831  R_squre: 0.3847 
2024-07-16 01:41:12:INFO:VAL-(cmcm) >>
2024-07-16 01:41:12:INFO:M: >>  acc: 0.7458  weight_F1: 0.7453 
2024-07-16 01:42:30:INFO:TRAIN-(cmcm) (2/27/3)>> loss: 0.4212
2024-07-16 01:43:07:INFO:VAL-(cmcm) >>
2024-07-16 01:43:07:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7666  Mult_acc_5: 0.5100  F1_score: 0.8183  MAE: 0.3161  Corr: 0.7031  R_squre: 0.4284 
2024-07-16 01:44:50:INFO:TRAIN-(cmcm) (3/28/3)>> loss: 0.4169
2024-07-16 01:45:27:INFO:VAL-(cmcm) >>
2024-07-16 01:45:27:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7728  Mult_acc_5: 0.5131  F1_score: 0.8228  MAE: 0.3131  Corr: 0.6995  R_squre: 0.4387 
2024-07-16 01:47:09:INFO:TRAIN-(cmcm) (4/29/3)>> loss: 0.4124
2024-07-16 01:47:45:INFO:VAL-(cmcm) >>
2024-07-16 01:47:45:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7682  Mult_acc_5: 0.5100  F1_score: 0.8213  MAE: 0.3139  Corr: 0.6994  R_squre: 0.4260 
2024-07-16 01:49:26:INFO:TRAIN-(cmcm) (5/30/3)>> loss: 0.4122
2024-07-16 01:50:03:INFO:VAL-(cmcm) >>
2024-07-16 01:50:03:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7713  Mult_acc_5: 0.5162  F1_score: 0.8183  MAE: 0.3224  Corr: 0.6990  R_squre: 0.4215 
2024-07-16 01:51:40:INFO:TRAIN-(cmcm) (6/31/3)>> loss: 0.4077
2024-07-16 01:52:17:INFO:VAL-(cmcm) >>
2024-07-16 01:52:17:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7635  Mult_acc_5: 0.5054  F1_score: 0.8062  MAE: 0.3206  Corr: 0.6958  R_squre: 0.4142 
2024-07-16 01:53:59:INFO:TRAIN-(cmcm) (7/32/3)>> loss: 0.4030
2024-07-16 01:54:36:INFO:VAL-(cmcm) >>
2024-07-16 01:54:36:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7790  Mult_acc_5: 0.5193  F1_score: 0.8317  MAE: 0.3121  Corr: 0.7126  R_squre: 0.4755 
2024-07-16 01:55:15:INFO:TRAIN-(cmcm) (4/13/2)>> loss: 0.2760
2024-07-16 01:56:18:INFO:TRAIN-(cmcm) (8/33/3)>> loss: 0.4028
2024-07-16 01:56:55:INFO:VAL-(cmcm) >>
2024-07-16 01:56:55:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7527  Mult_acc_5: 0.4992  F1_score: 0.7893  MAE: 0.3226  Corr: 0.6965  R_squre: 0.4187 
2024-07-16 01:58:31:INFO:TRAIN-(cmcm) (9/34/3)>> loss: 0.3987
2024-07-16 01:58:59:INFO:VAL-(cmcm) >>
2024-07-16 01:58:59:INFO:M: >>  acc: 0.7364  weight_F1: 0.7334 
2024-07-16 01:59:08:INFO:VAL-(cmcm) >>
2024-07-16 01:59:08:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7852  Mult_acc_5: 0.5240  F1_score: 0.8390  MAE: 0.3037  Corr: 0.7213  R_squre: 0.4943 
2024-07-16 01:59:14:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:00:59:INFO:TRAIN-(cmcm) (1/35/3)>> loss: 0.3985
2024-07-16 02:01:36:INFO:VAL-(cmcm) >>
2024-07-16 02:01:36:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7434  Mult_acc_5: 0.4900  F1_score: 0.7877  MAE: 0.3281  Corr: 0.6874  R_squre: 0.4021 
2024-07-16 02:03:19:INFO:TRAIN-(cmcm) (2/36/3)>> loss: 0.3942
2024-07-16 02:03:56:INFO:VAL-(cmcm) >>
2024-07-16 02:03:56:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7280  Mult_acc_5: 0.4791  F1_score: 0.7737  MAE: 0.3513  Corr: 0.6660  R_squre: 0.3361 
2024-07-16 02:05:37:INFO:TRAIN-(cmcm) (3/37/3)>> loss: 0.3928
2024-07-16 02:06:13:INFO:VAL-(cmcm) >>
2024-07-16 02:06:13:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7774  Mult_acc_5: 0.5162  F1_score: 0.8288  MAE: 0.3189  Corr: 0.7036  R_squre: 0.4507 
2024-07-16 02:07:54:INFO:TRAIN-(cmcm) (4/38/3)>> loss: 0.3905
2024-07-16 02:08:30:INFO:VAL-(cmcm) >>
2024-07-16 02:08:30:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7573  Mult_acc_5: 0.5039  F1_score: 0.8016  MAE: 0.3253  Corr: 0.6985  R_squre: 0.4257 
2024-07-16 02:10:10:INFO:TRAIN-(cmcm) (5/39/3)>> loss: 0.3884
2024-07-16 02:10:47:INFO:VAL-(cmcm) >>
2024-07-16 02:10:47:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7743  Mult_acc_5: 0.5162  F1_score: 0.8198  MAE: 0.3071  Corr: 0.7146  R_squre: 0.4575 
2024-07-16 02:12:29:INFO:TRAIN-(cmcm) (6/40/3)>> loss: 0.3865
2024-07-16 02:13:06:INFO:VAL-(cmcm) >>
2024-07-16 02:13:06:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7558  Mult_acc_5: 0.5085  F1_score: 0.8047  MAE: 0.3158  Corr: 0.7039  R_squre: 0.4398 
2024-07-16 02:13:06:INFO:TRAIN-(cmcm) (5/14/2)>> loss: 0.2718
2024-07-16 02:14:50:INFO:TRAIN-(cmcm) (7/41/3)>> loss: 0.3844
2024-07-16 02:15:27:INFO:VAL-(cmcm) >>
2024-07-16 02:15:27:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7713  Mult_acc_5: 0.5193  F1_score: 0.8152  MAE: 0.3181  Corr: 0.7069  R_squre: 0.4584 
2024-07-16 02:16:52:INFO:VAL-(cmcm) >>
2024-07-16 02:16:52:INFO:M: >>  acc: 0.7383  weight_F1: 0.7382 
2024-07-16 02:17:09:INFO:TRAIN-(cmcm) (8/42/3)>> loss: 0.3835
2024-07-16 02:17:46:INFO:VAL-(cmcm) >>
2024-07-16 02:17:46:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7434  Mult_acc_5: 0.5023  F1_score: 0.7909  MAE: 0.3332  Corr: 0.6990  R_squre: 0.4151 
2024-07-16 02:19:26:INFO:TRAIN-(cmcm) (9/43/3)>> loss: 0.3819
2024-07-16 02:20:02:INFO:VAL-(cmcm) >>
2024-07-16 02:20:02:INFO:M: >>  Mult_acc_2: 0.7975  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7604  Mult_acc_5: 0.5116  F1_score: 0.8001  MAE: 0.3199  Corr: 0.7074  R_squre: 0.4381 
2024-07-16 02:21:41:INFO:TRAIN-(cmcm) (10/44/3)>> loss: 0.3785
2024-07-16 02:22:18:INFO:VAL-(cmcm) >>
2024-07-16 02:22:18:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7512  Mult_acc_5: 0.5039  F1_score: 0.7894  MAE: 0.3230  Corr: 0.6964  R_squre: 0.4151 
2024-07-16 02:23:16:INFO:TEST-(cmcm) >>
2024-07-16 02:23:16:INFO:M: >>  Mult_acc_2: 0.8404  Mult_acc_2_weak: 0.7640  Mult_acc_3: 0.7882  Mult_acc_5: 0.5513  F1_score: 0.8404  MAE: 0.2967  Corr: 0.7027  R_squre: 0.4653 
2024-07-16 02:23:17:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-16 02:23:17:INFO:Start running cmcm...
2024-07-16 02:23:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 4444}>
2024-07-16 02:23:17:INFO:Let's use the GPU 1 !
2024-07-16 02:23:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 02:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721067799 HTTP/1.1" 200 280
2024-07-16 02:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 02:23:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 02:23:20:INFO:train samples: (2722,)
2024-07-16 02:23:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 02:23:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721067802 HTTP/1.1" 200 280
2024-07-16 02:23:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 02:23:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 02:23:23:INFO:valid samples: (647,)
2024-07-16 02:23:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 02:23:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721067805 HTTP/1.1" 200 280
2024-07-16 02:23:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 02:23:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 02:23:26:INFO:test samples: (1034,)
2024-07-16 02:23:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 02:23:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721067806 HTTP/1.1" 200 280
2024-07-16 02:23:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 02:23:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 02:23:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 02:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721067814 HTTP/1.1" 200 280
2024-07-16 02:23:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 02:23:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 02:23:37:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-16 02:23:37:INFO:Init labels...
2024-07-16 02:23:37:INFO:Start training...
2024-07-16 02:25:15:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.3352
2024-07-16 02:25:52:INFO:VAL-(cmcm) >>
2024-07-16 02:25:52:INFO:M: >>  Mult_acc_2: 0.6708  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.4621  Mult_acc_5: 0.3091  F1_score: 0.6231  MAE: 0.4385  Corr: 0.4931  R_squre: 0.2156 
2024-07-16 02:25:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:27:38:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.3204
2024-07-16 02:28:14:INFO:VAL-(cmcm) >>
2024-07-16 02:28:14:INFO:M: >>  Mult_acc_2: 0.6677  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.4838  Mult_acc_5: 0.3215  F1_score: 0.6228  MAE: 0.4325  Corr: 0.5022  R_squre: 0.2213 
2024-07-16 02:28:20:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:30:01:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.2690
2024-07-16 02:30:38:INFO:VAL-(cmcm) >>
2024-07-16 02:30:38:INFO:M: >>  Mult_acc_2: 0.7094  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.5518  Mult_acc_5: 0.3617  F1_score: 0.6914  MAE: 0.4177  Corr: 0.5479  R_squre: 0.2431 
2024-07-16 02:30:44:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:30:54:INFO:TRAIN-(cmcm) (6/15/2)>> loss: 0.2680
2024-07-16 02:32:28:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 1.1245
2024-07-16 02:33:05:INFO:VAL-(cmcm) >>
2024-07-16 02:33:05:INFO:M: >>  Mult_acc_2: 0.7419  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.6213  Mult_acc_5: 0.3802  F1_score: 0.7450  MAE: 0.4448  Corr: 0.6109  R_squre: 0.0621 
2024-07-16 02:34:37:INFO:VAL-(cmcm) >>
2024-07-16 02:34:37:INFO:M: >>  acc: 0.7505  weight_F1: 0.7459 
2024-07-16 02:34:45:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.8137
2024-07-16 02:35:22:INFO:VAL-(cmcm) >>
2024-07-16 02:35:22:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7218  Mult_acc_5: 0.4235  F1_score: 0.7772  MAE: 0.4519  Corr: 0.6287  R_squre: 0.0885 
2024-07-16 02:37:01:INFO:TRAIN-(cmcm) (3/6/4)>> loss: 0.6469
2024-07-16 02:37:38:INFO:VAL-(cmcm) >>
2024-07-16 02:37:38:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7403  Mult_acc_5: 0.4590  F1_score: 0.7875  MAE: 0.3777  Corr: 0.6402  R_squre: 0.2284 
2024-07-16 02:37:43:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:39:26:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.5319
2024-07-16 02:40:02:INFO:VAL-(cmcm) >>
2024-07-16 02:40:02:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7311  Mult_acc_5: 0.4652  F1_score: 0.7726  MAE: 0.3810  Corr: 0.6025  R_squre: 0.1748 
2024-07-16 02:41:42:INFO:TRAIN-(cmcm) (2/8/4)>> loss: 0.4983
2024-07-16 02:42:18:INFO:VAL-(cmcm) >>
2024-07-16 02:42:18:INFO:M: >>  Mult_acc_2: 0.7774  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7372  Mult_acc_5: 0.4699  F1_score: 0.7803  MAE: 0.3689  Corr: 0.6166  R_squre: 0.2281 
2024-07-16 02:42:24:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:44:08:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.4869
2024-07-16 02:44:44:INFO:VAL-(cmcm) >>
2024-07-16 02:44:44:INFO:M: >>  Mult_acc_2: 0.7774  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7403  Mult_acc_5: 0.4730  F1_score: 0.7803  MAE: 0.3708  Corr: 0.6181  R_squre: 0.2304 
2024-07-16 02:46:27:INFO:TRAIN-(cmcm) (2/10/4)>> loss: 0.4811
2024-07-16 02:47:04:INFO:VAL-(cmcm) >>
2024-07-16 02:47:04:INFO:M: >>  Mult_acc_2: 0.7604  Mult_acc_2_weak: 0.6431  Mult_acc_3: 0.7295  Mult_acc_5: 0.4683  F1_score: 0.7631  MAE: 0.3827  Corr: 0.6182  R_squre: 0.1927 
2024-07-16 02:48:42:INFO:TRAIN-(cmcm) (7/16/2)>> loss: 0.2633
2024-07-16 02:48:45:INFO:TRAIN-(cmcm) (3/11/4)>> loss: 0.4764
2024-07-16 02:49:22:INFO:VAL-(cmcm) >>
2024-07-16 02:49:22:INFO:M: >>  Mult_acc_2: 0.7728  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.7372  Mult_acc_5: 0.4683  F1_score: 0.7757  MAE: 0.3790  Corr: 0.6215  R_squre: 0.2268 
2024-07-16 02:51:03:INFO:TRAIN-(cmcm) (4/12/4)>> loss: 0.4739
2024-07-16 02:51:40:INFO:VAL-(cmcm) >>
2024-07-16 02:51:40:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7512  Mult_acc_5: 0.4807  F1_score: 0.7909  MAE: 0.3679  Corr: 0.6409  R_squre: 0.2668 
2024-07-16 02:51:46:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:52:25:INFO:VAL-(cmcm) >>
2024-07-16 02:52:25:INFO:M: >>  acc: 0.7444  weight_F1: 0.7435 
2024-07-16 02:53:27:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.4696
2024-07-16 02:54:04:INFO:VAL-(cmcm) >>
2024-07-16 02:54:04:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.7372  Mult_acc_5: 0.4668  F1_score: 0.7741  MAE: 0.3760  Corr: 0.6317  R_squre: 0.1978 
2024-07-16 02:55:46:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.4676
2024-07-16 02:56:25:INFO:VAL-(cmcm) >>
2024-07-16 02:56:25:INFO:M: >>  Mult_acc_2: 0.7805  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7419  Mult_acc_5: 0.4730  F1_score: 0.7833  MAE: 0.3674  Corr: 0.6399  R_squre: 0.2464 
2024-07-16 02:56:31:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 02:58:17:INFO:TRAIN-(cmcm) (1/15/4)>> loss: 0.4630
2024-07-16 02:58:54:INFO:VAL-(cmcm) >>
2024-07-16 02:58:54:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7604  Mult_acc_5: 0.5023  F1_score: 0.8059  MAE: 0.3434  Corr: 0.6535  R_squre: 0.3099 
2024-07-16 02:59:00:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:00:39:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.4526
2024-07-16 03:01:15:INFO:VAL-(cmcm) >>
2024-07-16 03:01:15:INFO:M: >>  Mult_acc_2: 0.7929  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7450  Mult_acc_5: 0.4869  F1_score: 0.7955  MAE: 0.3527  Corr: 0.6557  R_squre: 0.2783 
2024-07-16 03:02:56:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 0.4426
2024-07-16 03:03:32:INFO:VAL-(cmcm) >>
2024-07-16 03:03:32:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7604  Mult_acc_5: 0.4853  F1_score: 0.8137  MAE: 0.3321  Corr: 0.6854  R_squre: 0.3605 
2024-07-16 03:03:38:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:05:20:INFO:TRAIN-(cmcm) (1/18/4)>> loss: 0.4378
2024-07-16 03:05:57:INFO:VAL-(cmcm) >>
2024-07-16 03:05:57:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7573  Mult_acc_5: 0.4776  F1_score: 0.8090  MAE: 0.3388  Corr: 0.6724  R_squre: 0.3466 
2024-07-16 03:06:28:INFO:TRAIN-(cmcm) (8/17/2)>> loss: 0.2583
2024-07-16 03:07:37:INFO:TRAIN-(cmcm) (2/19/4)>> loss: 0.4321
2024-07-16 03:08:13:INFO:VAL-(cmcm) >>
2024-07-16 03:08:13:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7573  Mult_acc_5: 0.4946  F1_score: 0.8016  MAE: 0.3430  Corr: 0.6737  R_squre: 0.3033 
2024-07-16 03:09:53:INFO:TRAIN-(cmcm) (3/20/4)>> loss: 0.4276
2024-07-16 03:10:12:INFO:VAL-(cmcm) >>
2024-07-16 03:10:12:INFO:M: >>  acc: 0.7566  weight_F1: 0.7551 
2024-07-16 03:10:17:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-cherma-classification.pth.
2024-07-16 03:10:30:INFO:VAL-(cmcm) >>
2024-07-16 03:10:30:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7604  Mult_acc_5: 0.4915  F1_score: 0.8047  MAE: 0.3439  Corr: 0.6783  R_squre: 0.3069 
2024-07-16 03:12:09:INFO:TRAIN-(cmcm) (4/21/4)>> loss: 0.4273
2024-07-16 03:12:45:INFO:VAL-(cmcm) >>
2024-07-16 03:12:45:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7697  Mult_acc_5: 0.5023  F1_score: 0.8227  MAE: 0.3235  Corr: 0.6988  R_squre: 0.3901 
2024-07-16 03:12:52:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:14:36:INFO:TRAIN-(cmcm) (1/22/4)>> loss: 0.4247
2024-07-16 03:15:13:INFO:VAL-(cmcm) >>
2024-07-16 03:15:13:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7543  Mult_acc_5: 0.4930  F1_score: 0.8046  MAE: 0.3440  Corr: 0.6625  R_squre: 0.2935 
2024-07-16 03:16:53:INFO:TRAIN-(cmcm) (2/23/4)>> loss: 0.4171
2024-07-16 03:17:30:INFO:VAL-(cmcm) >>
2024-07-16 03:17:30:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7620  Mult_acc_5: 0.5039  F1_score: 0.8062  MAE: 0.3334  Corr: 0.6964  R_squre: 0.3555 
2024-07-16 03:19:09:INFO:TRAIN-(cmcm) (3/24/4)>> loss: 0.4159
2024-07-16 03:19:45:INFO:VAL-(cmcm) >>
2024-07-16 03:19:45:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7774  Mult_acc_5: 0.5085  F1_score: 0.8393  MAE: 0.3113  Corr: 0.7132  R_squre: 0.4222 
2024-07-16 03:19:51:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:21:33:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.4135
2024-07-16 03:22:10:INFO:VAL-(cmcm) >>
2024-07-16 03:22:10:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7573  Mult_acc_5: 0.4915  F1_score: 0.8016  MAE: 0.3371  Corr: 0.6780  R_squre: 0.3372 
2024-07-16 03:23:51:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.4113
2024-07-16 03:24:20:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.2543
2024-07-16 03:24:27:INFO:VAL-(cmcm) >>
2024-07-16 03:24:27:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7821  Mult_acc_5: 0.5100  F1_score: 0.8302  MAE: 0.3093  Corr: 0.7198  R_squre: 0.4379 
2024-07-16 03:24:33:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:26:14:INFO:TRAIN-(cmcm) (1/27/4)>> loss: 0.4081
2024-07-16 03:26:51:INFO:VAL-(cmcm) >>
2024-07-16 03:26:51:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7604  Mult_acc_5: 0.5054  F1_score: 0.8093  MAE: 0.3320  Corr: 0.6860  R_squre: 0.3331 
2024-07-16 03:28:04:INFO:VAL-(cmcm) >>
2024-07-16 03:28:04:INFO:M: >>  acc: 0.7449  weight_F1: 0.7463 
2024-07-16 03:28:30:INFO:TRAIN-(cmcm) (2/28/4)>> loss: 0.4049
2024-07-16 03:29:07:INFO:VAL-(cmcm) >>
2024-07-16 03:29:07:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7573  Mult_acc_5: 0.4977  F1_score: 0.8198  MAE: 0.3199  Corr: 0.6997  R_squre: 0.3920 
2024-07-16 03:30:47:INFO:TRAIN-(cmcm) (3/29/4)>> loss: 0.4030
2024-07-16 03:31:23:INFO:VAL-(cmcm) >>
2024-07-16 03:31:23:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7821  Mult_acc_5: 0.5240  F1_score: 0.8333  MAE: 0.3006  Corr: 0.7224  R_squre: 0.4567 
2024-07-16 03:31:29:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:33:10:INFO:TRAIN-(cmcm) (1/30/4)>> loss: 0.3997
2024-07-16 03:33:46:INFO:VAL-(cmcm) >>
2024-07-16 03:33:46:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7589  Mult_acc_5: 0.4915  F1_score: 0.8243  MAE: 0.3360  Corr: 0.6941  R_squre: 0.3435 
2024-07-16 03:35:31:INFO:TRAIN-(cmcm) (2/31/4)>> loss: 0.3972
2024-07-16 03:36:07:INFO:VAL-(cmcm) >>
2024-07-16 03:36:07:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7836  Mult_acc_5: 0.5193  F1_score: 0.8444  MAE: 0.2943  Corr: 0.7282  R_squre: 0.4845 
2024-07-16 03:36:13:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:37:55:INFO:TRAIN-(cmcm) (1/32/4)>> loss: 0.3930
2024-07-16 03:38:32:INFO:VAL-(cmcm) >>
2024-07-16 03:38:32:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7728  Mult_acc_5: 0.5147  F1_score: 0.8258  MAE: 0.3164  Corr: 0.7101  R_squre: 0.4069 
2024-07-16 03:40:12:INFO:TRAIN-(cmcm) (2/33/4)>> loss: 0.3889
2024-07-16 03:40:49:INFO:VAL-(cmcm) >>
2024-07-16 03:40:49:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7388  Mult_acc_5: 0.4930  F1_score: 0.8092  MAE: 0.3260  Corr: 0.6922  R_squre: 0.3679 
2024-07-16 03:42:03:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.2501
2024-07-16 03:42:29:INFO:TRAIN-(cmcm) (3/34/4)>> loss: 0.3877
2024-07-16 03:43:06:INFO:VAL-(cmcm) >>
2024-07-16 03:43:06:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7573  Mult_acc_5: 0.4977  F1_score: 0.8244  MAE: 0.3215  Corr: 0.7054  R_squre: 0.3823 
2024-07-16 03:44:45:INFO:TRAIN-(cmcm) (4/35/4)>> loss: 0.3832
2024-07-16 03:45:21:INFO:VAL-(cmcm) >>
2024-07-16 03:45:21:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7728  Mult_acc_5: 0.5131  F1_score: 0.8258  MAE: 0.3065  Corr: 0.7236  R_squre: 0.4355 
2024-07-16 03:45:46:INFO:VAL-(cmcm) >>
2024-07-16 03:45:46:INFO:M: >>  acc: 0.7500  weight_F1: 0.7479 
2024-07-16 03:47:00:INFO:TRAIN-(cmcm) (5/36/4)>> loss: 0.3811
2024-07-16 03:47:37:INFO:VAL-(cmcm) >>
2024-07-16 03:47:37:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7527  Mult_acc_5: 0.4915  F1_score: 0.8136  MAE: 0.3230  Corr: 0.6984  R_squre: 0.3872 
2024-07-16 03:49:16:INFO:TRAIN-(cmcm) (6/37/4)>> loss: 0.3782
2024-07-16 03:49:52:INFO:VAL-(cmcm) >>
2024-07-16 03:49:52:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7496  Mult_acc_5: 0.4977  F1_score: 0.8062  MAE: 0.3189  Corr: 0.7102  R_squre: 0.3909 
2024-07-16 03:51:33:INFO:TRAIN-(cmcm) (7/38/4)>> loss: 0.3759
2024-07-16 03:52:09:INFO:VAL-(cmcm) >>
2024-07-16 03:52:09:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7728  Mult_acc_5: 0.5255  F1_score: 0.8326  MAE: 0.2913  Corr: 0.7382  R_squre: 0.4868 
2024-07-16 03:52:15:INFO:Saving checkpoint at epoch 38 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 03:54:00:INFO:TRAIN-(cmcm) (1/39/4)>> loss: 0.3727
2024-07-16 03:54:37:INFO:VAL-(cmcm) >>
2024-07-16 03:54:37:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7512  Mult_acc_5: 0.4853  F1_score: 0.8047  MAE: 0.3158  Corr: 0.7187  R_squre: 0.4325 
2024-07-16 03:56:17:INFO:TRAIN-(cmcm) (2/40/4)>> loss: 0.3702
2024-07-16 03:56:53:INFO:VAL-(cmcm) >>
2024-07-16 03:56:53:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7774  Mult_acc_5: 0.5039  F1_score: 0.8371  MAE: 0.2972  Corr: 0.7407  R_squre: 0.5068 
2024-07-16 03:58:36:INFO:TRAIN-(cmcm) (3/41/4)>> loss: 0.3657
2024-07-16 03:59:13:INFO:VAL-(cmcm) >>
2024-07-16 03:59:13:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7543  Mult_acc_5: 0.4915  F1_score: 0.8227  MAE: 0.3151  Corr: 0.7194  R_squre: 0.4494 
2024-07-16 03:59:47:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.2465
2024-07-16 04:00:55:INFO:TRAIN-(cmcm) (4/42/4)>> loss: 0.3638
2024-07-16 04:01:31:INFO:VAL-(cmcm) >>
2024-07-16 04:01:31:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7543  Mult_acc_5: 0.4869  F1_score: 0.8181  MAE: 0.3153  Corr: 0.7142  R_squre: 0.4313 
2024-07-16 04:03:13:INFO:TRAIN-(cmcm) (5/43/4)>> loss: 0.3633
2024-07-16 04:03:30:INFO:VAL-(cmcm) >>
2024-07-16 04:03:30:INFO:M: >>  acc: 0.7491  weight_F1: 0.7483 
2024-07-16 04:03:50:INFO:VAL-(cmcm) >>
2024-07-16 04:03:50:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7682  Mult_acc_5: 0.5162  F1_score: 0.8253  MAE: 0.3008  Corr: 0.7234  R_squre: 0.4715 
2024-07-16 04:05:29:INFO:TRAIN-(cmcm) (6/44/4)>> loss: 0.3577
2024-07-16 04:06:06:INFO:VAL-(cmcm) >>
2024-07-16 04:06:06:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7651  Mult_acc_5: 0.4992  F1_score: 0.8256  MAE: 0.3005  Corr: 0.7401  R_squre: 0.4919 
2024-07-16 04:07:50:INFO:TRAIN-(cmcm) (7/45/4)>> loss: 0.3550
2024-07-16 04:08:27:INFO:VAL-(cmcm) >>
2024-07-16 04:08:27:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7589  Mult_acc_5: 0.5008  F1_score: 0.8181  MAE: 0.3059  Corr: 0.7297  R_squre: 0.4806 
2024-07-16 04:10:09:INFO:TRAIN-(cmcm) (8/46/4)>> loss: 0.3546
2024-07-16 04:10:45:INFO:VAL-(cmcm) >>
2024-07-16 04:10:45:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7558  Mult_acc_5: 0.5023  F1_score: 0.8165  MAE: 0.3046  Corr: 0.7283  R_squre: 0.4708 
2024-07-16 04:12:24:INFO:TRAIN-(cmcm) (9/47/4)>> loss: 0.3504
2024-07-16 04:13:01:INFO:VAL-(cmcm) >>
2024-07-16 04:13:01:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7635  Mult_acc_5: 0.5116  F1_score: 0.8197  MAE: 0.3077  Corr: 0.7179  R_squre: 0.4507 
2024-07-16 04:14:42:INFO:TRAIN-(cmcm) (10/48/4)>> loss: 0.3478
2024-07-16 04:15:18:INFO:VAL-(cmcm) >>
2024-07-16 04:15:18:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.7651  Mult_acc_5: 0.5039  F1_score: 0.8181  MAE: 0.3037  Corr: 0.7259  R_squre: 0.4653 
2024-07-16 04:16:17:INFO:TEST-(cmcm) >>
2024-07-16 04:16:17:INFO:M: >>  Mult_acc_2: 0.8462  Mult_acc_2_weak: 0.7557  Mult_acc_3: 0.7988  Mult_acc_5: 0.5938  F1_score: 0.8467  MAE: 0.2945  Corr: 0.7298  R_squre: 0.4352 
2024-07-16 04:16:17:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-16 04:16:17:INFO:Start running cmcm...
2024-07-16 04:16:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 5555}>
2024-07-16 04:16:17:INFO:Let's use the GPU 1 !
2024-07-16 04:16:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 04:16:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721074579 HTTP/1.1" 200 280
2024-07-16 04:16:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 04:16:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 04:16:21:INFO:train samples: (2722,)
2024-07-16 04:16:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 04:16:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721074583 HTTP/1.1" 200 280
2024-07-16 04:16:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 04:16:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 04:16:24:INFO:valid samples: (647,)
2024-07-16 04:16:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 04:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721074587 HTTP/1.1" 200 280
2024-07-16 04:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 04:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 04:16:27:INFO:test samples: (1034,)
2024-07-16 04:16:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 04:16:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721074588 HTTP/1.1" 200 280
2024-07-16 04:16:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 04:16:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 04:16:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 04:16:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721074596 HTTP/1.1" 200 280
2024-07-16 04:16:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 04:16:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 04:16:38:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-16 04:16:38:INFO:Init labels...
2024-07-16 04:16:38:INFO:Start training...
2024-07-16 04:17:29:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.2424
2024-07-16 04:18:19:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.2531
2024-07-16 04:18:56:INFO:VAL-(cmcm) >>
2024-07-16 04:18:56:INFO:M: >>  Mult_acc_2: 0.6352  Mult_acc_2_weak: 0.5608  Mult_acc_3: 0.5363  Mult_acc_5: 0.3369  F1_score: 0.6308  MAE: 0.5078  Corr: 0.5085  R_squre: -0.1782 
2024-07-16 04:19:02:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:20:44:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.8325
2024-07-16 04:21:11:INFO:VAL-(cmcm) >>
2024-07-16 04:21:11:INFO:M: >>  acc: 0.7451  weight_F1: 0.7439 
2024-07-16 04:21:21:INFO:VAL-(cmcm) >>
2024-07-16 04:21:21:INFO:M: >>  Mult_acc_2: 0.7573  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.6955  Mult_acc_5: 0.4420  F1_score: 0.7604  MAE: 0.3972  Corr: 0.6081  R_squre: 0.2523 
2024-07-16 04:21:27:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:23:07:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.6811
2024-07-16 04:23:44:INFO:VAL-(cmcm) >>
2024-07-16 04:23:44:INFO:M: >>  Mult_acc_2: 0.7975  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7295  Mult_acc_5: 0.4544  F1_score: 0.7986  MAE: 0.3598  Corr: 0.6684  R_squre: 0.3112 
2024-07-16 04:23:50:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:25:31:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.6447
2024-07-16 04:26:07:INFO:VAL-(cmcm) >>
2024-07-16 04:26:07:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7465  Mult_acc_5: 0.4869  F1_score: 0.8050  MAE: 0.3368  Corr: 0.6542  R_squre: 0.3323 
2024-07-16 04:26:13:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:27:54:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5229
2024-07-16 04:28:31:INFO:VAL-(cmcm) >>
2024-07-16 04:28:31:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7465  Mult_acc_5: 0.5008  F1_score: 0.7878  MAE: 0.3607  Corr: 0.6224  R_squre: 0.2324 
2024-07-16 04:30:14:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.4842
2024-07-16 04:30:51:INFO:VAL-(cmcm) >>
2024-07-16 04:30:51:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7573  Mult_acc_5: 0.5070  F1_score: 0.8153  MAE: 0.3428  Corr: 0.6414  R_squre: 0.2959 
2024-07-16 04:32:31:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.4696
2024-07-16 04:33:07:INFO:VAL-(cmcm) >>
2024-07-16 04:33:07:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7573  Mult_acc_5: 0.5054  F1_score: 0.8155  MAE: 0.3385  Corr: 0.6504  R_squre: 0.3108 
2024-07-16 04:34:47:INFO:TRAIN-(cmcm) (4/8/5)>> loss: 0.4640
2024-07-16 04:35:10:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.2397
2024-07-16 04:35:23:INFO:VAL-(cmcm) >>
2024-07-16 04:35:23:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7496  Mult_acc_5: 0.5039  F1_score: 0.8237  MAE: 0.3249  Corr: 0.6669  R_squre: 0.3600 
2024-07-16 04:35:29:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:37:14:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.4612
2024-07-16 04:37:53:INFO:VAL-(cmcm) >>
2024-07-16 04:37:54:INFO:M: >>  Mult_acc_2: 0.7558  Mult_acc_2_weak: 0.6353  Mult_acc_3: 0.7202  Mult_acc_5: 0.4822  F1_score: 0.7585  MAE: 0.3777  Corr: 0.6095  R_squre: 0.1595 
2024-07-16 04:38:54:INFO:VAL-(cmcm) >>
2024-07-16 04:38:54:INFO:M: >>  acc: 0.7470  weight_F1: 0.7450 
2024-07-16 04:39:31:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.4572
2024-07-16 04:40:08:INFO:VAL-(cmcm) >>
2024-07-16 04:40:08:INFO:M: >>  Mult_acc_2: 0.7913  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7249  Mult_acc_5: 0.4900  F1_score: 0.7939  MAE: 0.3413  Corr: 0.6561  R_squre: 0.3062 
2024-07-16 04:41:49:INFO:TRAIN-(cmcm) (3/11/5)>> loss: 0.4536
2024-07-16 04:42:25:INFO:VAL-(cmcm) >>
2024-07-16 04:42:25:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7465  Mult_acc_5: 0.5054  F1_score: 0.8257  MAE: 0.3270  Corr: 0.6675  R_squre: 0.3443 
2024-07-16 04:44:04:INFO:TRAIN-(cmcm) (4/12/5)>> loss: 0.4518
2024-07-16 04:44:41:INFO:VAL-(cmcm) >>
2024-07-16 04:44:41:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7496  Mult_acc_5: 0.5054  F1_score: 0.8226  MAE: 0.3286  Corr: 0.6691  R_squre: 0.3522 
2024-07-16 04:46:20:INFO:TRAIN-(cmcm) (5/13/5)>> loss: 0.4470
2024-07-16 04:46:56:INFO:VAL-(cmcm) >>
2024-07-16 04:46:56:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7372  Mult_acc_5: 0.4961  F1_score: 0.8250  MAE: 0.3079  Corr: 0.7019  R_squre: 0.4363 
2024-07-16 04:47:02:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 04:48:43:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.4449
2024-07-16 04:49:20:INFO:VAL-(cmcm) >>
2024-07-16 04:49:20:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7156  Mult_acc_5: 0.4869  F1_score: 0.8146  MAE: 0.3107  Corr: 0.6946  R_squre: 0.4314 
2024-07-16 04:51:01:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.4422
2024-07-16 04:51:37:INFO:VAL-(cmcm) >>
2024-07-16 04:51:37:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7342  Mult_acc_5: 0.4869  F1_score: 0.8173  MAE: 0.3246  Corr: 0.6749  R_squre: 0.3694 
2024-07-16 04:52:52:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.2364
2024-07-16 04:53:19:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.4417
2024-07-16 04:53:56:INFO:VAL-(cmcm) >>
2024-07-16 04:53:56:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7558  Mult_acc_5: 0.5070  F1_score: 0.8249  MAE: 0.3187  Corr: 0.6939  R_squre: 0.3950 
2024-07-16 04:55:36:INFO:TRAIN-(cmcm) (4/17/5)>> loss: 0.4395
2024-07-16 04:56:12:INFO:VAL-(cmcm) >>
2024-07-16 04:56:12:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7311  Mult_acc_5: 0.4992  F1_score: 0.8281  MAE: 0.3119  Corr: 0.6966  R_squre: 0.4086 
2024-07-16 04:56:35:INFO:VAL-(cmcm) >>
2024-07-16 04:56:35:INFO:M: >>  acc: 0.7458  weight_F1: 0.7449 
2024-07-16 04:57:54:INFO:TRAIN-(cmcm) (5/18/5)>> loss: 0.4361
2024-07-16 04:58:31:INFO:VAL-(cmcm) >>
2024-07-16 04:58:31:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7620  Mult_acc_5: 0.5240  F1_score: 0.8367  MAE: 0.3122  Corr: 0.6942  R_squre: 0.4081 
2024-07-16 05:00:10:INFO:TRAIN-(cmcm) (6/19/5)>> loss: 0.4355
2024-07-16 05:00:46:INFO:VAL-(cmcm) >>
2024-07-16 05:00:46:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7481  Mult_acc_5: 0.4977  F1_score: 0.8394  MAE: 0.3070  Corr: 0.7059  R_squre: 0.4409 
2024-07-16 05:00:52:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:02:37:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.4322
2024-07-16 05:03:14:INFO:VAL-(cmcm) >>
2024-07-16 05:03:14:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7403  Mult_acc_5: 0.4915  F1_score: 0.8323  MAE: 0.3082  Corr: 0.7023  R_squre: 0.4334 
2024-07-16 05:04:57:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.4305
2024-07-16 05:05:33:INFO:VAL-(cmcm) >>
2024-07-16 05:05:33:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7620  Mult_acc_5: 0.5131  F1_score: 0.8332  MAE: 0.3036  Corr: 0.7108  R_squre: 0.4492 
2024-07-16 05:05:39:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:07:22:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.4298
2024-07-16 05:07:58:INFO:VAL-(cmcm) >>
2024-07-16 05:07:58:INFO:M: >>  Mult_acc_2: 0.8470  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7450  Mult_acc_5: 0.5023  F1_score: 0.8467  MAE: 0.3057  Corr: 0.7077  R_squre: 0.4412 
2024-07-16 05:09:38:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.4263
2024-07-16 05:10:15:INFO:VAL-(cmcm) >>
2024-07-16 05:10:15:INFO:M: >>  Mult_acc_2: 0.8408  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7558  Mult_acc_5: 0.5085  F1_score: 0.8414  MAE: 0.3051  Corr: 0.7033  R_squre: 0.4293 
2024-07-16 05:10:36:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.2337
2024-07-16 05:11:57:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.4230
2024-07-16 05:12:33:INFO:VAL-(cmcm) >>
2024-07-16 05:12:33:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.5085  F1_score: 0.8381  MAE: 0.3045  Corr: 0.7115  R_squre: 0.4470 
2024-07-16 05:14:14:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.4216
2024-07-16 05:14:20:INFO:VAL-(cmcm) >>
2024-07-16 05:14:20:INFO:M: >>  acc: 0.7468  weight_F1: 0.7464 
2024-07-16 05:14:51:INFO:VAL-(cmcm) >>
2024-07-16 05:14:51:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7666  Mult_acc_5: 0.5178  F1_score: 0.8394  MAE: 0.3023  Corr: 0.7146  R_squre: 0.4488 
2024-07-16 05:14:57:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:16:41:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.4194
2024-07-16 05:17:19:INFO:VAL-(cmcm) >>
2024-07-16 05:17:19:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7558  Mult_acc_5: 0.5008  F1_score: 0.8390  MAE: 0.3023  Corr: 0.7060  R_squre: 0.4424 
2024-07-16 05:18:58:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.4173
2024-07-16 05:19:34:INFO:VAL-(cmcm) >>
2024-07-16 05:19:34:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7604  Mult_acc_5: 0.5070  F1_score: 0.8433  MAE: 0.2946  Corr: 0.7190  R_squre: 0.4728 
2024-07-16 05:19:40:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:21:22:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.4134
2024-07-16 05:21:59:INFO:VAL-(cmcm) >>
2024-07-16 05:21:59:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7372  Mult_acc_5: 0.4930  F1_score: 0.8316  MAE: 0.3100  Corr: 0.6999  R_squre: 0.4181 
2024-07-16 05:23:39:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.4104
2024-07-16 05:24:16:INFO:VAL-(cmcm) >>
2024-07-16 05:24:16:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7465  Mult_acc_5: 0.4992  F1_score: 0.8437  MAE: 0.2989  Corr: 0.7156  R_squre: 0.4602 
2024-07-16 05:25:59:INFO:TRAIN-(cmcm) (3/30/5)>> loss: 0.4021
2024-07-16 05:26:35:INFO:VAL-(cmcm) >>
2024-07-16 05:26:36:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7589  Mult_acc_5: 0.5070  F1_score: 0.8402  MAE: 0.2915  Corr: 0.7165  R_squre: 0.4803 
2024-07-16 05:26:41:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:28:02:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.2312
2024-07-16 05:28:24:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.3943
2024-07-16 05:29:01:INFO:VAL-(cmcm) >>
2024-07-16 05:29:01:INFO:M: >>  Mult_acc_2: 0.8547  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7635  Mult_acc_5: 0.5178  F1_score: 0.8535  MAE: 0.2940  Corr: 0.7275  R_squre: 0.4887 
2024-07-16 05:30:42:INFO:TRAIN-(cmcm) (2/32/5)>> loss: 0.3895
2024-07-16 05:31:19:INFO:VAL-(cmcm) >>
2024-07-16 05:31:19:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7326  Mult_acc_5: 0.4946  F1_score: 0.8327  MAE: 0.3141  Corr: 0.6919  R_squre: 0.3996 
2024-07-16 05:31:45:INFO:VAL-(cmcm) >>
2024-07-16 05:31:45:INFO:M: >>  acc: 0.7449  weight_F1: 0.7447 
2024-07-16 05:33:00:INFO:TRAIN-(cmcm) (3/33/5)>> loss: 0.3854
2024-07-16 05:33:36:INFO:VAL-(cmcm) >>
2024-07-16 05:33:36:INFO:M: >>  Mult_acc_2: 0.8547  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7682  Mult_acc_5: 0.5193  F1_score: 0.8539  MAE: 0.2964  Corr: 0.7170  R_squre: 0.4701 
2024-07-16 05:35:16:INFO:TRAIN-(cmcm) (4/34/5)>> loss: 0.3808
2024-07-16 05:35:30:INFO:TEST-(cmcm) >>
2024-07-16 05:35:30:INFO:M: >>  acc: 0.7234  weight_F1: 0.7204 
2024-07-16 05:35:31:INFO:Results are added to results/results/cherma-classification-30.csv...
2024-07-16 05:35:31:INFO:Start running cmcm...
2024-07-16 05:35:31:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 3333}>
2024-07-16 05:35:31:INFO:Let's use the GPU 1 !
2024-07-16 05:35:52:INFO:VAL-(cmcm) >>
2024-07-16 05:35:52:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7388  Mult_acc_5: 0.4884  F1_score: 0.8391  MAE: 0.2955  Corr: 0.7192  R_squre: 0.4811 
2024-07-16 05:37:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 05:37:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721079432 HTTP/1.1" 200 280
2024-07-16 05:37:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 05:37:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 05:37:33:INFO:TRAIN-(cmcm) (5/35/5)>> loss: 0.3760
2024-07-16 05:38:09:INFO:VAL-(cmcm) >>
2024-07-16 05:38:09:INFO:M: >>  Mult_acc_2: 0.8485  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7635  Mult_acc_5: 0.5209  F1_score: 0.8475  MAE: 0.2912  Corr: 0.7191  R_squre: 0.4716 
2024-07-16 05:38:15:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:39:56:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.3725
2024-07-16 05:40:32:INFO:VAL-(cmcm) >>
2024-07-16 05:40:32:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7249  Mult_acc_5: 0.4884  F1_score: 0.8242  MAE: 0.2946  Corr: 0.7199  R_squre: 0.4843 
2024-07-16 05:42:11:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.3679
2024-07-16 05:42:48:INFO:VAL-(cmcm) >>
2024-07-16 05:42:48:INFO:M: >>  Mult_acc_2: 0.8563  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7759  Mult_acc_5: 0.5394  F1_score: 0.8562  MAE: 0.2909  Corr: 0.7328  R_squre: 0.4741 
2024-07-16 05:42:53:INFO:Saving checkpoint at epoch 37 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 05:43:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 05:43:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721079788 HTTP/1.1" 200 280
2024-07-16 05:43:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 05:43:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 05:44:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 05:44:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721079840 HTTP/1.1" 200 280
2024-07-16 05:44:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 05:44:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 05:44:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 05:44:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721079842 HTTP/1.1" 200 280
2024-07-16 05:44:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 05:44:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 05:44:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 05:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721079852 HTTP/1.1" 200 280
2024-07-16 05:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 05:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 05:44:14:INFO:trainable params: 2842380 || all params: 6246426380 || trainable%: 0.04550409829692093
2024-07-16 05:44:14:INFO:Init labels...
2024-07-16 05:44:14:INFO:Start training...
2024-07-16 05:44:35:INFO:TRAIN-(cmcm) (1/38/5)>> loss: 0.3671
2024-07-16 05:45:11:INFO:VAL-(cmcm) >>
2024-07-16 05:45:11:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7481  Mult_acc_5: 0.5131  F1_score: 0.8303  MAE: 0.2949  Corr: 0.7208  R_squre: 0.4764 
2024-07-16 05:46:51:INFO:TRAIN-(cmcm) (2/39/5)>> loss: 0.3632
2024-07-16 05:47:28:INFO:VAL-(cmcm) >>
2024-07-16 05:47:28:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7110  Mult_acc_5: 0.4714  F1_score: 0.8149  MAE: 0.3066  Corr: 0.7071  R_squre: 0.4689 
2024-07-16 05:49:08:INFO:TRAIN-(cmcm) (3/40/5)>> loss: 0.3607
2024-07-16 05:49:44:INFO:VAL-(cmcm) >>
2024-07-16 05:49:44:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7388  Mult_acc_5: 0.5008  F1_score: 0.8282  MAE: 0.3008  Corr: 0.7104  R_squre: 0.4561 
2024-07-16 05:51:25:INFO:TRAIN-(cmcm) (4/41/5)>> loss: 0.3574
2024-07-16 05:52:01:INFO:VAL-(cmcm) >>
2024-07-16 05:52:01:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7419  Mult_acc_5: 0.5193  F1_score: 0.8317  MAE: 0.2974  Corr: 0.7208  R_squre: 0.4655 
2024-07-16 05:53:43:INFO:TRAIN-(cmcm) (5/42/5)>> loss: 0.3549
2024-07-16 05:54:19:INFO:VAL-(cmcm) >>
2024-07-16 05:54:19:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7280  Mult_acc_5: 0.4869  F1_score: 0.8296  MAE: 0.3066  Corr: 0.7064  R_squre: 0.4590 
2024-07-16 05:55:59:INFO:TRAIN-(cmcm) (6/43/5)>> loss: 0.3518
2024-07-16 05:56:35:INFO:VAL-(cmcm) >>
2024-07-16 05:56:35:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7172  Mult_acc_5: 0.4900  F1_score: 0.8158  MAE: 0.3008  Corr: 0.7133  R_squre: 0.4687 
2024-07-16 05:58:12:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.3663
2024-07-16 05:58:17:INFO:TRAIN-(cmcm) (7/44/5)>> loss: 0.3477
2024-07-16 05:58:53:INFO:VAL-(cmcm) >>
2024-07-16 05:58:53:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7388  Mult_acc_5: 0.4992  F1_score: 0.8269  MAE: 0.3020  Corr: 0.7115  R_squre: 0.4694 
2024-07-16 06:00:33:INFO:TRAIN-(cmcm) (8/45/5)>> loss: 0.3449
2024-07-16 06:01:10:INFO:VAL-(cmcm) >>
2024-07-16 06:01:10:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7249  Mult_acc_5: 0.4992  F1_score: 0.8241  MAE: 0.3008  Corr: 0.7155  R_squre: 0.4704 
2024-07-16 06:01:56:INFO:VAL-(cmcm) >>
2024-07-16 06:01:56:INFO:M: >>  acc: 0.3998  weight_F1: 0.3726 
2024-07-16 06:02:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2024-07-16 06:02:50:INFO:TRAIN-(cmcm) (9/46/5)>> loss: 0.3418
2024-07-16 06:03:28:INFO:VAL-(cmcm) >>
2024-07-16 06:03:28:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6971  Mult_acc_5: 0.4683  F1_score: 0.8101  MAE: 0.3070  Corr: 0.7060  R_squre: 0.4657 
2024-07-16 06:05:10:INFO:TRAIN-(cmcm) (10/47/5)>> loss: 0.3375
2024-07-16 06:05:46:INFO:VAL-(cmcm) >>
2024-07-16 06:05:46:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7403  Mult_acc_5: 0.5085  F1_score: 0.8290  MAE: 0.3008  Corr: 0.7155  R_squre: 0.4724 
2024-07-16 06:06:44:INFO:TEST-(cmcm) >>
2024-07-16 06:06:44:INFO:M: >>  Mult_acc_2: 0.8288  Mult_acc_2_weak: 0.7371  Mult_acc_3: 0.7708  Mult_acc_5: 0.5484  F1_score: 0.8285  MAE: 0.3054  Corr: 0.7202  R_squre: 0.4121 
2024-07-16 06:06:45:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-16 06:15:52:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.6573
2024-07-16 06:19:34:INFO:VAL-(cmcm) >>
2024-07-16 06:19:34:INFO:M: >>  acc: 0.5445  weight_F1: 0.5118 
2024-07-16 06:19:38:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2024-07-16 06:33:34:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.4023
2024-07-16 06:37:16:INFO:VAL-(cmcm) >>
2024-07-16 06:37:16:INFO:M: >>  acc: 0.6246  weight_F1: 0.5981 
2024-07-16 06:37:21:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2024-07-16 06:51:17:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.3492
2024-07-16 06:54:59:INFO:VAL-(cmcm) >>
2024-07-16 06:54:59:INFO:M: >>  acc: 0.7183  weight_F1: 0.7195 
2024-07-16 06:55:03:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2024-07-16 07:08:59:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.3224
2024-07-16 07:12:41:INFO:VAL-(cmcm) >>
2024-07-16 07:12:41:INFO:M: >>  acc: 0.7287  weight_F1: 0.7267 
2024-07-16 07:12:45:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2024-07-16 07:26:45:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.3098
2024-07-16 07:30:28:INFO:VAL-(cmcm) >>
2024-07-16 07:30:28:INFO:M: >>  acc: 0.7308  weight_F1: 0.7309 
2024-07-16 07:30:32:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-cherma-classification.pth.
2024-07-16 07:44:25:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.2993
2024-07-16 07:48:09:INFO:VAL-(cmcm) >>
2024-07-16 07:48:09:INFO:M: >>  acc: 0.7512  weight_F1: 0.7459 
2024-07-16 07:48:13:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-cherma-classification.pth.
2024-07-16 08:01:43:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.2909
2024-07-16 08:05:25:INFO:VAL-(cmcm) >>
2024-07-16 08:05:25:INFO:M: >>  acc: 0.7491  weight_F1: 0.7463 
2024-07-16 08:05:30:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2024-07-16 08:18:59:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.2853
2024-07-16 08:22:42:INFO:VAL-(cmcm) >>
2024-07-16 08:22:42:INFO:M: >>  acc: 0.7482  weight_F1: 0.7450 
2024-07-16 08:36:37:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.2779
2024-07-16 08:40:20:INFO:VAL-(cmcm) >>
2024-07-16 08:40:20:INFO:M: >>  acc: 0.7327  weight_F1: 0.7317 
2024-07-16 08:53:58:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.2716
2024-07-16 08:57:41:INFO:VAL-(cmcm) >>
2024-07-16 08:57:41:INFO:M: >>  acc: 0.7461  weight_F1: 0.7459 
2024-07-16 09:11:30:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.2663
2024-07-16 09:15:13:INFO:VAL-(cmcm) >>
2024-07-16 09:15:13:INFO:M: >>  acc: 0.7493  weight_F1: 0.7462 
2024-07-16 09:28:54:INFO:TRAIN-(cmcm) (5/13/3)>> loss: 0.2621
2024-07-16 09:32:37:INFO:VAL-(cmcm) >>
2024-07-16 09:32:37:INFO:M: >>  acc: 0.7470  weight_F1: 0.7440 
2024-07-16 09:46:17:INFO:TRAIN-(cmcm) (6/14/3)>> loss: 0.2556
2024-07-16 09:50:00:INFO:VAL-(cmcm) >>
2024-07-16 09:50:00:INFO:M: >>  acc: 0.7491  weight_F1: 0.7469 
2024-07-16 09:50:05:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-cherma-classification.pth.
2024-07-16 10:03:37:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.2505
2024-07-16 10:07:20:INFO:VAL-(cmcm) >>
2024-07-16 10:07:20:INFO:M: >>  acc: 0.7550  weight_F1: 0.7529 
2024-07-16 10:07:24:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-cherma-classification.pth.
2024-07-16 10:20:57:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.2462
2024-07-16 10:24:40:INFO:VAL-(cmcm) >>
2024-07-16 10:24:40:INFO:M: >>  acc: 0.7491  weight_F1: 0.7438 
2024-07-16 10:38:37:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.2407
2024-07-16 10:42:20:INFO:VAL-(cmcm) >>
2024-07-16 10:42:20:INFO:M: >>  acc: 0.7510  weight_F1: 0.7499 
2024-07-16 10:56:01:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.2365
2024-07-16 10:59:43:INFO:VAL-(cmcm) >>
2024-07-16 10:59:43:INFO:M: >>  acc: 0.7449  weight_F1: 0.7433 
2024-07-16 11:13:18:INFO:TRAIN-(cmcm) (4/19/3)>> loss: 0.2307
2024-07-16 11:17:01:INFO:VAL-(cmcm) >>
2024-07-16 11:17:01:INFO:M: >>  acc: 0.7505  weight_F1: 0.7476 
2024-07-16 11:30:37:INFO:TRAIN-(cmcm) (5/20/3)>> loss: 0.2273
2024-07-16 11:34:20:INFO:VAL-(cmcm) >>
2024-07-16 11:34:20:INFO:M: >>  acc: 0.7460  weight_F1: 0.7458 
2024-07-16 11:48:02:INFO:TRAIN-(cmcm) (6/21/3)>> loss: 0.2222
2024-07-16 11:51:45:INFO:VAL-(cmcm) >>
2024-07-16 11:51:45:INFO:M: >>  acc: 0.7482  weight_F1: 0.7469 
2024-07-16 12:05:11:INFO:TRAIN-(cmcm) (7/22/3)>> loss: 0.2178
2024-07-16 12:08:54:INFO:VAL-(cmcm) >>
2024-07-16 12:08:54:INFO:M: >>  acc: 0.7465  weight_F1: 0.7439 
2024-07-16 12:22:32:INFO:TRAIN-(cmcm) (8/23/3)>> loss: 0.2144
2024-07-16 12:26:15:INFO:VAL-(cmcm) >>
2024-07-16 12:26:15:INFO:M: >>  acc: 0.7472  weight_F1: 0.7449 
2024-07-16 12:29:57:INFO:TEST-(cmcm) >>
2024-07-16 12:29:57:INFO:M: >>  acc: 0.7307  weight_F1: 0.7276 
2024-07-16 12:29:59:INFO:Results are added to results/results/cherma-classification-30.csv...
2024-07-16 12:29:59:INFO:Start running cmcm...
2024-07-16 12:29:59:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 4444}>
2024-07-16 12:29:59:INFO:Let's use the GPU 1 !
2024-07-16 12:31:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 12:31:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721104311 HTTP/1.1" 200 280
2024-07-16 12:31:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 12:31:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 12:32:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 12:32:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721104340 HTTP/1.1" 200 280
2024-07-16 12:32:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 12:32:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 12:33:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 12:33:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721104382 HTTP/1.1" 200 280
2024-07-16 12:33:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 12:33:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 12:33:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 12:33:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721104384 HTTP/1.1" 200 280
2024-07-16 12:33:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 12:33:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 12:33:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 12:33:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721104392 HTTP/1.1" 200 280
2024-07-16 12:33:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 12:33:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 12:33:14:INFO:trainable params: 2842380 || all params: 6246426380 || trainable%: 0.04550409829692093
2024-07-16 12:33:14:INFO:Init labels...
2024-07-16 12:33:14:INFO:Start training...
2024-07-16 12:46:49:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.0776
2024-07-16 12:50:32:INFO:VAL-(cmcm) >>
2024-07-16 12:50:32:INFO:M: >>  acc: 0.3712  weight_F1: 0.3245 
2024-07-16 12:50:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2024-07-16 13:04:29:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.7194
2024-07-16 13:08:13:INFO:VAL-(cmcm) >>
2024-07-16 13:08:13:INFO:M: >>  acc: 0.4811  weight_F1: 0.4450 
2024-07-16 13:08:17:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2024-07-16 13:22:17:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.4923
2024-07-16 13:26:01:INFO:VAL-(cmcm) >>
2024-07-16 13:26:01:INFO:M: >>  acc: 0.6683  weight_F1: 0.6524 
2024-07-16 13:26:06:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2024-07-16 13:40:07:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.3782
2024-07-16 13:43:51:INFO:VAL-(cmcm) >>
2024-07-16 13:43:51:INFO:M: >>  acc: 0.6796  weight_F1: 0.6605 
2024-07-16 13:43:56:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2024-07-16 13:57:56:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.3446
2024-07-16 14:01:39:INFO:VAL-(cmcm) >>
2024-07-16 14:01:39:INFO:M: >>  acc: 0.7172  weight_F1: 0.7066 
2024-07-16 14:01:43:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2024-07-16 14:15:44:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.3252
2024-07-16 14:19:27:INFO:VAL-(cmcm) >>
2024-07-16 14:19:27:INFO:M: >>  acc: 0.7339  weight_F1: 0.7277 
2024-07-16 14:19:31:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-cherma-classification.pth.
2024-07-16 14:33:24:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.3136
2024-07-16 14:37:08:INFO:VAL-(cmcm) >>
2024-07-16 14:37:08:INFO:M: >>  acc: 0.7169  weight_F1: 0.7161 
2024-07-16 14:50:55:INFO:TRAIN-(cmcm) (2/8/4)>> loss: 0.3045
2024-07-16 14:54:39:INFO:VAL-(cmcm) >>
2024-07-16 14:54:39:INFO:M: >>  acc: 0.7301  weight_F1: 0.7290 
2024-07-16 14:54:43:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2024-07-16 15:08:44:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.2973
2024-07-16 15:12:27:INFO:VAL-(cmcm) >>
2024-07-16 15:12:27:INFO:M: >>  acc: 0.7414  weight_F1: 0.7396 
2024-07-16 15:12:31:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2024-07-16 15:26:11:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.2898
2024-07-16 15:29:54:INFO:VAL-(cmcm) >>
2024-07-16 15:29:54:INFO:M: >>  acc: 0.7353  weight_F1: 0.7260 
2024-07-16 15:43:24:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.2825
2024-07-16 15:47:07:INFO:VAL-(cmcm) >>
2024-07-16 15:47:07:INFO:M: >>  acc: 0.7317  weight_F1: 0.7248 
2024-07-16 16:00:45:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.2782
2024-07-16 16:04:28:INFO:VAL-(cmcm) >>
2024-07-16 16:04:28:INFO:M: >>  acc: 0.7374  weight_F1: 0.7359 
2024-07-16 16:18:17:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 0.2737
2024-07-16 16:22:00:INFO:VAL-(cmcm) >>
2024-07-16 16:22:00:INFO:M: >>  acc: 0.7433  weight_F1: 0.7390 
2024-07-16 16:35:58:INFO:TRAIN-(cmcm) (5/14/4)>> loss: 0.2667
2024-07-16 16:39:41:INFO:VAL-(cmcm) >>
2024-07-16 16:39:41:INFO:M: >>  acc: 0.7369  weight_F1: 0.7326 
2024-07-16 16:53:29:INFO:TRAIN-(cmcm) (6/15/4)>> loss: 0.2623
2024-07-16 16:57:12:INFO:VAL-(cmcm) >>
2024-07-16 16:57:12:INFO:M: >>  acc: 0.7449  weight_F1: 0.7451 
2024-07-16 16:57:17:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-cherma-classification.pth.
2024-07-16 17:11:08:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.2580
2024-07-16 17:13:58:INFO:Start running cmcm...
2024-07-16 17:13:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-16 17:13:58:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-16 17:13:58:INFO:Let's use the GPU 1 !
2024-07-16 17:13:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:13:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121238 HTTP/1.1" 200 280
2024-07-16 17:13:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:13:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:14:00:INFO:train samples: (1284,)
2024-07-16 17:14:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:14:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121241 HTTP/1.1" 200 280
2024-07-16 17:14:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:14:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:14:03:INFO:valid samples: (229,)
2024-07-16 17:14:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:14:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121243 HTTP/1.1" 200 280
2024-07-16 17:14:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:14:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:14:05:INFO:test samples: (686,)
2024-07-16 17:14:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:14:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121246 HTTP/1.1" 200 280
2024-07-16 17:14:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:14:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:14:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:14:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121255 HTTP/1.1" 200 280
2024-07-16 17:14:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:14:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:14:19:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-16 17:14:19:INFO:Init labels...
2024-07-16 17:14:19:INFO:Start training...
2024-07-16 17:14:52:INFO:VAL-(cmcm) >>
2024-07-16 17:14:52:INFO:M: >>  acc: 0.7440  weight_F1: 0.7388 
2024-07-16 17:16:02:INFO:Start running cmcm...
2024-07-16 17:16:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-16 17:16:02:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-16 17:16:02:INFO:Let's use the GPU 1 !
2024-07-16 17:16:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:16:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121363 HTTP/1.1" 200 280
2024-07-16 17:16:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:16:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:16:05:INFO:train samples: (1284,)
2024-07-16 17:16:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:16:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121366 HTTP/1.1" 200 280
2024-07-16 17:16:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:16:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:16:07:INFO:valid samples: (229,)
2024-07-16 17:16:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:16:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121368 HTTP/1.1" 200 280
2024-07-16 17:16:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:16:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:16:09:INFO:test samples: (686,)
2024-07-16 17:16:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:16:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121370 HTTP/1.1" 200 280
2024-07-16 17:16:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:16:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:16:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 17:16:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721121380 HTTP/1.1" 200 280
2024-07-16 17:16:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 17:16:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 17:16:24:INFO:trainable params: 2590732 || all params: 6246174732 || trainable%: 0.04147709776236852
2024-07-16 17:16:24:INFO:Init labels...
2024-07-16 17:16:24:INFO:Start training...
2024-07-16 17:28:47:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 0.2538
2024-07-16 17:32:30:INFO:VAL-(cmcm) >>
2024-07-16 17:32:30:INFO:M: >>  acc: 0.7407  weight_F1: 0.7390 
2024-07-16 17:46:26:INFO:TRAIN-(cmcm) (3/18/4)>> loss: 0.2493
2024-07-16 17:50:09:INFO:VAL-(cmcm) >>
2024-07-16 17:50:09:INFO:M: >>  acc: 0.7409  weight_F1: 0.7386 
2024-07-16 18:03:33:INFO:TRAIN-(cmcm) (4/19/4)>> loss: 0.2458
2024-07-16 18:07:17:INFO:VAL-(cmcm) >>
2024-07-16 18:07:17:INFO:M: >>  acc: 0.7440  weight_F1: 0.7416 
2024-07-16 18:20:42:INFO:TRAIN-(cmcm) (5/20/4)>> loss: 0.2413
2024-07-16 18:24:26:INFO:VAL-(cmcm) >>
2024-07-16 18:24:26:INFO:M: >>  acc: 0.7430  weight_F1: 0.7397 
2024-07-16 18:37:51:INFO:TRAIN-(cmcm) (6/21/4)>> loss: 0.2376
2024-07-16 18:41:34:INFO:VAL-(cmcm) >>
2024-07-16 18:41:34:INFO:M: >>  acc: 0.7416  weight_F1: 0.7389 
2024-07-16 18:55:31:INFO:TRAIN-(cmcm) (7/22/4)>> loss: 0.2341
2024-07-16 18:59:14:INFO:VAL-(cmcm) >>
2024-07-16 18:59:14:INFO:M: >>  acc: 0.7237  weight_F1: 0.7215 
2024-07-16 19:13:13:INFO:TRAIN-(cmcm) (8/23/4)>> loss: 0.2309
2024-07-16 19:16:57:INFO:VAL-(cmcm) >>
2024-07-16 19:16:57:INFO:M: >>  acc: 0.7228  weight_F1: 0.7198 
2024-07-16 19:20:41:INFO:TEST-(cmcm) >>
2024-07-16 19:20:41:INFO:M: >>  acc: 0.7345  weight_F1: 0.7344 
2024-07-16 19:20:41:INFO:Results are added to results/results/cherma-classification-30.csv...
2024-07-16 19:20:41:INFO:Start running cmcm...
2024-07-16 19:20:41:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 5555}>
2024-07-16 19:20:41:INFO:Let's use the GPU 1 !
2024-07-16 19:34:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 19:34:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721129693 HTTP/1.1" 200 280
2024-07-16 19:34:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 19:34:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 19:35:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 19:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721129714 HTTP/1.1" 200 280
2024-07-16 19:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 19:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 19:36:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 19:36:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721129765 HTTP/1.1" 200 280
2024-07-16 19:36:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 19:36:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 19:36:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 19:36:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721129767 HTTP/1.1" 200 280
2024-07-16 19:36:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 19:36:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 19:36:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 19:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721129775 HTTP/1.1" 200 280
2024-07-16 19:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 19:36:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 19:36:17:INFO:trainable params: 2842380 || all params: 6246426380 || trainable%: 0.04550409829692093
2024-07-16 19:36:17:INFO:Init labels...
2024-07-16 19:36:17:INFO:Start training...
2024-07-16 19:50:02:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.0180
2024-07-16 19:53:46:INFO:VAL-(cmcm) >>
2024-07-16 19:53:46:INFO:M: >>  acc: 0.4169  weight_F1: 0.3585 
2024-07-16 19:53:51:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2024-07-16 20:07:35:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.6527
2024-07-16 20:11:18:INFO:VAL-(cmcm) >>
2024-07-16 20:11:18:INFO:M: >>  acc: 0.4879  weight_F1: 0.4355 
2024-07-16 20:11:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2024-07-16 20:24:51:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.4464
2024-07-16 20:28:33:INFO:VAL-(cmcm) >>
2024-07-16 20:28:33:INFO:M: >>  acc: 0.6683  weight_F1: 0.6622 
2024-07-16 20:28:38:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2024-07-16 20:42:36:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.3649
2024-07-16 20:46:19:INFO:VAL-(cmcm) >>
2024-07-16 20:46:19:INFO:M: >>  acc: 0.7090  weight_F1: 0.6969 
2024-07-16 20:46:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2024-07-16 21:00:23:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.3406
2024-07-16 21:04:06:INFO:VAL-(cmcm) >>
2024-07-16 21:04:06:INFO:M: >>  acc: 0.6921  weight_F1: 0.6854 
2024-07-16 21:17:38:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.3224
2024-07-16 21:21:21:INFO:VAL-(cmcm) >>
2024-07-16 21:21:21:INFO:M: >>  acc: 0.7190  weight_F1: 0.7148 
2024-07-16 21:21:25:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-cherma-classification.pth.
2024-07-16 21:34:52:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.3119
2024-07-16 21:38:34:INFO:VAL-(cmcm) >>
2024-07-16 21:38:34:INFO:M: >>  acc: 0.7379  weight_F1: 0.7362 
2024-07-16 21:38:39:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-cherma-classification.pth.
2024-07-16 21:52:05:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.3021
2024-07-16 21:55:48:INFO:VAL-(cmcm) >>
2024-07-16 21:55:48:INFO:M: >>  acc: 0.7454  weight_F1: 0.7423 
2024-07-16 21:55:52:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2024-07-16 22:09:23:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.2951
2024-07-16 22:13:09:INFO:VAL-(cmcm) >>
2024-07-16 22:13:09:INFO:M: >>  acc: 0.7456  weight_F1: 0.7412 
2024-07-16 22:27:27:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.2884
2024-07-16 22:31:13:INFO:VAL-(cmcm) >>
2024-07-16 22:31:13:INFO:M: >>  acc: 0.7501  weight_F1: 0.7457 
2024-07-16 22:31:19:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-cherma-classification.pth.
2024-07-16 22:45:31:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.2813
2024-07-16 22:49:16:INFO:VAL-(cmcm) >>
2024-07-16 22:49:16:INFO:M: >>  acc: 0.7510  weight_F1: 0.7460 
2024-07-16 22:49:21:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-cherma-classification.pth.
2024-07-16 23:03:40:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.2768
2024-07-16 23:07:25:INFO:VAL-(cmcm) >>
2024-07-16 23:07:25:INFO:M: >>  acc: 0.7508  weight_F1: 0.7470 
2024-07-16 23:07:29:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-cherma-classification.pth.
2024-07-16 23:21:52:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.2708
2024-07-16 23:25:36:INFO:VAL-(cmcm) >>
2024-07-16 23:25:36:INFO:M: >>  acc: 0.7409  weight_F1: 0.7402 
2024-07-16 23:31:10:INFO:Start running cmcm...
2024-07-16 23:31:10:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-07-16 23:31:10:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-16 23:31:10:INFO:Let's use the GPU 1 !
2024-07-16 23:31:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 23:31:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721143873 HTTP/1.1" 200 280
2024-07-16 23:31:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 23:31:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 23:31:14:INFO:train samples: (2722,)
2024-07-16 23:31:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 23:31:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721143877 HTTP/1.1" 200 280
2024-07-16 23:31:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 23:31:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 23:31:18:INFO:valid samples: (647,)
2024-07-16 23:31:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 23:31:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721143880 HTTP/1.1" 200 280
2024-07-16 23:31:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 23:31:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 23:31:21:INFO:test samples: (1034,)
2024-07-16 23:31:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 23:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721143882 HTTP/1.1" 200 280
2024-07-16 23:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 23:31:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 23:31:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-16 23:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721143893 HTTP/1.1" 200 280
2024-07-16 23:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-16 23:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-16 23:31:37:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-16 23:31:37:INFO:Init labels...
2024-07-16 23:31:37:INFO:Start training...
2024-07-16 23:33:27:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.2340
2024-07-16 23:34:06:INFO:VAL-(cmcm) >>
2024-07-16 23:34:06:INFO:M: >>  Mult_acc_2: 0.7465  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.6940  Mult_acc_5: 0.4189  F1_score: 0.7497  MAE: 0.4391  Corr: 0.6046  R_squre: 0.0924 
2024-07-16 23:34:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:36:04:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.4890
2024-07-16 23:36:41:INFO:VAL-(cmcm) >>
2024-07-16 23:36:41:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7326  Mult_acc_5: 0.4482  F1_score: 0.7840  MAE: 0.3903  Corr: 0.5832  R_squre: 0.1342 
2024-07-16 23:36:47:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:38:39:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.4024
2024-07-16 23:39:17:INFO:VAL-(cmcm) >>
2024-07-16 23:39:17:INFO:M: >>  Mult_acc_2: 0.7280  Mult_acc_2_weak: 0.6314  Mult_acc_3: 0.6986  Mult_acc_5: 0.4606  F1_score: 0.7291  MAE: 0.4079  Corr: 0.5727  R_squre: 0.0482 
2024-07-16 23:40:14:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.2656
2024-07-16 23:41:06:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.3973
2024-07-16 23:41:44:INFO:VAL-(cmcm) >>
2024-07-16 23:41:44:INFO:M: >>  Mult_acc_2: 0.7527  Mult_acc_2_weak: 0.6510  Mult_acc_3: 0.7048  Mult_acc_5: 0.4560  F1_score: 0.7552  MAE: 0.3799  Corr: 0.6083  R_squre: 0.1636 
2024-07-16 23:41:50:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:43:39:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.3936
2024-07-16 23:44:05:INFO:VAL-(cmcm) >>
2024-07-16 23:44:05:INFO:M: >>  acc: 0.7381  weight_F1: 0.7375 
2024-07-16 23:44:17:INFO:VAL-(cmcm) >>
2024-07-16 23:44:17:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.7233  Mult_acc_5: 0.4730  F1_score: 0.7725  MAE: 0.3726  Corr: 0.6144  R_squre: 0.1945 
2024-07-16 23:44:23:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:46:13:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.3899
2024-07-16 23:46:52:INFO:VAL-(cmcm) >>
2024-07-16 23:46:52:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7372  Mult_acc_5: 0.4791  F1_score: 0.7863  MAE: 0.3594  Corr: 0.6358  R_squre: 0.2636 
2024-07-16 23:46:58:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:48:48:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.3894
2024-07-16 23:49:27:INFO:VAL-(cmcm) >>
2024-07-16 23:49:27:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7264  Mult_acc_5: 0.4745  F1_score: 0.7787  MAE: 0.3674  Corr: 0.6286  R_squre: 0.2710 
2024-07-16 23:51:16:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.3899
2024-07-16 23:51:54:INFO:VAL-(cmcm) >>
2024-07-16 23:51:54:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7573  Mult_acc_5: 0.4791  F1_score: 0.8112  MAE: 0.3552  Corr: 0.6428  R_squre: 0.2361 
2024-07-16 23:52:01:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-16 23:53:52:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.3805
2024-07-16 23:54:31:INFO:VAL-(cmcm) >>
2024-07-16 23:54:31:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7187  Mult_acc_5: 0.4621  F1_score: 0.7723  MAE: 0.3873  Corr: 0.6338  R_squre: 0.2130 
2024-07-16 23:56:20:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.3800
2024-07-16 23:56:58:INFO:VAL-(cmcm) >>
2024-07-16 23:56:58:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7372  Mult_acc_5: 0.4838  F1_score: 0.7786  MAE: 0.3666  Corr: 0.6421  R_squre: 0.2532 
2024-07-16 23:58:49:INFO:TRAIN-(cmcm) (3/11/1)>> loss: 0.3794
2024-07-16 23:58:53:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.2607
2024-07-16 23:59:28:INFO:VAL-(cmcm) >>
2024-07-16 23:59:28:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7094  Mult_acc_5: 0.4590  F1_score: 0.8109  MAE: 0.3510  Corr: 0.6714  R_squre: 0.3788 
2024-07-16 23:59:34:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:01:25:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.3776
2024-07-17 00:02:04:INFO:VAL-(cmcm) >>
2024-07-17 00:02:04:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7403  Mult_acc_5: 0.4745  F1_score: 0.8188  MAE: 0.3266  Corr: 0.6769  R_squre: 0.4289 
2024-07-17 00:02:10:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:02:45:INFO:VAL-(cmcm) >>
2024-07-17 00:02:45:INFO:M: >>  acc: 0.7465  weight_F1: 0.7444 
2024-07-17 00:04:00:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.3752
2024-07-17 00:04:39:INFO:VAL-(cmcm) >>
2024-07-17 00:04:39:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7543  Mult_acc_5: 0.4822  F1_score: 0.7909  MAE: 0.3609  Corr: 0.6514  R_squre: 0.2724 
2024-07-17 00:06:29:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.3726
2024-07-17 00:07:08:INFO:VAL-(cmcm) >>
2024-07-17 00:07:08:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7187  Mult_acc_5: 0.4560  F1_score: 0.8166  MAE: 0.3385  Corr: 0.6733  R_squre: 0.4128 
2024-07-17 00:08:58:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.3718
2024-07-17 00:09:38:INFO:VAL-(cmcm) >>
2024-07-17 00:09:38:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7419  Mult_acc_5: 0.4730  F1_score: 0.7815  MAE: 0.3725  Corr: 0.6645  R_squre: 0.2361 
2024-07-17 00:11:28:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.3703
2024-07-17 00:12:07:INFO:VAL-(cmcm) >>
2024-07-17 00:12:07:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7589  Mult_acc_5: 0.4791  F1_score: 0.8190  MAE: 0.3442  Corr: 0.6660  R_squre: 0.3663 
2024-07-17 00:13:57:INFO:TRAIN-(cmcm) (5/17/1)>> loss: 0.3689
2024-07-17 00:14:36:INFO:VAL-(cmcm) >>
2024-07-17 00:14:36:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.7512  Mult_acc_5: 0.4436  F1_score: 0.7894  MAE: 0.3685  Corr: 0.6526  R_squre: 0.2157 
2024-07-17 00:16:26:INFO:TRAIN-(cmcm) (6/18/1)>> loss: 0.3682
2024-07-17 00:17:04:INFO:VAL-(cmcm) >>
2024-07-17 00:17:04:INFO:M: >>  Mult_acc_2: 0.7929  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7543  Mult_acc_5: 0.4467  F1_score: 0.7953  MAE: 0.3662  Corr: 0.6530  R_squre: 0.2420 
2024-07-17 00:17:33:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.2553
2024-07-17 00:18:53:INFO:TRAIN-(cmcm) (7/19/1)>> loss: 0.3650
2024-07-17 00:19:33:INFO:VAL-(cmcm) >>
2024-07-17 00:19:33:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7635  Mult_acc_5: 0.4992  F1_score: 0.8224  MAE: 0.3289  Corr: 0.6785  R_squre: 0.3742 
2024-07-17 00:21:21:INFO:TRAIN-(cmcm) (8/20/1)>> loss: 0.3635
2024-07-17 00:21:24:INFO:VAL-(cmcm) >>
2024-07-17 00:21:24:INFO:M: >>  acc: 0.7442  weight_F1: 0.7421 
2024-07-17 00:22:00:INFO:VAL-(cmcm) >>
2024-07-17 00:22:00:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.7512  Mult_acc_5: 0.4776  F1_score: 0.7894  MAE: 0.3612  Corr: 0.6701  R_squre: 0.3181 
2024-07-17 00:23:50:INFO:TRAIN-(cmcm) (9/21/1)>> loss: 0.3638
2024-07-17 00:24:28:INFO:VAL-(cmcm) >>
2024-07-17 00:24:28:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7635  Mult_acc_5: 0.4977  F1_score: 0.8073  MAE: 0.3406  Corr: 0.6770  R_squre: 0.3496 
2024-07-17 00:26:18:INFO:TRAIN-(cmcm) (10/22/1)>> loss: 0.3617
2024-07-17 00:26:57:INFO:VAL-(cmcm) >>
2024-07-17 00:26:57:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7465  Mult_acc_5: 0.4915  F1_score: 0.7818  MAE: 0.3703  Corr: 0.6574  R_squre: 0.2541 
2024-07-17 00:27:58:INFO:TEST-(cmcm) >>
2024-07-17 00:27:58:INFO:M: >>  Mult_acc_2: 0.7747  Mult_acc_2_weak: 0.6936  Mult_acc_3: 0.7195  Mult_acc_5: 0.4874  F1_score: 0.7719  MAE: 0.3433  Corr: 0.6331  R_squre: 0.3338 
2024-07-17 00:28:00:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 00:28:00:INFO:Start running cmcm...
2024-07-17 00:28:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 2222}>
2024-07-17 00:28:00:INFO:Let's use the GPU 1 !
2024-07-17 00:28:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 00:28:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721147282 HTTP/1.1" 200 280
2024-07-17 00:28:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 00:28:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 00:28:03:INFO:train samples: (2722,)
2024-07-17 00:28:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 00:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721147286 HTTP/1.1" 200 280
2024-07-17 00:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 00:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 00:28:07:INFO:valid samples: (647,)
2024-07-17 00:28:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 00:28:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721147290 HTTP/1.1" 200 280
2024-07-17 00:28:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 00:28:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 00:28:11:INFO:test samples: (1034,)
2024-07-17 00:28:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 00:28:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721147292 HTTP/1.1" 200 280
2024-07-17 00:28:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 00:28:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 00:28:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 00:28:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721147301 HTTP/1.1" 200 280
2024-07-17 00:28:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 00:28:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 00:28:23:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 00:28:23:INFO:Init labels...
2024-07-17 00:28:23:INFO:Start training...
2024-07-17 00:30:12:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.6037
2024-07-17 00:30:50:INFO:VAL-(cmcm) >>
2024-07-17 00:30:50:INFO:M: >>  Mult_acc_2: 0.6306  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.2457  Mult_acc_5: 0.1654  F1_score: 0.5411  MAE: 0.4846  Corr: 0.3580  R_squre: 0.1181 
2024-07-17 00:30:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:32:45:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.5533
2024-07-17 00:33:24:INFO:VAL-(cmcm) >>
2024-07-17 00:33:24:INFO:M: >>  Mult_acc_2: 0.6352  Mult_acc_2_weak: 0.6627  Mult_acc_3: 0.2349  Mult_acc_5: 0.1515  F1_score: 0.5546  MAE: 0.4916  Corr: 0.3436  R_squre: 0.0974 
2024-07-17 00:35:13:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.1880
2024-07-17 00:35:52:INFO:VAL-(cmcm) >>
2024-07-17 00:35:52:INFO:M: >>  Mult_acc_2: 0.7218  Mult_acc_2_weak: 0.6510  Mult_acc_3: 0.5750  Mult_acc_5: 0.3416  F1_score: 0.7237  MAE: 0.4396  Corr: 0.5518  R_squre: 0.2079 
2024-07-17 00:35:58:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:36:12:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 0.2511
2024-07-17 00:37:47:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.5348
2024-07-17 00:38:25:INFO:VAL-(cmcm) >>
2024-07-17 00:38:25:INFO:M: >>  Mult_acc_2: 0.7543  Mult_acc_2_weak: 0.6510  Mult_acc_3: 0.7094  Mult_acc_5: 0.4621  F1_score: 0.7574  MAE: 0.3796  Corr: 0.5923  R_squre: 0.2022 
2024-07-17 00:38:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:40:01:INFO:VAL-(cmcm) >>
2024-07-17 00:40:01:INFO:M: >>  acc: 0.7475  weight_F1: 0.7456 
2024-07-17 00:40:21:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.4242
2024-07-17 00:40:59:INFO:VAL-(cmcm) >>
2024-07-17 00:40:59:INFO:M: >>  Mult_acc_2: 0.7728  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7295  Mult_acc_5: 0.4714  F1_score: 0.7754  MAE: 0.3751  Corr: 0.5872  R_squre: 0.2153 
2024-07-17 00:41:05:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:42:57:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.4058
2024-07-17 00:43:35:INFO:VAL-(cmcm) >>
2024-07-17 00:43:35:INFO:M: >>  Mult_acc_2: 0.7465  Mult_acc_2_weak: 0.6196  Mult_acc_3: 0.7141  Mult_acc_5: 0.4606  F1_score: 0.7482  MAE: 0.3836  Corr: 0.6091  R_squre: 0.1579 
2024-07-17 00:45:23:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.3997
2024-07-17 00:46:02:INFO:VAL-(cmcm) >>
2024-07-17 00:46:02:INFO:M: >>  Mult_acc_2: 0.7682  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.7326  Mult_acc_5: 0.4699  F1_score: 0.7710  MAE: 0.3726  Corr: 0.6155  R_squre: 0.2079 
2024-07-17 00:46:07:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:48:01:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.3951
2024-07-17 00:48:39:INFO:VAL-(cmcm) >>
2024-07-17 00:48:39:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7589  Mult_acc_5: 0.4900  F1_score: 0.8037  MAE: 0.3550  Corr: 0.6246  R_squre: 0.2640 
2024-07-17 00:48:45:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:50:37:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.3922
2024-07-17 00:51:16:INFO:VAL-(cmcm) >>
2024-07-17 00:51:16:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7620  Mult_acc_5: 0.4915  F1_score: 0.8094  MAE: 0.3526  Corr: 0.6309  R_squre: 0.2746 
2024-07-17 00:51:22:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:53:13:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.3886
2024-07-17 00:53:52:INFO:VAL-(cmcm) >>
2024-07-17 00:53:52:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7342  Mult_acc_5: 0.4683  F1_score: 0.7787  MAE: 0.3725  Corr: 0.6060  R_squre: 0.1875 
2024-07-17 00:54:53:INFO:TRAIN-(cmcm) (6/18/5)>> loss: 0.2456
2024-07-17 00:55:41:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.3872
2024-07-17 00:56:20:INFO:VAL-(cmcm) >>
2024-07-17 00:56:20:INFO:M: >>  Mult_acc_2: 0.7929  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7496  Mult_acc_5: 0.4946  F1_score: 0.7954  MAE: 0.3470  Corr: 0.6421  R_squre: 0.2889 
2024-07-17 00:56:26:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 00:58:15:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.3821
2024-07-17 00:58:42:INFO:VAL-(cmcm) >>
2024-07-17 00:58:42:INFO:M: >>  acc: 0.7454  weight_F1: 0.7414 
2024-07-17 00:58:55:INFO:VAL-(cmcm) >>
2024-07-17 00:58:55:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7342  Mult_acc_5: 0.4822  F1_score: 0.7877  MAE: 0.3411  Corr: 0.6521  R_squre: 0.3261 
2024-07-17 00:59:01:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:00:52:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.3792
2024-07-17 01:01:31:INFO:VAL-(cmcm) >>
2024-07-17 01:01:31:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7682  Mult_acc_5: 0.5100  F1_score: 0.8181  MAE: 0.3329  Corr: 0.6607  R_squre: 0.3642 
2024-07-17 01:01:37:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:03:28:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.3774
2024-07-17 01:04:06:INFO:VAL-(cmcm) >>
2024-07-17 01:04:06:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7589  Mult_acc_5: 0.4961  F1_score: 0.8076  MAE: 0.3351  Corr: 0.6788  R_squre: 0.3563 
2024-07-17 01:05:57:INFO:TRAIN-(cmcm) (2/15/2)>> loss: 0.3637
2024-07-17 01:06:36:INFO:VAL-(cmcm) >>
2024-07-17 01:06:36:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7790  Mult_acc_5: 0.5085  F1_score: 0.8364  MAE: 0.3286  Corr: 0.6698  R_squre: 0.3634 
2024-07-17 01:06:42:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:08:34:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.3590
2024-07-17 01:09:12:INFO:VAL-(cmcm) >>
2024-07-17 01:09:12:INFO:M: >>  Mult_acc_2: 0.8485  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7883  Mult_acc_5: 0.5116  F1_score: 0.8479  MAE: 0.3083  Corr: 0.7066  R_squre: 0.4551 
2024-07-17 01:09:18:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:11:10:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.3529
2024-07-17 01:11:48:INFO:VAL-(cmcm) >>
2024-07-17 01:11:48:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7805  Mult_acc_5: 0.5178  F1_score: 0.8320  MAE: 0.3233  Corr: 0.6855  R_squre: 0.3797 
2024-07-17 01:13:28:INFO:TRAIN-(cmcm) (7/19/5)>> loss: 0.2418
2024-07-17 01:13:39:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.3497
2024-07-17 01:14:18:INFO:VAL-(cmcm) >>
2024-07-17 01:14:18:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7774  Mult_acc_5: 0.5008  F1_score: 0.8404  MAE: 0.3141  Corr: 0.7129  R_squre: 0.4461 
2024-07-17 01:16:04:INFO:TRAIN-(cmcm) (3/19/2)>> loss: 0.3454
2024-07-17 01:16:44:INFO:VAL-(cmcm) >>
2024-07-17 01:16:44:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7635  Mult_acc_5: 0.4961  F1_score: 0.8254  MAE: 0.3318  Corr: 0.6812  R_squre: 0.3621 
2024-07-17 01:17:17:INFO:VAL-(cmcm) >>
2024-07-17 01:17:17:INFO:M: >>  acc: 0.7479  weight_F1: 0.7471 
2024-07-17 01:17:22:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-cherma-classification.pth.
2024-07-17 01:18:32:INFO:TRAIN-(cmcm) (4/20/2)>> loss: 0.3432
2024-07-17 01:19:10:INFO:VAL-(cmcm) >>
2024-07-17 01:19:10:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7496  Mult_acc_5: 0.5023  F1_score: 0.8016  MAE: 0.3433  Corr: 0.6508  R_squre: 0.2803 
2024-07-17 01:21:00:INFO:TRAIN-(cmcm) (5/21/2)>> loss: 0.3419
2024-07-17 01:21:38:INFO:VAL-(cmcm) >>
2024-07-17 01:21:38:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7743  Mult_acc_5: 0.5131  F1_score: 0.8345  MAE: 0.3196  Corr: 0.6924  R_squre: 0.3919 
2024-07-17 01:23:28:INFO:TRAIN-(cmcm) (6/22/2)>> loss: 0.3377
2024-07-17 01:24:07:INFO:VAL-(cmcm) >>
2024-07-17 01:24:07:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7527  Mult_acc_5: 0.5240  F1_score: 0.8047  MAE: 0.3391  Corr: 0.6560  R_squre: 0.2830 
2024-07-17 01:25:56:INFO:TRAIN-(cmcm) (7/23/2)>> loss: 0.3338
2024-07-17 01:26:35:INFO:VAL-(cmcm) >>
2024-07-17 01:26:35:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7465  Mult_acc_5: 0.4807  F1_score: 0.8277  MAE: 0.3215  Corr: 0.6748  R_squre: 0.3796 
2024-07-17 01:28:25:INFO:TRAIN-(cmcm) (8/24/2)>> loss: 0.3309
2024-07-17 01:29:04:INFO:VAL-(cmcm) >>
2024-07-17 01:29:04:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7759  Mult_acc_5: 0.5147  F1_score: 0.8357  MAE: 0.3206  Corr: 0.6886  R_squre: 0.3844 
2024-07-17 01:30:54:INFO:TRAIN-(cmcm) (9/25/2)>> loss: 0.3287
2024-07-17 01:31:32:INFO:VAL-(cmcm) >>
2024-07-17 01:31:32:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7249  Mult_acc_5: 0.4884  F1_score: 0.8096  MAE: 0.3250  Corr: 0.6775  R_squre: 0.3741 
2024-07-17 01:32:12:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.2371
2024-07-17 01:33:21:INFO:TRAIN-(cmcm) (10/26/2)>> loss: 0.3264
2024-07-17 01:34:00:INFO:VAL-(cmcm) >>
2024-07-17 01:34:00:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7882  Mult_acc_3: 0.7682  Mult_acc_5: 0.5270  F1_score: 0.8427  MAE: 0.2991  Corr: 0.7145  R_squre: 0.4501 
2024-07-17 01:34:06:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:35:55:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.3231
2024-07-17 01:36:00:INFO:VAL-(cmcm) >>
2024-07-17 01:36:00:INFO:M: >>  acc: 0.7383  weight_F1: 0.7361 
2024-07-17 01:36:33:INFO:VAL-(cmcm) >>
2024-07-17 01:36:33:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7558  Mult_acc_5: 0.4930  F1_score: 0.8167  MAE: 0.3352  Corr: 0.6601  R_squre: 0.3226 
2024-07-17 01:38:23:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.3220
2024-07-17 01:39:02:INFO:VAL-(cmcm) >>
2024-07-17 01:39:02:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7527  Mult_acc_5: 0.5039  F1_score: 0.8182  MAE: 0.3289  Corr: 0.6675  R_squre: 0.3351 
2024-07-17 01:40:51:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.3189
2024-07-17 01:41:29:INFO:VAL-(cmcm) >>
2024-07-17 01:41:29:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7620  Mult_acc_5: 0.5270  F1_score: 0.8301  MAE: 0.3028  Corr: 0.7105  R_squre: 0.4396 
2024-07-17 01:43:20:INFO:TRAIN-(cmcm) (4/30/2)>> loss: 0.3152
2024-07-17 01:43:57:INFO:VAL-(cmcm) >>
2024-07-17 01:43:57:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7496  Mult_acc_5: 0.5054  F1_score: 0.8161  MAE: 0.3119  Corr: 0.6864  R_squre: 0.4015 
2024-07-17 01:45:47:INFO:TRAIN-(cmcm) (5/31/2)>> loss: 0.3150
2024-07-17 01:46:26:INFO:VAL-(cmcm) >>
2024-07-17 01:46:26:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7450  Mult_acc_5: 0.5209  F1_score: 0.8202  MAE: 0.3097  Corr: 0.7044  R_squre: 0.4323 
2024-07-17 01:48:15:INFO:TRAIN-(cmcm) (6/32/2)>> loss: 0.3112
2024-07-17 01:48:54:INFO:VAL-(cmcm) >>
2024-07-17 01:48:54:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7512  Mult_acc_5: 0.5116  F1_score: 0.8349  MAE: 0.3059  Corr: 0.7121  R_squre: 0.4654 
2024-07-17 01:50:43:INFO:TRAIN-(cmcm) (7/33/2)>> loss: 0.3086
2024-07-17 01:50:49:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.2330
2024-07-17 01:51:23:INFO:VAL-(cmcm) >>
2024-07-17 01:51:23:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7713  Mult_acc_5: 0.5209  F1_score: 0.8327  MAE: 0.3046  Corr: 0.7020  R_squre: 0.4203 
2024-07-17 01:53:11:INFO:TRAIN-(cmcm) (8/34/2)>> loss: 0.3056
2024-07-17 01:53:50:INFO:VAL-(cmcm) >>
2024-07-17 01:53:50:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7759  Mult_acc_5: 0.5332  F1_score: 0.8377  MAE: 0.2949  Corr: 0.7271  R_squre: 0.4930 
2024-07-17 01:53:56:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 01:54:39:INFO:VAL-(cmcm) >>
2024-07-17 01:54:39:INFO:M: >>  acc: 0.7456  weight_F1: 0.7410 
2024-07-17 01:55:47:INFO:TRAIN-(cmcm) (1/35/2)>> loss: 0.3030
2024-07-17 01:56:25:INFO:VAL-(cmcm) >>
2024-07-17 01:56:25:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7651  Mult_acc_5: 0.5209  F1_score: 0.8282  MAE: 0.3046  Corr: 0.7152  R_squre: 0.4616 
2024-07-17 01:58:14:INFO:TRAIN-(cmcm) (2/36/2)>> loss: 0.3005
2024-07-17 01:58:52:INFO:VAL-(cmcm) >>
2024-07-17 01:58:52:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7419  Mult_acc_5: 0.4930  F1_score: 0.8205  MAE: 0.3060  Corr: 0.7006  R_squre: 0.4428 
2024-07-17 02:00:40:INFO:TRAIN-(cmcm) (3/37/2)>> loss: 0.2994
2024-07-17 02:01:17:INFO:VAL-(cmcm) >>
2024-07-17 02:01:17:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7558  Mult_acc_5: 0.5039  F1_score: 0.8222  MAE: 0.3014  Corr: 0.7152  R_squre: 0.4595 
2024-07-17 02:03:07:INFO:TRAIN-(cmcm) (4/38/2)>> loss: 0.2961
2024-07-17 02:03:47:INFO:VAL-(cmcm) >>
2024-07-17 02:03:47:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7403  Mult_acc_5: 0.5193  F1_score: 0.8155  MAE: 0.3032  Corr: 0.7075  R_squre: 0.4449 
2024-07-17 02:05:37:INFO:TRAIN-(cmcm) (5/39/2)>> loss: 0.2937
2024-07-17 02:06:16:INFO:VAL-(cmcm) >>
2024-07-17 02:06:16:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.5162  F1_score: 0.8302  MAE: 0.2986  Corr: 0.7171  R_squre: 0.4825 
2024-07-17 02:08:06:INFO:TRAIN-(cmcm) (6/40/2)>> loss: 0.2913
2024-07-17 02:08:45:INFO:VAL-(cmcm) >>
2024-07-17 02:08:45:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7651  Mult_acc_5: 0.5410  F1_score: 0.8243  MAE: 0.3057  Corr: 0.7081  R_squre: 0.4375 
2024-07-17 02:09:32:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.2291
2024-07-17 02:10:37:INFO:TRAIN-(cmcm) (7/41/2)>> loss: 0.2882
2024-07-17 02:11:15:INFO:VAL-(cmcm) >>
2024-07-17 02:11:15:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7759  Mult_acc_5: 0.5317  F1_score: 0.8345  MAE: 0.2915  Corr: 0.7276  R_squre: 0.4908 
2024-07-17 02:11:22:INFO:Saving checkpoint at epoch 41 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 02:13:12:INFO:TRAIN-(cmcm) (1/42/2)>> loss: 0.2856
2024-07-17 02:13:23:INFO:VAL-(cmcm) >>
2024-07-17 02:13:23:INFO:M: >>  acc: 0.7453  weight_F1: 0.7418 
2024-07-17 02:13:51:INFO:VAL-(cmcm) >>
2024-07-17 02:13:51:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7573  Mult_acc_5: 0.5286  F1_score: 0.8210  MAE: 0.3029  Corr: 0.7064  R_squre: 0.4482 
2024-07-17 02:15:40:INFO:TRAIN-(cmcm) (2/43/2)>> loss: 0.2847
2024-07-17 02:16:17:INFO:VAL-(cmcm) >>
2024-07-17 02:16:17:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7604  Mult_acc_5: 0.5317  F1_score: 0.8249  MAE: 0.3032  Corr: 0.7045  R_squre: 0.4446 
2024-07-17 02:18:07:INFO:TRAIN-(cmcm) (3/44/2)>> loss: 0.2814
2024-07-17 02:18:46:INFO:VAL-(cmcm) >>
2024-07-17 02:18:46:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7620  Mult_acc_5: 0.5348  F1_score: 0.8335  MAE: 0.3022  Corr: 0.7130  R_squre: 0.4709 
2024-07-17 02:20:35:INFO:TRAIN-(cmcm) (4/45/2)>> loss: 0.2797
2024-07-17 02:21:14:INFO:VAL-(cmcm) >>
2024-07-17 02:21:14:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7589  Mult_acc_5: 0.5348  F1_score: 0.8292  MAE: 0.2930  Corr: 0.7252  R_squre: 0.4913 
2024-07-17 02:23:02:INFO:TRAIN-(cmcm) (5/46/2)>> loss: 0.2779
2024-07-17 02:23:40:INFO:VAL-(cmcm) >>
2024-07-17 02:23:40:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7527  Mult_acc_5: 0.5317  F1_score: 0.8234  MAE: 0.3057  Corr: 0.7030  R_squre: 0.4507 
2024-07-17 02:25:29:INFO:TRAIN-(cmcm) (6/47/2)>> loss: 0.2756
2024-07-17 02:26:08:INFO:VAL-(cmcm) >>
2024-07-17 02:26:08:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7635  Mult_acc_5: 0.5224  F1_score: 0.8295  MAE: 0.2977  Corr: 0.7154  R_squre: 0.4707 
2024-07-17 02:27:58:INFO:TRAIN-(cmcm) (7/48/2)>> loss: 0.2741
2024-07-17 02:28:09:INFO:TRAIN-(cmcm) (4/23/5)>> loss: 0.2249
2024-07-17 02:28:36:INFO:VAL-(cmcm) >>
2024-07-17 02:28:36:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7713  Mult_acc_5: 0.5301  F1_score: 0.8340  MAE: 0.3070  Corr: 0.7031  R_squre: 0.4307 
2024-07-17 02:30:24:INFO:TRAIN-(cmcm) (8/49/2)>> loss: 0.2702
2024-07-17 02:31:02:INFO:VAL-(cmcm) >>
2024-07-17 02:31:02:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7774  Mult_acc_5: 0.5301  F1_score: 0.8397  MAE: 0.2937  Corr: 0.7211  R_squre: 0.4855 
2024-07-17 02:31:58:INFO:VAL-(cmcm) >>
2024-07-17 02:31:58:INFO:M: >>  acc: 0.7475  weight_F1: 0.7458 
2024-07-17 02:32:53:INFO:TRAIN-(cmcm) (9/50/2)>> loss: 0.2668
2024-07-17 02:33:31:INFO:VAL-(cmcm) >>
2024-07-17 02:33:31:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7573  Mult_acc_5: 0.5178  F1_score: 0.8237  MAE: 0.3005  Corr: 0.7150  R_squre: 0.4556 
2024-07-17 02:35:20:INFO:TRAIN-(cmcm) (10/51/2)>> loss: 0.2672
2024-07-17 02:35:59:INFO:VAL-(cmcm) >>
2024-07-17 02:35:59:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7759  Mult_acc_5: 0.5394  F1_score: 0.8369  MAE: 0.2954  Corr: 0.7183  R_squre: 0.4848 
2024-07-17 02:37:01:INFO:TEST-(cmcm) >>
2024-07-17 02:37:01:INFO:M: >>  Mult_acc_2: 0.8230  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7747  Mult_acc_5: 0.5619  F1_score: 0.8236  MAE: 0.2928  Corr: 0.7100  R_squre: 0.4415 
2024-07-17 02:37:01:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 02:37:01:INFO:Start running cmcm...
2024-07-17 02:37:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 3333}>
2024-07-17 02:37:01:INFO:Let's use the GPU 1 !
2024-07-17 02:37:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 02:37:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721155023 HTTP/1.1" 200 280
2024-07-17 02:37:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 02:37:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 02:37:05:INFO:train samples: (2722,)
2024-07-17 02:37:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 02:37:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721155028 HTTP/1.1" 200 280
2024-07-17 02:37:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 02:37:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 02:37:09:INFO:valid samples: (647,)
2024-07-17 02:37:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 02:37:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721155031 HTTP/1.1" 200 280
2024-07-17 02:37:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 02:37:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 02:37:12:INFO:test samples: (1034,)
2024-07-17 02:37:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 02:37:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721155033 HTTP/1.1" 200 280
2024-07-17 02:37:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 02:37:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 02:37:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 02:37:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721155042 HTTP/1.1" 200 280
2024-07-17 02:37:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 02:37:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 02:37:24:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 02:37:25:INFO:Init labels...
2024-07-17 02:37:25:INFO:Start training...
2024-07-17 02:39:15:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.5717
2024-07-17 02:39:53:INFO:VAL-(cmcm) >>
2024-07-17 02:39:53:INFO:M: >>  Mult_acc_2: 0.6368  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.2087  Mult_acc_5: 0.1453  F1_score: 0.5505  MAE: 0.5018  Corr: 0.3151  R_squre: 0.0756 
2024-07-17 02:39:59:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 02:41:52:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.4816
2024-07-17 02:42:31:INFO:VAL-(cmcm) >>
2024-07-17 02:42:31:INFO:M: >>  Mult_acc_2: 0.6291  Mult_acc_2_weak: 0.6118  Mult_acc_3: 0.3076  Mult_acc_5: 0.1963  F1_score: 0.6141  MAE: 0.5068  Corr: 0.3219  R_squre: -0.0387 
2024-07-17 02:44:21:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.8617
2024-07-17 02:44:59:INFO:VAL-(cmcm) >>
2024-07-17 02:44:59:INFO:M: >>  Mult_acc_2: 0.7063  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.5750  Mult_acc_5: 0.3663  F1_score: 0.7099  MAE: 0.4287  Corr: 0.5072  R_squre: 0.1413 
2024-07-17 02:45:06:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 02:46:46:INFO:TRAIN-(cmcm) (5/24/5)>> loss: 0.2214
2024-07-17 02:46:57:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.6023
2024-07-17 02:47:36:INFO:VAL-(cmcm) >>
2024-07-17 02:47:36:INFO:M: >>  Mult_acc_2: 0.7913  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7094  Mult_acc_5: 0.4420  F1_score: 0.7904  MAE: 0.3666  Corr: 0.6204  R_squre: 0.3494 
2024-07-17 02:47:41:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 02:49:31:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5494
2024-07-17 02:50:10:INFO:VAL-(cmcm) >>
2024-07-17 02:50:10:INFO:M: >>  Mult_acc_2: 0.7898  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7233  Mult_acc_5: 0.4822  F1_score: 0.7908  MAE: 0.3547  Corr: 0.6403  R_squre: 0.3397 
2024-07-17 02:50:16:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 02:50:37:INFO:VAL-(cmcm) >>
2024-07-17 02:50:37:INFO:M: >>  acc: 0.7454  weight_F1: 0.7422 
2024-07-17 02:52:07:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.5148
2024-07-17 02:52:45:INFO:VAL-(cmcm) >>
2024-07-17 02:52:45:INFO:M: >>  Mult_acc_2: 0.6847  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.5533  Mult_acc_5: 0.3910  F1_score: 0.6150  MAE: 0.3796  Corr: 0.6339  R_squre: 0.3064 
2024-07-17 02:54:35:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.4135
2024-07-17 02:55:14:INFO:VAL-(cmcm) >>
2024-07-17 02:55:14:INFO:M: >>  Mult_acc_2: 0.6662  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.5255  Mult_acc_5: 0.3648  F1_score: 0.5811  MAE: 0.3818  Corr: 0.6342  R_squre: 0.3010 
2024-07-17 02:57:03:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.3860
2024-07-17 02:57:42:INFO:VAL-(cmcm) >>
2024-07-17 02:57:42:INFO:M: >>  Mult_acc_2: 0.7187  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.5379  Mult_acc_5: 0.3679  F1_score: 0.6736  MAE: 0.3672  Corr: 0.6192  R_squre: 0.3497 
2024-07-17 02:59:30:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.3796
2024-07-17 03:00:09:INFO:VAL-(cmcm) >>
2024-07-17 03:00:09:INFO:M: >>  Mult_acc_2: 0.7496  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6383  Mult_acc_5: 0.4374  F1_score: 0.7200  MAE: 0.3437  Corr: 0.6696  R_squre: 0.3745 
2024-07-17 03:00:15:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:02:06:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.3754
2024-07-17 03:02:45:INFO:VAL-(cmcm) >>
2024-07-17 03:02:45:INFO:M: >>  Mult_acc_2: 0.7388  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6059  Mult_acc_5: 0.4204  F1_score: 0.7010  MAE: 0.3496  Corr: 0.6638  R_squre: 0.3655 
2024-07-17 03:04:35:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.3716
2024-07-17 03:05:14:INFO:VAL-(cmcm) >>
2024-07-17 03:05:14:INFO:M: >>  Mult_acc_2: 0.7728  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6461  Mult_acc_5: 0.4405  F1_score: 0.7540  MAE: 0.3292  Corr: 0.6783  R_squre: 0.4157 
2024-07-17 03:05:19:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:05:27:INFO:TRAIN-(cmcm) (6/25/5)>> loss: 0.2183
2024-07-17 03:07:09:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.3690
2024-07-17 03:07:48:INFO:VAL-(cmcm) >>
2024-07-17 03:07:48:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6739  Mult_acc_5: 0.4560  F1_score: 0.7765  MAE: 0.3283  Corr: 0.6839  R_squre: 0.4159 
2024-07-17 03:07:54:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:09:19:INFO:VAL-(cmcm) >>
2024-07-17 03:09:19:INFO:M: >>  acc: 0.7399  weight_F1: 0.7371 
2024-07-17 03:09:43:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.3658
2024-07-17 03:10:21:INFO:VAL-(cmcm) >>
2024-07-17 03:10:21:INFO:M: >>  Mult_acc_2: 0.7635  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6507  Mult_acc_5: 0.4359  F1_score: 0.7410  MAE: 0.3357  Corr: 0.6748  R_squre: 0.4013 
2024-07-17 03:12:11:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.3633
2024-07-17 03:12:50:INFO:VAL-(cmcm) >>
2024-07-17 03:12:50:INFO:M: >>  Mult_acc_2: 0.7774  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6569  Mult_acc_5: 0.4359  F1_score: 0.7613  MAE: 0.3320  Corr: 0.6854  R_squre: 0.4112 
2024-07-17 03:14:39:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.3604
2024-07-17 03:15:17:INFO:VAL-(cmcm) >>
2024-07-17 03:15:17:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6662  Mult_acc_5: 0.4420  F1_score: 0.7688  MAE: 0.3292  Corr: 0.6884  R_squre: 0.4208 
2024-07-17 03:17:04:INFO:TRAIN-(cmcm) (4/16/3)>> loss: 0.3602
2024-07-17 03:17:42:INFO:VAL-(cmcm) >>
2024-07-17 03:17:42:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7249  Mult_acc_5: 0.4791  F1_score: 0.8122  MAE: 0.3172  Corr: 0.7037  R_squre: 0.4302 
2024-07-17 03:17:48:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:19:39:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.3574
2024-07-17 03:20:18:INFO:VAL-(cmcm) >>
2024-07-17 03:20:18:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7311  Mult_acc_5: 0.4838  F1_score: 0.8115  MAE: 0.3162  Corr: 0.7025  R_squre: 0.4235 
2024-07-17 03:20:23:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:22:14:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.3555
2024-07-17 03:22:53:INFO:VAL-(cmcm) >>
2024-07-17 03:22:53:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7156  Mult_acc_5: 0.4776  F1_score: 0.8135  MAE: 0.3150  Corr: 0.6882  R_squre: 0.4283 
2024-07-17 03:22:59:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:24:09:INFO:TRAIN-(cmcm) (7/26/5)>> loss: 0.2156
2024-07-17 03:24:49:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.3533
2024-07-17 03:25:28:INFO:VAL-(cmcm) >>
2024-07-17 03:25:28:INFO:M: >>  Mult_acc_2: 0.7898  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6692  Mult_acc_5: 0.4405  F1_score: 0.7776  MAE: 0.3206  Corr: 0.6893  R_squre: 0.4354 
2024-07-17 03:27:17:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.3525
2024-07-17 03:27:57:INFO:VAL-(cmcm) >>
2024-07-17 03:27:57:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.6986  Mult_acc_5: 0.4621  F1_score: 0.7878  MAE: 0.3221  Corr: 0.6994  R_squre: 0.4356 
2024-07-17 03:28:01:INFO:VAL-(cmcm) >>
2024-07-17 03:28:01:INFO:M: >>  acc: 0.7402  weight_F1: 0.7378 
2024-07-17 03:29:47:INFO:TRAIN-(cmcm) (3/21/3)>> loss: 0.3497
2024-07-17 03:30:26:INFO:VAL-(cmcm) >>
2024-07-17 03:30:26:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7187  Mult_acc_5: 0.4822  F1_score: 0.8046  MAE: 0.3212  Corr: 0.6912  R_squre: 0.4117 
2024-07-17 03:32:20:INFO:TRAIN-(cmcm) (4/22/3)>> loss: 0.3478
2024-07-17 03:32:57:INFO:VAL-(cmcm) >>
2024-07-17 03:32:57:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7249  Mult_acc_5: 0.4730  F1_score: 0.8032  MAE: 0.3193  Corr: 0.7005  R_squre: 0.4283 
2024-07-17 03:34:47:INFO:TRAIN-(cmcm) (5/23/3)>> loss: 0.3476
2024-07-17 03:35:26:INFO:VAL-(cmcm) >>
2024-07-17 03:35:26:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7032  Mult_acc_5: 0.4699  F1_score: 0.8053  MAE: 0.3190  Corr: 0.6833  R_squre: 0.4291 
2024-07-17 03:37:14:INFO:TRAIN-(cmcm) (6/24/3)>> loss: 0.3450
2024-07-17 03:37:53:INFO:VAL-(cmcm) >>
2024-07-17 03:37:53:INFO:M: >>  Mult_acc_2: 0.7960  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6692  Mult_acc_5: 0.4436  F1_score: 0.7874  MAE: 0.3236  Corr: 0.6860  R_squre: 0.4235 
2024-07-17 03:39:43:INFO:TRAIN-(cmcm) (7/25/3)>> loss: 0.3393
2024-07-17 03:40:21:INFO:VAL-(cmcm) >>
2024-07-17 03:40:21:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7403  Mult_acc_5: 0.4900  F1_score: 0.8284  MAE: 0.3147  Corr: 0.7062  R_squre: 0.4244 
2024-07-17 03:40:27:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:42:18:INFO:TRAIN-(cmcm) (1/26/3)>> loss: 0.3320
2024-07-17 03:42:53:INFO:TRAIN-(cmcm) (8/27/5)>> loss: 0.2136
2024-07-17 03:42:57:INFO:VAL-(cmcm) >>
2024-07-17 03:42:57:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7172  Mult_acc_5: 0.4668  F1_score: 0.8286  MAE: 0.3153  Corr: 0.6991  R_squre: 0.4516 
2024-07-17 03:44:44:INFO:TRAIN-(cmcm) (2/27/3)>> loss: 0.3276
2024-07-17 03:45:22:INFO:VAL-(cmcm) >>
2024-07-17 03:45:22:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7342  Mult_acc_5: 0.4915  F1_score: 0.8254  MAE: 0.3085  Corr: 0.7044  R_squre: 0.4668 
2024-07-17 03:45:28:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:46:42:INFO:VAL-(cmcm) >>
2024-07-17 03:46:42:INFO:M: >>  acc: 0.7423  weight_F1: 0.7389 
2024-07-17 03:47:16:INFO:TRAIN-(cmcm) (1/28/3)>> loss: 0.3237
2024-07-17 03:47:54:INFO:VAL-(cmcm) >>
2024-07-17 03:47:54:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7922  Mult_acc_3: 0.7635  Mult_acc_5: 0.5116  F1_score: 0.8436  MAE: 0.3054  Corr: 0.7153  R_squre: 0.4648 
2024-07-17 03:48:01:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:49:51:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.3200
2024-07-17 03:50:30:INFO:VAL-(cmcm) >>
2024-07-17 03:50:30:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7961  Mult_acc_3: 0.7682  Mult_acc_5: 0.5100  F1_score: 0.8428  MAE: 0.3091  Corr: 0.7078  R_squre: 0.4448 
2024-07-17 03:50:33:INFO:TEST-(cmcm) >>
2024-07-17 03:50:33:INFO:M: >>  acc: 0.7230  weight_F1: 0.7217 
2024-07-17 03:50:34:INFO:Results are added to results/results/cherma-classification-30.csv...
2024-07-17 03:52:12:INFO:TRAIN-(cmcm) (2/30/3)>> loss: 0.3208
2024-07-17 03:52:50:INFO:VAL-(cmcm) >>
2024-07-17 03:52:50:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.7388  Mult_acc_5: 0.4838  F1_score: 0.8334  MAE: 0.3107  Corr: 0.7149  R_squre: 0.4745 
2024-07-17 03:54:33:INFO:TRAIN-(cmcm) (3/31/3)>> loss: 0.3154
2024-07-17 03:55:11:INFO:VAL-(cmcm) >>
2024-07-17 03:55:11:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7512  Mult_acc_5: 0.5178  F1_score: 0.8367  MAE: 0.3042  Corr: 0.7055  R_squre: 0.4675 
2024-07-17 03:55:17:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 03:57:02:INFO:TRAIN-(cmcm) (1/32/3)>> loss: 0.3134
2024-07-17 03:57:42:INFO:VAL-(cmcm) >>
2024-07-17 03:57:42:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7922  Mult_acc_3: 0.7573  Mult_acc_5: 0.5054  F1_score: 0.8332  MAE: 0.3153  Corr: 0.7115  R_squre: 0.4645 
2024-07-17 03:59:25:INFO:TRAIN-(cmcm) (2/33/3)>> loss: 0.3124
2024-07-17 04:00:03:INFO:VAL-(cmcm) >>
2024-07-17 04:00:03:INFO:M: >>  Mult_acc_2: 0.8454  Mult_acc_2_weak: 0.7961  Mult_acc_3: 0.7651  Mult_acc_5: 0.5100  F1_score: 0.8444  MAE: 0.3063  Corr: 0.7211  R_squre: 0.4803 
2024-07-17 04:01:43:INFO:TRAIN-(cmcm) (3/34/3)>> loss: 0.3089
2024-07-17 04:02:20:INFO:VAL-(cmcm) >>
2024-07-17 04:02:20:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7922  Mult_acc_3: 0.7743  Mult_acc_5: 0.5255  F1_score: 0.8381  MAE: 0.3054  Corr: 0.7120  R_squre: 0.4716 
2024-07-17 04:04:06:INFO:TRAIN-(cmcm) (4/35/3)>> loss: 0.3063
2024-07-17 04:04:43:INFO:VAL-(cmcm) >>
2024-07-17 04:04:43:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7434  Mult_acc_5: 0.5054  F1_score: 0.8297  MAE: 0.3079  Corr: 0.7060  R_squre: 0.4658 
2024-07-17 04:06:24:INFO:TRAIN-(cmcm) (5/36/3)>> loss: 0.3038
2024-07-17 04:07:02:INFO:VAL-(cmcm) >>
2024-07-17 04:07:02:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7481  Mult_acc_5: 0.5008  F1_score: 0.8166  MAE: 0.3156  Corr: 0.6932  R_squre: 0.4449 
2024-07-17 04:08:47:INFO:TRAIN-(cmcm) (6/37/3)>> loss: 0.3034
2024-07-17 04:09:26:INFO:VAL-(cmcm) >>
2024-07-17 04:09:26:INFO:M: >>  Mult_acc_2: 0.8485  Mult_acc_2_weak: 0.7922  Mult_acc_3: 0.7697  Mult_acc_5: 0.5100  F1_score: 0.8473  MAE: 0.3042  Corr: 0.7264  R_squre: 0.4974 
2024-07-17 04:11:08:INFO:TRAIN-(cmcm) (7/38/3)>> loss: 0.3005
2024-07-17 04:11:46:INFO:VAL-(cmcm) >>
2024-07-17 04:11:46:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7372  Mult_acc_5: 0.4930  F1_score: 0.8250  MAE: 0.3113  Corr: 0.7144  R_squre: 0.4894 
2024-07-17 04:13:27:INFO:TRAIN-(cmcm) (8/39/3)>> loss: 0.2988
2024-07-17 04:14:05:INFO:VAL-(cmcm) >>
2024-07-17 04:14:05:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7434  Mult_acc_5: 0.5039  F1_score: 0.8347  MAE: 0.3017  Corr: 0.7158  R_squre: 0.4787 
2024-07-17 04:14:11:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:15:55:INFO:TRAIN-(cmcm) (1/40/3)>> loss: 0.2967
2024-07-17 04:16:34:INFO:VAL-(cmcm) >>
2024-07-17 04:16:34:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7512  Mult_acc_5: 0.5008  F1_score: 0.8225  MAE: 0.3168  Corr: 0.7000  R_squre: 0.4511 
2024-07-17 04:18:17:INFO:TRAIN-(cmcm) (2/41/3)>> loss: 0.2947
2024-07-17 04:18:54:INFO:VAL-(cmcm) >>
2024-07-17 04:18:54:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7573  Mult_acc_5: 0.5054  F1_score: 0.8295  MAE: 0.3060  Corr: 0.7092  R_squre: 0.4750 
2024-07-17 04:20:39:INFO:TRAIN-(cmcm) (3/42/3)>> loss: 0.2944
2024-07-17 04:21:16:INFO:VAL-(cmcm) >>
2024-07-17 04:21:16:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7558  Mult_acc_5: 0.5162  F1_score: 0.8341  MAE: 0.3042  Corr: 0.7194  R_squre: 0.5045 
2024-07-17 04:23:01:INFO:TRAIN-(cmcm) (4/43/3)>> loss: 0.2918
2024-07-17 04:23:39:INFO:VAL-(cmcm) >>
2024-07-17 04:23:39:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7403  Mult_acc_5: 0.5085  F1_score: 0.8194  MAE: 0.3131  Corr: 0.6967  R_squre: 0.4582 
2024-07-17 04:25:24:INFO:TRAIN-(cmcm) (5/44/3)>> loss: 0.2894
2024-07-17 04:26:01:INFO:VAL-(cmcm) >>
2024-07-17 04:26:01:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7496  Mult_acc_5: 0.4977  F1_score: 0.8179  MAE: 0.3100  Corr: 0.7070  R_squre: 0.4646 
2024-07-17 04:27:45:INFO:TRAIN-(cmcm) (6/45/3)>> loss: 0.2873
2024-07-17 04:28:23:INFO:VAL-(cmcm) >>
2024-07-17 04:28:23:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7635  Mult_acc_5: 0.5224  F1_score: 0.8317  MAE: 0.3097  Corr: 0.7094  R_squre: 0.4743 
2024-07-17 04:30:06:INFO:TRAIN-(cmcm) (7/46/3)>> loss: 0.2846
2024-07-17 04:30:42:INFO:VAL-(cmcm) >>
2024-07-17 04:30:42:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7512  Mult_acc_5: 0.5039  F1_score: 0.8307  MAE: 0.3079  Corr: 0.7208  R_squre: 0.5018 
2024-07-17 04:32:28:INFO:TRAIN-(cmcm) (8/47/3)>> loss: 0.2841
2024-07-17 04:33:05:INFO:VAL-(cmcm) >>
2024-07-17 04:33:05:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7604  Mult_acc_5: 0.5100  F1_score: 0.8276  MAE: 0.3141  Corr: 0.7031  R_squre: 0.4651 
2024-07-17 04:34:49:INFO:TRAIN-(cmcm) (9/48/3)>> loss: 0.2803
2024-07-17 04:35:27:INFO:VAL-(cmcm) >>
2024-07-17 04:35:27:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.5039  F1_score: 0.8207  MAE: 0.3122  Corr: 0.7097  R_squre: 0.4787 
2024-07-17 04:37:13:INFO:TRAIN-(cmcm) (10/49/3)>> loss: 0.2794
2024-07-17 04:37:49:INFO:VAL-(cmcm) >>
2024-07-17 04:37:49:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7635  Mult_acc_5: 0.5100  F1_score: 0.8309  MAE: 0.3097  Corr: 0.7068  R_squre: 0.4709 
2024-07-17 04:38:49:INFO:TEST-(cmcm) >>
2024-07-17 04:38:49:INFO:M: >>  Mult_acc_2: 0.8191  Mult_acc_2_weak: 0.7267  Mult_acc_3: 0.7602  Mult_acc_5: 0.5406  F1_score: 0.8187  MAE: 0.2901  Corr: 0.7303  R_squre: 0.4876 
2024-07-17 04:38:49:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 04:38:49:INFO:Start running cmcm...
2024-07-17 04:38:49:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 4444}>
2024-07-17 04:38:49:INFO:Let's use the GPU 1 !
2024-07-17 04:38:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 04:38:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721162332 HTTP/1.1" 200 280
2024-07-17 04:38:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 04:38:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 04:38:53:INFO:train samples: (2722,)
2024-07-17 04:38:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 04:38:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721162335 HTTP/1.1" 200 280
2024-07-17 04:38:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 04:38:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 04:38:56:INFO:valid samples: (647,)
2024-07-17 04:38:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 04:38:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721162339 HTTP/1.1" 200 280
2024-07-17 04:38:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 04:38:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 04:39:00:INFO:test samples: (1034,)
2024-07-17 04:39:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 04:39:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721162340 HTTP/1.1" 200 280
2024-07-17 04:39:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 04:39:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 04:39:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 04:39:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721162350 HTTP/1.1" 200 280
2024-07-17 04:39:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 04:39:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 04:39:12:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 04:39:12:INFO:Init labels...
2024-07-17 04:39:12:INFO:Start training...
2024-07-17 04:40:58:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.6232
2024-07-17 04:41:36:INFO:VAL-(cmcm) >>
2024-07-17 04:41:36:INFO:M: >>  Mult_acc_2: 0.6275  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.2798  Mult_acc_5: 0.1808  F1_score: 0.5391  MAE: 0.4738  Corr: 0.3941  R_squre: 0.1490 
2024-07-17 04:41:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:43:29:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.6115
2024-07-17 04:44:09:INFO:VAL-(cmcm) >>
2024-07-17 04:44:09:INFO:M: >>  Mult_acc_2: 0.6337  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.2859  Mult_acc_5: 0.1855  F1_score: 0.5467  MAE: 0.4711  Corr: 0.4023  R_squre: 0.1557 
2024-07-17 04:44:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:46:01:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.5707
2024-07-17 04:46:40:INFO:VAL-(cmcm) >>
2024-07-17 04:46:40:INFO:M: >>  Mult_acc_2: 0.6337  Mult_acc_2_weak: 0.6627  Mult_acc_3: 0.2906  Mult_acc_5: 0.1839  F1_score: 0.5502  MAE: 0.4691  Corr: 0.4096  R_squre: 0.1613 
2024-07-17 04:46:46:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:48:33:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 1.4377
2024-07-17 04:49:11:INFO:VAL-(cmcm) >>
2024-07-17 04:49:11:INFO:M: >>  Mult_acc_2: 0.6584  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.2643  Mult_acc_5: 0.1777  F1_score: 0.6293  MAE: 0.4989  Corr: 0.3552  R_squre: 0.0396 
2024-07-17 04:50:56:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.6477
2024-07-17 04:51:34:INFO:VAL-(cmcm) >>
2024-07-17 04:51:34:INFO:M: >>  Mult_acc_2: 0.7295  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.6399  Mult_acc_5: 0.4019  F1_score: 0.7002  MAE: 0.3784  Corr: 0.5885  R_squre: 0.3367 
2024-07-17 04:51:40:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:53:28:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.4717
2024-07-17 04:54:06:INFO:VAL-(cmcm) >>
2024-07-17 04:54:06:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7110  Mult_acc_5: 0.4590  F1_score: 0.7721  MAE: 0.3734  Corr: 0.5981  R_squre: 0.2236 
2024-07-17 04:54:13:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 04:55:59:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.4219
2024-07-17 04:56:36:INFO:VAL-(cmcm) >>
2024-07-17 04:56:36:INFO:M: >>  Mult_acc_2: 0.7589  Mult_acc_2_weak: 0.6471  Mult_acc_3: 0.7202  Mult_acc_5: 0.4590  F1_score: 0.7620  MAE: 0.3771  Corr: 0.6007  R_squre: 0.2003 
2024-07-17 04:58:23:INFO:TRAIN-(cmcm) (2/8/4)>> loss: 0.3973
2024-07-17 04:59:01:INFO:VAL-(cmcm) >>
2024-07-17 04:59:01:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6878  Mult_acc_5: 0.4374  F1_score: 0.7982  MAE: 0.3323  Corr: 0.6694  R_squre: 0.4100 
2024-07-17 04:59:07:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:00:53:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.3878
2024-07-17 05:01:32:INFO:VAL-(cmcm) >>
2024-07-17 05:01:32:INFO:M: >>  Mult_acc_2: 0.7805  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7233  Mult_acc_5: 0.4652  F1_score: 0.7815  MAE: 0.3533  Corr: 0.6237  R_squre: 0.2901 
2024-07-17 05:03:17:INFO:TRAIN-(cmcm) (2/10/4)>> loss: 0.3842
2024-07-17 05:03:54:INFO:VAL-(cmcm) >>
2024-07-17 05:03:54:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7017  Mult_acc_5: 0.4560  F1_score: 0.8022  MAE: 0.3332  Corr: 0.6598  R_squre: 0.3667 
2024-07-17 05:05:40:INFO:TRAIN-(cmcm) (3/11/4)>> loss: 0.3799
2024-07-17 05:06:18:INFO:VAL-(cmcm) >>
2024-07-17 05:06:18:INFO:M: >>  Mult_acc_2: 0.7929  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7249  Mult_acc_5: 0.4652  F1_score: 0.7943  MAE: 0.3478  Corr: 0.6339  R_squre: 0.2976 
2024-07-17 05:08:05:INFO:TRAIN-(cmcm) (4/12/4)>> loss: 0.3771
2024-07-17 05:08:43:INFO:VAL-(cmcm) >>
2024-07-17 05:08:43:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7388  Mult_acc_5: 0.4869  F1_score: 0.8076  MAE: 0.3444  Corr: 0.6403  R_squre: 0.3093 
2024-07-17 05:10:29:INFO:TRAIN-(cmcm) (5/13/4)>> loss: 0.3745
2024-07-17 05:11:07:INFO:VAL-(cmcm) >>
2024-07-17 05:11:07:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7264  Mult_acc_5: 0.4683  F1_score: 0.8096  MAE: 0.3436  Corr: 0.6446  R_squre: 0.3172 
2024-07-17 05:12:51:INFO:TRAIN-(cmcm) (6/14/4)>> loss: 0.3730
2024-07-17 05:13:29:INFO:VAL-(cmcm) >>
2024-07-17 05:13:29:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7326  Mult_acc_5: 0.4714  F1_score: 0.8025  MAE: 0.3439  Corr: 0.6490  R_squre: 0.3143 
2024-07-17 05:15:14:INFO:TRAIN-(cmcm) (7/15/4)>> loss: 0.3705
2024-07-17 05:15:52:INFO:VAL-(cmcm) >>
2024-07-17 05:15:52:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7326  Mult_acc_5: 0.4822  F1_score: 0.8122  MAE: 0.3320  Corr: 0.6523  R_squre: 0.3510 
2024-07-17 05:15:58:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:17:44:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.3671
2024-07-17 05:18:21:INFO:VAL-(cmcm) >>
2024-07-17 05:18:21:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7202  Mult_acc_5: 0.4637  F1_score: 0.8104  MAE: 0.3270  Corr: 0.6597  R_squre: 0.3735 
2024-07-17 05:18:28:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:20:15:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.3560
2024-07-17 05:20:52:INFO:VAL-(cmcm) >>
2024-07-17 05:20:52:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7543  Mult_acc_5: 0.4915  F1_score: 0.8106  MAE: 0.3354  Corr: 0.6650  R_squre: 0.3332 
2024-07-17 05:22:37:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.3505
2024-07-17 05:23:13:INFO:VAL-(cmcm) >>
2024-07-17 05:23:13:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7604  Mult_acc_5: 0.5100  F1_score: 0.8090  MAE: 0.3413  Corr: 0.6443  R_squre: 0.2967 
2024-07-17 05:24:59:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.3456
2024-07-17 05:25:35:INFO:VAL-(cmcm) >>
2024-07-17 05:25:35:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7573  Mult_acc_5: 0.5100  F1_score: 0.8108  MAE: 0.3376  Corr: 0.6673  R_squre: 0.3212 
2024-07-17 05:27:21:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.3411
2024-07-17 05:27:58:INFO:VAL-(cmcm) >>
2024-07-17 05:27:58:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7573  Mult_acc_5: 0.4992  F1_score: 0.8123  MAE: 0.3372  Corr: 0.6705  R_squre: 0.3390 
2024-07-17 05:29:41:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.3403
2024-07-17 05:30:19:INFO:VAL-(cmcm) >>
2024-07-17 05:30:19:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7372  Mult_acc_5: 0.4776  F1_score: 0.8236  MAE: 0.3264  Corr: 0.6953  R_squre: 0.4159 
2024-07-17 05:30:25:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:32:11:INFO:TRAIN-(cmcm) (1/22/4)>> loss: 0.3383
2024-07-17 05:32:48:INFO:VAL-(cmcm) >>
2024-07-17 05:32:48:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7450  Mult_acc_5: 0.4900  F1_score: 0.8192  MAE: 0.3218  Corr: 0.6844  R_squre: 0.3906 
2024-07-17 05:32:54:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:34:42:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 0.3346
2024-07-17 05:35:20:INFO:VAL-(cmcm) >>
2024-07-17 05:35:20:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7465  Mult_acc_5: 0.4807  F1_score: 0.8165  MAE: 0.3277  Corr: 0.6776  R_squre: 0.3680 
2024-07-17 05:37:05:INFO:TRAIN-(cmcm) (2/24/4)>> loss: 0.3341
2024-07-17 05:37:42:INFO:VAL-(cmcm) >>
2024-07-17 05:37:42:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7450  Mult_acc_5: 0.4853  F1_score: 0.8211  MAE: 0.3206  Corr: 0.6770  R_squre: 0.3977 
2024-07-17 05:37:48:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:39:32:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.3320
2024-07-17 05:40:11:INFO:VAL-(cmcm) >>
2024-07-17 05:40:11:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7419  Mult_acc_5: 0.4838  F1_score: 0.8165  MAE: 0.3270  Corr: 0.6792  R_squre: 0.3694 
2024-07-17 05:41:57:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.3295
2024-07-17 05:42:34:INFO:VAL-(cmcm) >>
2024-07-17 05:42:34:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7481  Mult_acc_5: 0.4869  F1_score: 0.8179  MAE: 0.3212  Corr: 0.6703  R_squre: 0.3835 
2024-07-17 05:44:19:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 0.3287
2024-07-17 05:44:57:INFO:VAL-(cmcm) >>
2024-07-17 05:44:57:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7512  Mult_acc_5: 0.4992  F1_score: 0.8203  MAE: 0.3224  Corr: 0.6665  R_squre: 0.3665 
2024-07-17 05:46:42:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 0.3275
2024-07-17 05:47:20:INFO:VAL-(cmcm) >>
2024-07-17 05:47:20:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7403  Mult_acc_5: 0.4822  F1_score: 0.8234  MAE: 0.3175  Corr: 0.6746  R_squre: 0.3926 
2024-07-17 05:47:26:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:49:11:INFO:TRAIN-(cmcm) (1/29/4)>> loss: 0.3252
2024-07-17 05:49:48:INFO:VAL-(cmcm) >>
2024-07-17 05:49:48:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7573  Mult_acc_5: 0.4946  F1_score: 0.8174  MAE: 0.3246  Corr: 0.6623  R_squre: 0.3561 
2024-07-17 05:51:27:INFO:TRAIN-(cmcm) (2/30/4)>> loss: 0.3236
2024-07-17 05:52:05:INFO:VAL-(cmcm) >>
2024-07-17 05:52:05:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7512  Mult_acc_5: 0.5008  F1_score: 0.8240  MAE: 0.3162  Corr: 0.6978  R_squre: 0.4059 
2024-07-17 05:52:11:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 05:53:57:INFO:TRAIN-(cmcm) (1/31/4)>> loss: 0.3223
2024-07-17 05:54:34:INFO:VAL-(cmcm) >>
2024-07-17 05:54:34:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7388  Mult_acc_5: 0.4822  F1_score: 0.8150  MAE: 0.3218  Corr: 0.6631  R_squre: 0.3848 
2024-07-17 05:56:17:INFO:TRAIN-(cmcm) (2/32/4)>> loss: 0.3205
2024-07-17 05:56:55:INFO:VAL-(cmcm) >>
2024-07-17 05:56:55:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7496  Mult_acc_5: 0.4930  F1_score: 0.8258  MAE: 0.3199  Corr: 0.6714  R_squre: 0.3818 
2024-07-17 05:58:40:INFO:TRAIN-(cmcm) (3/33/4)>> loss: 0.3182
2024-07-17 05:59:18:INFO:VAL-(cmcm) >>
2024-07-17 05:59:18:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7419  Mult_acc_5: 0.4900  F1_score: 0.8207  MAE: 0.3094  Corr: 0.7042  R_squre: 0.4310 
2024-07-17 05:59:23:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:01:10:INFO:TRAIN-(cmcm) (1/34/4)>> loss: 0.3166
2024-07-17 06:01:48:INFO:VAL-(cmcm) >>
2024-07-17 06:01:48:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7450  Mult_acc_5: 0.4900  F1_score: 0.8170  MAE: 0.3215  Corr: 0.6797  R_squre: 0.3945 
2024-07-17 06:03:33:INFO:TRAIN-(cmcm) (2/35/4)>> loss: 0.3152
2024-07-17 06:04:10:INFO:VAL-(cmcm) >>
2024-07-17 06:04:10:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7512  Mult_acc_5: 0.4915  F1_score: 0.8234  MAE: 0.3187  Corr: 0.6780  R_squre: 0.3780 
2024-07-17 06:05:55:INFO:TRAIN-(cmcm) (3/36/4)>> loss: 0.3133
2024-07-17 06:06:32:INFO:VAL-(cmcm) >>
2024-07-17 06:06:32:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7372  Mult_acc_5: 0.4838  F1_score: 0.8185  MAE: 0.3202  Corr: 0.6787  R_squre: 0.3891 
2024-07-17 06:08:16:INFO:TRAIN-(cmcm) (4/37/4)>> loss: 0.3115
2024-07-17 06:08:54:INFO:VAL-(cmcm) >>
2024-07-17 06:08:54:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7342  Mult_acc_5: 0.4822  F1_score: 0.8216  MAE: 0.3125  Corr: 0.6994  R_squre: 0.4225 
2024-07-17 06:10:37:INFO:TRAIN-(cmcm) (5/38/4)>> loss: 0.3109
2024-07-17 06:11:14:INFO:VAL-(cmcm) >>
2024-07-17 06:11:14:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7481  Mult_acc_5: 0.4730  F1_score: 0.8188  MAE: 0.3192  Corr: 0.6847  R_squre: 0.3906 
2024-07-17 06:12:57:INFO:TRAIN-(cmcm) (6/39/4)>> loss: 0.3096
2024-07-17 06:13:34:INFO:VAL-(cmcm) >>
2024-07-17 06:13:34:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7326  Mult_acc_5: 0.4791  F1_score: 0.8188  MAE: 0.3326  Corr: 0.6827  R_squre: 0.3779 
2024-07-17 06:15:21:INFO:TRAIN-(cmcm) (7/40/4)>> loss: 0.3083
2024-07-17 06:15:58:INFO:VAL-(cmcm) >>
2024-07-17 06:15:58:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7434  Mult_acc_5: 0.4730  F1_score: 0.8233  MAE: 0.3153  Corr: 0.7007  R_squre: 0.4458 
2024-07-17 06:17:40:INFO:TRAIN-(cmcm) (8/41/4)>> loss: 0.3046
2024-07-17 06:18:17:INFO:VAL-(cmcm) >>
2024-07-17 06:18:17:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7465  Mult_acc_5: 0.4853  F1_score: 0.8244  MAE: 0.3104  Corr: 0.7053  R_squre: 0.4427 
2024-07-17 06:20:00:INFO:TRAIN-(cmcm) (9/42/4)>> loss: 0.3037
2024-07-17 06:20:38:INFO:VAL-(cmcm) >>
2024-07-17 06:20:38:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7372  Mult_acc_5: 0.4853  F1_score: 0.8207  MAE: 0.3162  Corr: 0.6910  R_squre: 0.4235 
2024-07-17 06:22:24:INFO:TRAIN-(cmcm) (10/43/4)>> loss: 0.3027
2024-07-17 06:23:02:INFO:VAL-(cmcm) >>
2024-07-17 06:23:02:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7527  Mult_acc_5: 0.4961  F1_score: 0.8244  MAE: 0.3138  Corr: 0.6886  R_squre: 0.4123 
2024-07-17 06:24:00:INFO:TEST-(cmcm) >>
2024-07-17 06:24:00:INFO:M: >>  Mult_acc_2: 0.8337  Mult_acc_2_weak: 0.7474  Mult_acc_3: 0.7805  Mult_acc_5: 0.5513  F1_score: 0.8344  MAE: 0.2963  Corr: 0.7131  R_squre: 0.4298 
2024-07-17 06:24:01:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 06:24:01:INFO:Start running cmcm...
2024-07-17 06:24:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 5555}>
2024-07-17 06:24:01:INFO:Let's use the GPU 1 !
2024-07-17 06:24:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 06:24:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721168643 HTTP/1.1" 200 280
2024-07-17 06:24:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 06:24:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 06:24:04:INFO:train samples: (2722,)
2024-07-17 06:24:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 06:24:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721168648 HTTP/1.1" 200 280
2024-07-17 06:24:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 06:24:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 06:24:08:INFO:valid samples: (647,)
2024-07-17 06:24:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 06:24:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721168651 HTTP/1.1" 200 280
2024-07-17 06:24:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 06:24:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 06:24:12:INFO:test samples: (1034,)
2024-07-17 06:24:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 06:24:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721168653 HTTP/1.1" 200 280
2024-07-17 06:24:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 06:24:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 06:24:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 06:24:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721168662 HTTP/1.1" 200 280
2024-07-17 06:24:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 06:24:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 06:24:24:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 06:24:24:INFO:Init labels...
2024-07-17 06:24:24:INFO:Start training...
2024-07-17 06:26:08:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.4782
2024-07-17 06:26:47:INFO:VAL-(cmcm) >>
2024-07-17 06:26:47:INFO:M: >>  Mult_acc_2: 0.6167  Mult_acc_2_weak: 0.6275  Mult_acc_3: 0.2890  Mult_acc_5: 0.1917  F1_score: 0.6175  MAE: 0.5298  Corr: 0.3302  R_squre: -0.1091 
2024-07-17 06:26:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:28:39:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.6857
2024-07-17 06:29:18:INFO:VAL-(cmcm) >>
2024-07-17 06:29:18:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7295  Mult_acc_5: 0.4451  F1_score: 0.7818  MAE: 0.3845  Corr: 0.6502  R_squre: 0.2607 
2024-07-17 06:29:24:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:31:11:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.4820
2024-07-17 06:31:49:INFO:VAL-(cmcm) >>
2024-07-17 06:31:49:INFO:M: >>  Mult_acc_2: 0.7666  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.7264  Mult_acc_5: 0.4606  F1_score: 0.7696  MAE: 0.3764  Corr: 0.6112  R_squre: 0.1840 
2024-07-17 06:31:55:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:33:41:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.4056
2024-07-17 06:34:18:INFO:VAL-(cmcm) >>
2024-07-17 06:34:18:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7558  Mult_acc_5: 0.4776  F1_score: 0.8080  MAE: 0.3553  Corr: 0.6309  R_squre: 0.2630 
2024-07-17 06:34:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:36:12:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.3940
2024-07-17 06:36:51:INFO:VAL-(cmcm) >>
2024-07-17 06:36:51:INFO:M: >>  Mult_acc_2: 0.7512  Mult_acc_2_weak: 0.6314  Mult_acc_3: 0.7218  Mult_acc_5: 0.4544  F1_score: 0.7532  MAE: 0.3879  Corr: 0.6093  R_squre: 0.1435 
2024-07-17 06:38:36:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.3914
2024-07-17 06:39:13:INFO:VAL-(cmcm) >>
2024-07-17 06:39:13:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7558  Mult_acc_5: 0.4760  F1_score: 0.8026  MAE: 0.3570  Corr: 0.6334  R_squre: 0.2594 
2024-07-17 06:40:58:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.3863
2024-07-17 06:41:36:INFO:VAL-(cmcm) >>
2024-07-17 06:41:36:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7573  Mult_acc_5: 0.4930  F1_score: 0.8059  MAE: 0.3546  Corr: 0.6288  R_squre: 0.2548 
2024-07-17 06:41:42:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:43:28:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.3860
2024-07-17 06:44:06:INFO:VAL-(cmcm) >>
2024-07-17 06:44:06:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7465  Mult_acc_5: 0.4714  F1_score: 0.7863  MAE: 0.3643  Corr: 0.6433  R_squre: 0.2348 
2024-07-17 06:45:52:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.3827
2024-07-17 06:46:29:INFO:VAL-(cmcm) >>
2024-07-17 06:46:29:INFO:M: >>  Mult_acc_2: 0.7481  Mult_acc_2_weak: 0.6392  Mult_acc_3: 0.7187  Mult_acc_5: 0.4513  F1_score: 0.7502  MAE: 0.3892  Corr: 0.6181  R_squre: 0.1386 
2024-07-17 06:48:15:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.3787
2024-07-17 06:48:54:INFO:VAL-(cmcm) >>
2024-07-17 06:48:54:INFO:M: >>  Mult_acc_2: 0.7651  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.7326  Mult_acc_5: 0.4621  F1_score: 0.7674  MAE: 0.3747  Corr: 0.6417  R_squre: 0.1931 
2024-07-17 06:50:39:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.3779
2024-07-17 06:51:18:INFO:VAL-(cmcm) >>
2024-07-17 06:51:18:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7651  Mult_acc_5: 0.4822  F1_score: 0.8133  MAE: 0.3493  Corr: 0.6604  R_squre: 0.2862 
2024-07-17 06:51:24:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:53:11:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.3744
2024-07-17 06:53:48:INFO:VAL-(cmcm) >>
2024-07-17 06:53:48:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7666  Mult_acc_5: 0.4915  F1_score: 0.8184  MAE: 0.3444  Corr: 0.6518  R_squre: 0.2970 
2024-07-17 06:53:54:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:55:41:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.3728
2024-07-17 06:56:18:INFO:VAL-(cmcm) >>
2024-07-17 06:56:18:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7697  Mult_acc_5: 0.5039  F1_score: 0.8231  MAE: 0.3292  Corr: 0.6721  R_squre: 0.3420 
2024-07-17 06:56:24:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 06:58:12:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.3702
2024-07-17 06:58:50:INFO:VAL-(cmcm) >>
2024-07-17 06:58:50:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7713  Mult_acc_5: 0.5147  F1_score: 0.8337  MAE: 0.3131  Corr: 0.6919  R_squre: 0.4039 
2024-07-17 06:58:57:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:00:44:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.3682
2024-07-17 07:01:22:INFO:VAL-(cmcm) >>
2024-07-17 07:01:22:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7403  Mult_acc_5: 0.4699  F1_score: 0.7767  MAE: 0.3635  Corr: 0.6530  R_squre: 0.2346 
2024-07-17 07:03:08:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.3680
2024-07-17 07:03:47:INFO:VAL-(cmcm) >>
2024-07-17 07:03:47:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7666  Mult_acc_5: 0.4992  F1_score: 0.8122  MAE: 0.3437  Corr: 0.6649  R_squre: 0.2920 
2024-07-17 07:05:27:INFO:TRAIN-(cmcm) (3/17/5)>> loss: 0.3663
2024-07-17 07:06:05:INFO:VAL-(cmcm) >>
2024-07-17 07:06:05:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7388  Mult_acc_5: 0.4853  F1_score: 0.7783  MAE: 0.3580  Corr: 0.6522  R_squre: 0.2468 
2024-07-17 07:07:50:INFO:TRAIN-(cmcm) (4/18/5)>> loss: 0.3644
2024-07-17 07:08:29:INFO:VAL-(cmcm) >>
2024-07-17 07:08:29:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.7651  Mult_acc_5: 0.4760  F1_score: 0.8174  MAE: 0.3354  Corr: 0.6816  R_squre: 0.3386 
2024-07-17 07:10:15:INFO:TRAIN-(cmcm) (5/19/5)>> loss: 0.3629
2024-07-17 07:10:52:INFO:VAL-(cmcm) >>
2024-07-17 07:10:52:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7098  Mult_acc_3: 0.7589  Mult_acc_5: 0.4869  F1_score: 0.8122  MAE: 0.3388  Corr: 0.6786  R_squre: 0.3215 
2024-07-17 07:12:37:INFO:TRAIN-(cmcm) (6/20/5)>> loss: 0.3619
2024-07-17 07:13:14:INFO:VAL-(cmcm) >>
2024-07-17 07:13:14:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7697  Mult_acc_5: 0.5085  F1_score: 0.8248  MAE: 0.3233  Corr: 0.6841  R_squre: 0.3592 
2024-07-17 07:14:57:INFO:TRAIN-(cmcm) (7/21/5)>> loss: 0.3601
2024-07-17 07:15:35:INFO:VAL-(cmcm) >>
2024-07-17 07:15:35:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7805  Mult_acc_5: 0.5131  F1_score: 0.8343  MAE: 0.3091  Corr: 0.7032  R_squre: 0.4234 
2024-07-17 07:15:41:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:17:26:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.3589
2024-07-17 07:18:04:INFO:VAL-(cmcm) >>
2024-07-17 07:18:04:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.5100  F1_score: 0.8225  MAE: 0.3190  Corr: 0.6822  R_squre: 0.3714 
2024-07-17 07:19:47:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.3573
2024-07-17 07:20:24:INFO:VAL-(cmcm) >>
2024-07-17 07:20:24:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7573  Mult_acc_5: 0.5100  F1_score: 0.8152  MAE: 0.3274  Corr: 0.6787  R_squre: 0.3417 
2024-07-17 07:22:10:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.3559
2024-07-17 07:22:49:INFO:VAL-(cmcm) >>
2024-07-17 07:22:49:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7604  Mult_acc_5: 0.5008  F1_score: 0.8286  MAE: 0.3153  Corr: 0.6953  R_squre: 0.3938 
2024-07-17 07:24:33:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.3550
2024-07-17 07:25:11:INFO:VAL-(cmcm) >>
2024-07-17 07:25:11:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7403  Mult_acc_5: 0.4930  F1_score: 0.8221  MAE: 0.3175  Corr: 0.7012  R_squre: 0.3967 
2024-07-17 07:26:56:INFO:TRAIN-(cmcm) (5/26/5)>> loss: 0.3546
2024-07-17 07:27:33:INFO:VAL-(cmcm) >>
2024-07-17 07:27:33:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7450  Mult_acc_5: 0.5008  F1_score: 0.8234  MAE: 0.3073  Corr: 0.7048  R_squre: 0.4278 
2024-07-17 07:27:39:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:29:25:INFO:TRAIN-(cmcm) (1/27/5)>> loss: 0.3527
2024-07-17 07:30:03:INFO:VAL-(cmcm) >>
2024-07-17 07:30:03:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7481  Mult_acc_5: 0.4961  F1_score: 0.8252  MAE: 0.3073  Corr: 0.7039  R_squre: 0.4312 
2024-07-17 07:31:46:INFO:TRAIN-(cmcm) (2/28/5)>> loss: 0.3495
2024-07-17 07:32:24:INFO:VAL-(cmcm) >>
2024-07-17 07:32:24:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7311  Mult_acc_5: 0.4853  F1_score: 0.8150  MAE: 0.3131  Corr: 0.6972  R_squre: 0.4127 
2024-07-17 07:34:08:INFO:TRAIN-(cmcm) (3/29/5)>> loss: 0.3493
2024-07-17 07:34:46:INFO:VAL-(cmcm) >>
2024-07-17 07:34:46:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7372  Mult_acc_5: 0.4869  F1_score: 0.8204  MAE: 0.3079  Corr: 0.7111  R_squre: 0.4414 
2024-07-17 07:36:32:INFO:TRAIN-(cmcm) (4/30/5)>> loss: 0.3477
2024-07-17 07:37:12:INFO:VAL-(cmcm) >>
2024-07-17 07:37:12:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7264  Mult_acc_5: 0.4884  F1_score: 0.8204  MAE: 0.2986  Corr: 0.7168  R_squre: 0.4774 
2024-07-17 07:37:18:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:39:06:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.3458
2024-07-17 07:39:43:INFO:VAL-(cmcm) >>
2024-07-17 07:39:43:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7496  Mult_acc_5: 0.5023  F1_score: 0.8222  MAE: 0.3076  Corr: 0.7041  R_squre: 0.4269 
2024-07-17 07:41:27:INFO:TRAIN-(cmcm) (2/32/5)>> loss: 0.3431
2024-07-17 07:42:04:INFO:VAL-(cmcm) >>
2024-07-17 07:42:04:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7156  Mult_acc_5: 0.4745  F1_score: 0.8277  MAE: 0.2977  Corr: 0.7255  R_squre: 0.4972 
2024-07-17 07:42:11:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:43:56:INFO:TRAIN-(cmcm) (1/33/5)>> loss: 0.3351
2024-07-17 07:44:34:INFO:VAL-(cmcm) >>
2024-07-17 07:44:34:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.7434  Mult_acc_5: 0.5116  F1_score: 0.8265  MAE: 0.2883  Corr: 0.7426  R_squre: 0.5385 
2024-07-17 07:44:40:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:46:27:INFO:TRAIN-(cmcm) (1/34/5)>> loss: 0.3286
2024-07-17 07:47:06:INFO:VAL-(cmcm) >>
2024-07-17 07:47:06:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7202  Mult_acc_5: 0.4822  F1_score: 0.8278  MAE: 0.2934  Corr: 0.7332  R_squre: 0.5115 
2024-07-17 07:48:52:INFO:TRAIN-(cmcm) (2/35/5)>> loss: 0.3247
2024-07-17 07:49:30:INFO:VAL-(cmcm) >>
2024-07-17 07:49:30:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7589  Mult_acc_5: 0.5332  F1_score: 0.8293  MAE: 0.2876  Corr: 0.7470  R_squre: 0.5340 
2024-07-17 07:49:37:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 07:51:23:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.3215
2024-07-17 07:52:01:INFO:VAL-(cmcm) >>
2024-07-17 07:52:01:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7311  Mult_acc_5: 0.5070  F1_score: 0.8233  MAE: 0.2923  Corr: 0.7403  R_squre: 0.5291 
2024-07-17 07:53:46:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.3185
2024-07-17 07:54:23:INFO:VAL-(cmcm) >>
2024-07-17 07:54:23:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7589  Mult_acc_5: 0.5301  F1_score: 0.8284  MAE: 0.2949  Corr: 0.7314  R_squre: 0.4879 
2024-07-17 07:56:08:INFO:TRAIN-(cmcm) (3/38/5)>> loss: 0.3182
2024-07-17 07:56:47:INFO:VAL-(cmcm) >>
2024-07-17 07:56:47:INFO:M: >>  Mult_acc_2: 0.8393  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7527  Mult_acc_5: 0.5116  F1_score: 0.8365  MAE: 0.2906  Corr: 0.7363  R_squre: 0.5011 
2024-07-17 07:58:33:INFO:TRAIN-(cmcm) (4/39/5)>> loss: 0.3161
2024-07-17 07:59:11:INFO:VAL-(cmcm) >>
2024-07-17 07:59:11:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7357  Mult_acc_5: 0.4992  F1_score: 0.8264  MAE: 0.2983  Corr: 0.7246  R_squre: 0.5084 
2024-07-17 08:00:55:INFO:TRAIN-(cmcm) (5/40/5)>> loss: 0.3135
2024-07-17 08:01:33:INFO:VAL-(cmcm) >>
2024-07-17 08:01:33:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7651  Mult_acc_5: 0.5270  F1_score: 0.8285  MAE: 0.2901  Corr: 0.7430  R_squre: 0.5274 
2024-07-17 08:03:18:INFO:TRAIN-(cmcm) (6/41/5)>> loss: 0.3127
2024-07-17 08:03:55:INFO:VAL-(cmcm) >>
2024-07-17 08:03:55:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7481  Mult_acc_5: 0.5162  F1_score: 0.8243  MAE: 0.2938  Corr: 0.7263  R_squre: 0.4845 
2024-07-17 08:05:33:INFO:TRAIN-(cmcm) (7/42/5)>> loss: 0.3104
2024-07-17 08:06:10:INFO:VAL-(cmcm) >>
2024-07-17 08:06:10:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7249  Mult_acc_5: 0.4946  F1_score: 0.8050  MAE: 0.2927  Corr: 0.7357  R_squre: 0.5197 
2024-07-17 08:07:52:INFO:TRAIN-(cmcm) (8/43/5)>> loss: 0.3083
2024-07-17 08:08:29:INFO:VAL-(cmcm) >>
2024-07-17 08:08:29:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7481  Mult_acc_5: 0.5209  F1_score: 0.8258  MAE: 0.2903  Corr: 0.7359  R_squre: 0.5123 
2024-07-17 08:10:13:INFO:TRAIN-(cmcm) (9/44/5)>> loss: 0.3053
2024-07-17 08:10:52:INFO:VAL-(cmcm) >>
2024-07-17 08:10:52:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7434  Mult_acc_5: 0.5085  F1_score: 0.8227  MAE: 0.2941  Corr: 0.7296  R_squre: 0.5213 
2024-07-17 08:12:35:INFO:TRAIN-(cmcm) (10/45/5)>> loss: 0.3047
2024-07-17 08:13:12:INFO:VAL-(cmcm) >>
2024-07-17 08:13:12:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7465  Mult_acc_5: 0.5162  F1_score: 0.8252  MAE: 0.2910  Corr: 0.7358  R_squre: 0.5195 
2024-07-17 08:14:12:INFO:TEST-(cmcm) >>
2024-07-17 08:14:12:INFO:M: >>  Mult_acc_2: 0.8240  Mult_acc_2_weak: 0.7391  Mult_acc_3: 0.7708  Mult_acc_5: 0.5706  F1_score: 0.8239  MAE: 0.2954  Corr: 0.7161  R_squre: 0.4441 
2024-07-17 08:14:12:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 10:12:14:INFO:Start running cmcm...
2024-07-17 10:12:14:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-07-17 10:12:14:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-17 10:12:14:INFO:Let's use the GPU 1 !
2024-07-17 10:12:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182337 HTTP/1.1" 200 280
2024-07-17 10:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:12:19:INFO:train samples: (2722,)
2024-07-17 10:12:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:12:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182342 HTTP/1.1" 200 280
2024-07-17 10:12:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:12:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:12:24:INFO:valid samples: (647,)
2024-07-17 10:12:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:12:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182346 HTTP/1.1" 200 280
2024-07-17 10:12:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:12:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:12:28:INFO:test samples: (1034,)
2024-07-17 10:12:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:12:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182349 HTTP/1.1" 200 280
2024-07-17 10:12:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:12:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:12:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:12:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182357 HTTP/1.1" 200 280
2024-07-17 10:12:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:12:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:12:42:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 10:12:42:INFO:Init labels...
2024-07-17 10:12:42:INFO:Start training...
2024-07-17 10:14:29:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.2340
2024-07-17 10:16:14:INFO:Start running cmcm...
2024-07-17 10:16:14:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-07-17 10:16:14:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-17 10:16:14:INFO:Let's use the GPU 1 !
2024-07-17 10:16:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:16:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182576 HTTP/1.1" 200 280
2024-07-17 10:16:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:16:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:16:18:INFO:train samples: (2722,)
2024-07-17 10:16:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:16:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182581 HTTP/1.1" 200 280
2024-07-17 10:16:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:16:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:16:22:INFO:valid samples: (647,)
2024-07-17 10:16:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:16:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182585 HTTP/1.1" 200 280
2024-07-17 10:16:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:16:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:16:26:INFO:test samples: (1034,)
2024-07-17 10:16:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182587 HTTP/1.1" 200 280
2024-07-17 10:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:16:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:16:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182595 HTTP/1.1" 200 280
2024-07-17 10:16:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:16:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:16:39:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 10:16:39:INFO:Init labels...
2024-07-17 10:16:39:INFO:Start training...
2024-07-17 10:18:26:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1170
2024-07-17 10:21:05:INFO:Start running cmcm...
2024-07-17 10:21:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-07-17 10:21:06:INFO:Find gpu: 1, with memory: 378273792 left!
2024-07-17 10:21:06:INFO:Let's use the GPU 1 !
2024-07-17 10:21:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:21:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182868 HTTP/1.1" 200 280
2024-07-17 10:21:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:21:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:21:10:INFO:train samples: (2722,)
2024-07-17 10:21:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:21:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182873 HTTP/1.1" 200 280
2024-07-17 10:21:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:21:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:21:13:INFO:valid samples: (647,)
2024-07-17 10:21:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:21:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182876 HTTP/1.1" 200 280
2024-07-17 10:21:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:21:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:21:16:INFO:test samples: (1034,)
2024-07-17 10:21:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:21:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182877 HTTP/1.1" 200 280
2024-07-17 10:21:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:21:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:21:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 10:21:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721182886 HTTP/1.1" 200 280
2024-07-17 10:21:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 10:21:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 10:21:30:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 10:21:30:INFO:Init labels...
2024-07-17 10:21:30:INFO:Start training...
2024-07-17 10:23:13:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1170
2024-07-17 10:23:59:INFO:VAL-(cmcm) >>
2024-07-17 10:23:59:INFO:M: >>  Mult_acc_2: 0.7141  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.5471  Mult_acc_5: 0.3400  F1_score: 0.6807  MAE: 0.4326  Corr: 0.5274  R_squre: 0.2441 
2024-07-17 10:24:07:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 10:25:52:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.4861
2024-07-17 10:26:39:INFO:VAL-(cmcm) >>
2024-07-17 10:26:39:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7403  Mult_acc_5: 0.4637  F1_score: 0.8079  MAE: 0.3669  Corr: 0.6250  R_squre: 0.2429 
2024-07-17 10:26:45:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 10:28:31:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.3949
2024-07-17 10:29:18:INFO:VAL-(cmcm) >>
2024-07-17 10:29:18:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.7017  Mult_acc_5: 0.4389  F1_score: 0.7782  MAE: 0.3606  Corr: 0.6489  R_squre: 0.2916 
2024-07-17 10:29:24:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 10:31:10:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.3902
2024-07-17 10:31:58:INFO:VAL-(cmcm) >>
2024-07-17 10:31:58:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.6986  Mult_acc_5: 0.4467  F1_score: 0.8015  MAE: 0.3219  Corr: 0.6763  R_squre: 0.4264 
2024-07-17 10:32:04:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 10:33:49:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.3862
2024-07-17 10:34:35:INFO:VAL-(cmcm) >>
2024-07-17 10:34:35:INFO:M: >>  Mult_acc_2: 0.7666  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.7388  Mult_acc_5: 0.4900  F1_score: 0.7695  MAE: 0.3642  Corr: 0.6338  R_squre: 0.2151 
2024-07-17 10:36:20:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.3828
2024-07-17 10:37:09:INFO:VAL-(cmcm) >>
2024-07-17 10:37:09:INFO:M: >>  Mult_acc_2: 0.7728  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7218  Mult_acc_5: 0.4745  F1_score: 0.7754  MAE: 0.3706  Corr: 0.6374  R_squre: 0.2011 
2024-07-17 10:38:54:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.3804
2024-07-17 10:39:41:INFO:VAL-(cmcm) >>
2024-07-17 10:39:41:INFO:M: >>  Mult_acc_2: 0.7913  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7450  Mult_acc_5: 0.4838  F1_score: 0.7937  MAE: 0.3564  Corr: 0.6391  R_squre: 0.2474 
2024-07-17 10:41:24:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.3798
2024-07-17 10:42:12:INFO:VAL-(cmcm) >>
2024-07-17 10:42:12:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7481  Mult_acc_5: 0.4838  F1_score: 0.8010  MAE: 0.3522  Corr: 0.6441  R_squre: 0.2861 
2024-07-17 10:43:56:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.3743
2024-07-17 10:44:42:INFO:VAL-(cmcm) >>
2024-07-17 10:44:42:INFO:M: >>  Mult_acc_2: 0.7713  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.7017  Mult_acc_5: 0.4436  F1_score: 0.7742  MAE: 0.3725  Corr: 0.6525  R_squre: 0.2469 
2024-07-17 10:46:26:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.3730
2024-07-17 10:47:13:INFO:VAL-(cmcm) >>
2024-07-17 10:47:13:INFO:M: >>  Mult_acc_2: 0.7960  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7450  Mult_acc_5: 0.4946  F1_score: 0.7984  MAE: 0.3483  Corr: 0.6598  R_squre: 0.2907 
2024-07-17 10:48:57:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.3701
2024-07-17 10:49:43:INFO:VAL-(cmcm) >>
2024-07-17 10:49:43:INFO:M: >>  Mult_acc_2: 0.7898  Mult_acc_2_weak: 0.6941  Mult_acc_3: 0.7372  Mult_acc_5: 0.4668  F1_score: 0.7920  MAE: 0.3583  Corr: 0.6592  R_squre: 0.2636 
2024-07-17 10:51:26:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.3694
2024-07-17 10:52:13:INFO:VAL-(cmcm) >>
2024-07-17 10:52:13:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.6510  Mult_acc_3: 0.7326  Mult_acc_5: 0.4791  F1_score: 0.7726  MAE: 0.3657  Corr: 0.6322  R_squre: 0.2259 
2024-07-17 10:53:56:INFO:TRAIN-(cmcm) (9/13/1)>> loss: 0.3678
2024-07-17 10:54:42:INFO:VAL-(cmcm) >>
2024-07-17 10:54:42:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.7589  Mult_acc_5: 0.5008  F1_score: 0.7909  MAE: 0.3530  Corr: 0.6722  R_squre: 0.2638 
2024-07-17 10:56:26:INFO:TRAIN-(cmcm) (10/14/1)>> loss: 0.3656
2024-07-17 10:57:14:INFO:VAL-(cmcm) >>
2024-07-17 10:57:14:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7372  Mult_acc_5: 0.4699  F1_score: 0.8143  MAE: 0.3206  Corr: 0.6983  R_squre: 0.4062 
2024-07-17 10:57:20:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 10:59:06:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.3633
2024-07-17 10:59:52:INFO:VAL-(cmcm) >>
2024-07-17 10:59:52:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.6471  Mult_acc_3: 0.7295  Mult_acc_5: 0.4590  F1_score: 0.7770  MAE: 0.3796  Corr: 0.6665  R_squre: 0.1796 
2024-07-17 11:01:37:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.3631
2024-07-17 11:02:24:INFO:VAL-(cmcm) >>
2024-07-17 11:02:24:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7558  Mult_acc_5: 0.4977  F1_score: 0.8139  MAE: 0.3323  Corr: 0.6682  R_squre: 0.3410 
2024-07-17 11:04:09:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.3605
2024-07-17 11:04:56:INFO:VAL-(cmcm) >>
2024-07-17 11:04:56:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7697  Mult_acc_5: 0.5054  F1_score: 0.8121  MAE: 0.3385  Corr: 0.6935  R_squre: 0.3240 
2024-07-17 11:06:40:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.3601
2024-07-17 11:07:26:INFO:VAL-(cmcm) >>
2024-07-17 11:07:26:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.7604  Mult_acc_5: 0.5054  F1_score: 0.8058  MAE: 0.3345  Corr: 0.6804  R_squre: 0.3242 
2024-07-17 11:09:09:INFO:TRAIN-(cmcm) (5/19/1)>> loss: 0.3572
2024-07-17 11:09:56:INFO:VAL-(cmcm) >>
2024-07-17 11:09:56:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7759  Mult_acc_5: 0.5209  F1_score: 0.8286  MAE: 0.3329  Corr: 0.6816  R_squre: 0.3308 
2024-07-17 11:11:40:INFO:TRAIN-(cmcm) (6/20/1)>> loss: 0.3572
2024-07-17 11:12:27:INFO:VAL-(cmcm) >>
2024-07-17 11:12:27:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7543  Mult_acc_5: 0.4977  F1_score: 0.8076  MAE: 0.3397  Corr: 0.6755  R_squre: 0.3091 
2024-07-17 11:14:11:INFO:TRAIN-(cmcm) (7/21/1)>> loss: 0.3567
2024-07-17 11:14:59:INFO:VAL-(cmcm) >>
2024-07-17 11:14:59:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7558  Mult_acc_5: 0.5008  F1_score: 0.8116  MAE: 0.3413  Corr: 0.6540  R_squre: 0.2947 
2024-07-17 11:16:44:INFO:TRAIN-(cmcm) (8/22/1)>> loss: 0.3554
2024-07-17 11:17:32:INFO:VAL-(cmcm) >>
2024-07-17 11:17:32:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.7434  Mult_acc_5: 0.4838  F1_score: 0.8163  MAE: 0.3236  Corr: 0.6882  R_squre: 0.3757 
2024-07-17 11:19:16:INFO:TRAIN-(cmcm) (9/23/1)>> loss: 0.3531
2024-07-17 11:20:03:INFO:VAL-(cmcm) >>
2024-07-17 11:20:03:INFO:M: >>  Mult_acc_2: 0.7512  Mult_acc_2_weak: 0.6235  Mult_acc_3: 0.7249  Mult_acc_5: 0.4683  F1_score: 0.7529  MAE: 0.3811  Corr: 0.6320  R_squre: 0.1610 
2024-07-17 11:21:49:INFO:TRAIN-(cmcm) (10/24/1)>> loss: 0.3515
2024-07-17 11:22:36:INFO:VAL-(cmcm) >>
2024-07-17 11:22:36:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7620  Mult_acc_5: 0.5054  F1_score: 0.8166  MAE: 0.3193  Corr: 0.6888  R_squre: 0.3886 
2024-07-17 11:22:43:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 11:24:29:INFO:TRAIN-(cmcm) (1/25/1)>> loss: 0.3492
2024-07-17 11:25:16:INFO:VAL-(cmcm) >>
2024-07-17 11:25:16:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7790  Mult_acc_5: 0.5178  F1_score: 0.8340  MAE: 0.3209  Corr: 0.6852  R_squre: 0.3752 
2024-07-17 11:27:02:INFO:TRAIN-(cmcm) (2/26/1)>> loss: 0.3489
2024-07-17 11:27:49:INFO:VAL-(cmcm) >>
2024-07-17 11:27:49:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7125  Mult_acc_5: 0.4699  F1_score: 0.8089  MAE: 0.3088  Corr: 0.7103  R_squre: 0.4477 
2024-07-17 11:27:55:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 11:29:47:INFO:TRAIN-(cmcm) (1/27/1)>> loss: 0.3479
2024-07-17 11:30:36:INFO:VAL-(cmcm) >>
2024-07-17 11:30:36:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7604  Mult_acc_5: 0.5008  F1_score: 0.8310  MAE: 0.3178  Corr: 0.6870  R_squre: 0.3847 
2024-07-17 11:32:23:INFO:TRAIN-(cmcm) (2/28/1)>> loss: 0.3451
2024-07-17 11:33:12:INFO:VAL-(cmcm) >>
2024-07-17 11:33:12:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7573  Mult_acc_5: 0.4961  F1_score: 0.8121  MAE: 0.3314  Corr: 0.6716  R_squre: 0.3300 
2024-07-17 11:35:01:INFO:TRAIN-(cmcm) (3/29/1)>> loss: 0.3460
2024-07-17 11:35:50:INFO:VAL-(cmcm) >>
2024-07-17 11:35:50:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7713  Mult_acc_5: 0.5178  F1_score: 0.8274  MAE: 0.3275  Corr: 0.6883  R_squre: 0.3526 
2024-07-17 11:37:36:INFO:TRAIN-(cmcm) (4/30/1)>> loss: 0.3431
2024-07-17 11:38:25:INFO:VAL-(cmcm) >>
2024-07-17 11:38:25:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7403  Mult_acc_5: 0.4884  F1_score: 0.8200  MAE: 0.3150  Corr: 0.6863  R_squre: 0.4079 
2024-07-17 11:40:12:INFO:TRAIN-(cmcm) (5/31/1)>> loss: 0.3408
2024-07-17 11:40:58:INFO:VAL-(cmcm) >>
2024-07-17 11:40:58:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7573  Mult_acc_5: 0.5023  F1_score: 0.8239  MAE: 0.3275  Corr: 0.6845  R_squre: 0.3546 
2024-07-17 11:42:46:INFO:TRAIN-(cmcm) (6/32/1)>> loss: 0.3382
2024-07-17 11:43:33:INFO:VAL-(cmcm) >>
2024-07-17 11:43:33:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.7403  Mult_acc_5: 0.4884  F1_score: 0.8177  MAE: 0.3246  Corr: 0.6901  R_squre: 0.3745 
2024-07-17 11:45:20:INFO:TRAIN-(cmcm) (7/33/1)>> loss: 0.3355
2024-07-17 11:46:08:INFO:VAL-(cmcm) >>
2024-07-17 11:46:08:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7697  Mult_acc_5: 0.5162  F1_score: 0.8373  MAE: 0.3144  Corr: 0.6997  R_squre: 0.3954 
2024-07-17 11:47:53:INFO:TRAIN-(cmcm) (8/34/1)>> loss: 0.3286
2024-07-17 11:48:40:INFO:VAL-(cmcm) >>
2024-07-17 11:48:40:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7434  Mult_acc_5: 0.4930  F1_score: 0.8383  MAE: 0.3113  Corr: 0.7002  R_squre: 0.4154 
2024-07-17 11:50:26:INFO:TRAIN-(cmcm) (9/35/1)>> loss: 0.3213
2024-07-17 11:51:12:INFO:VAL-(cmcm) >>
2024-07-17 11:51:12:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7635  Mult_acc_5: 0.5147  F1_score: 0.8426  MAE: 0.3008  Corr: 0.7137  R_squre: 0.4470 
2024-07-17 11:51:19:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 11:53:06:INFO:TRAIN-(cmcm) (1/36/1)>> loss: 0.3180
2024-07-17 11:53:53:INFO:VAL-(cmcm) >>
2024-07-17 11:53:53:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7713  Mult_acc_5: 0.5224  F1_score: 0.8413  MAE: 0.2930  Corr: 0.7202  R_squre: 0.4757 
2024-07-17 11:53:59:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 11:55:51:INFO:TRAIN-(cmcm) (1/37/1)>> loss: 0.3126
2024-07-17 11:56:39:INFO:VAL-(cmcm) >>
2024-07-17 11:56:39:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7264  Mult_acc_5: 0.4915  F1_score: 0.8238  MAE: 0.3085  Corr: 0.6904  R_squre: 0.4210 
2024-07-17 11:58:29:INFO:TRAIN-(cmcm) (2/38/1)>> loss: 0.3117
2024-07-17 11:59:16:INFO:VAL-(cmcm) >>
2024-07-17 11:59:16:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7512  Mult_acc_5: 0.5286  F1_score: 0.8147  MAE: 0.3308  Corr: 0.6753  R_squre: 0.3252 
2024-07-17 12:01:05:INFO:TRAIN-(cmcm) (3/39/1)>> loss: 0.3064
2024-07-17 12:01:55:INFO:VAL-(cmcm) >>
2024-07-17 12:01:55:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7558  Mult_acc_5: 0.5270  F1_score: 0.8363  MAE: 0.3088  Corr: 0.6966  R_squre: 0.4079 
2024-07-17 12:03:45:INFO:TRAIN-(cmcm) (4/40/1)>> loss: 0.3037
2024-07-17 12:04:33:INFO:VAL-(cmcm) >>
2024-07-17 12:04:33:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7589  Mult_acc_5: 0.5332  F1_score: 0.8363  MAE: 0.3150  Corr: 0.6906  R_squre: 0.3780 
2024-07-17 12:06:21:INFO:TRAIN-(cmcm) (5/41/1)>> loss: 0.3005
2024-07-17 12:07:10:INFO:VAL-(cmcm) >>
2024-07-17 12:07:10:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7311  Mult_acc_5: 0.5085  F1_score: 0.8156  MAE: 0.3029  Corr: 0.7082  R_squre: 0.4516 
2024-07-17 12:09:00:INFO:TRAIN-(cmcm) (6/42/1)>> loss: 0.3002
2024-07-17 12:09:47:INFO:VAL-(cmcm) >>
2024-07-17 12:09:47:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.6677  Mult_acc_5: 0.4606  F1_score: 0.7974  MAE: 0.3209  Corr: 0.6744  R_squre: 0.4169 
2024-07-17 12:11:35:INFO:TRAIN-(cmcm) (7/43/1)>> loss: 0.2968
2024-07-17 12:12:24:INFO:VAL-(cmcm) >>
2024-07-17 12:12:24:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7388  Mult_acc_5: 0.5070  F1_score: 0.8263  MAE: 0.2918  Corr: 0.7245  R_squre: 0.4872 
2024-07-17 12:12:31:INFO:Saving checkpoint at epoch 43 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 12:14:21:INFO:TRAIN-(cmcm) (1/44/1)>> loss: 0.2950
2024-07-17 12:15:10:INFO:VAL-(cmcm) >>
2024-07-17 12:15:10:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7342  Mult_acc_5: 0.5070  F1_score: 0.8247  MAE: 0.3045  Corr: 0.7009  R_squre: 0.4300 
2024-07-17 12:16:58:INFO:TRAIN-(cmcm) (2/45/1)>> loss: 0.2930
2024-07-17 12:17:46:INFO:VAL-(cmcm) >>
2024-07-17 12:17:46:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7573  Mult_acc_5: 0.5178  F1_score: 0.8303  MAE: 0.3076  Corr: 0.7003  R_squre: 0.4117 
2024-07-17 12:19:34:INFO:TRAIN-(cmcm) (3/46/1)>> loss: 0.2898
2024-07-17 12:20:24:INFO:VAL-(cmcm) >>
2024-07-17 12:20:24:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7388  Mult_acc_5: 0.5039  F1_score: 0.8312  MAE: 0.2974  Corr: 0.7183  R_squre: 0.4560 
2024-07-17 12:22:10:INFO:TRAIN-(cmcm) (4/47/1)>> loss: 0.2878
2024-07-17 12:22:58:INFO:VAL-(cmcm) >>
2024-07-17 12:22:58:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7218  Mult_acc_5: 0.4884  F1_score: 0.8245  MAE: 0.3110  Corr: 0.6976  R_squre: 0.4057 
2024-07-17 12:24:48:INFO:TRAIN-(cmcm) (5/48/1)>> loss: 0.2840
2024-07-17 12:25:37:INFO:VAL-(cmcm) >>
2024-07-17 12:25:37:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7419  Mult_acc_5: 0.5193  F1_score: 0.8345  MAE: 0.2924  Corr: 0.7242  R_squre: 0.4781 
2024-07-17 12:27:25:INFO:TRAIN-(cmcm) (6/49/1)>> loss: 0.2818
2024-07-17 12:28:13:INFO:VAL-(cmcm) >>
2024-07-17 12:28:13:INFO:M: >>  Mult_acc_2: 0.8331  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7496  Mult_acc_5: 0.5162  F1_score: 0.8317  MAE: 0.2961  Corr: 0.7163  R_squre: 0.4577 
2024-07-17 12:30:00:INFO:TRAIN-(cmcm) (7/50/1)>> loss: 0.2789
2024-07-17 12:30:49:INFO:VAL-(cmcm) >>
2024-07-17 12:30:49:INFO:M: >>  Mult_acc_2: 0.8362  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7666  Mult_acc_5: 0.5178  F1_score: 0.8357  MAE: 0.2915  Corr: 0.7267  R_squre: 0.4843 
2024-07-17 12:30:54:INFO:Saving checkpoint at epoch 50 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 12:32:44:INFO:TRAIN-(cmcm) (1/51/1)>> loss: 0.2757
2024-07-17 12:33:32:INFO:VAL-(cmcm) >>
2024-07-17 12:33:32:INFO:M: >>  Mult_acc_2: 0.8439  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7651  Mult_acc_5: 0.5224  F1_score: 0.8427  MAE: 0.2869  Corr: 0.7280  R_squre: 0.4916 
2024-07-17 12:33:40:INFO:Saving checkpoint at epoch 51 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 12:35:29:INFO:TRAIN-(cmcm) (1/52/1)>> loss: 0.2733
2024-07-17 12:36:16:INFO:VAL-(cmcm) >>
2024-07-17 12:36:16:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7434  Mult_acc_5: 0.5131  F1_score: 0.8269  MAE: 0.2998  Corr: 0.7128  R_squre: 0.4424 
2024-07-17 12:38:05:INFO:TRAIN-(cmcm) (2/53/1)>> loss: 0.2710
2024-07-17 12:38:52:INFO:VAL-(cmcm) >>
2024-07-17 12:38:52:INFO:M: >>  Mult_acc_2: 0.8346  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7465  Mult_acc_5: 0.5054  F1_score: 0.8311  MAE: 0.2881  Corr: 0.7272  R_squre: 0.5025 
2024-07-17 12:40:40:INFO:TRAIN-(cmcm) (3/54/1)>> loss: 0.2672
2024-07-17 12:41:28:INFO:VAL-(cmcm) >>
2024-07-17 12:41:28:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7465  Mult_acc_5: 0.5039  F1_score: 0.8288  MAE: 0.2909  Corr: 0.7284  R_squre: 0.4925 
2024-07-17 12:43:17:INFO:TRAIN-(cmcm) (4/55/1)>> loss: 0.2639
2024-07-17 12:44:06:INFO:VAL-(cmcm) >>
2024-07-17 12:44:06:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7372  Mult_acc_5: 0.5008  F1_score: 0.8212  MAE: 0.3017  Corr: 0.7165  R_squre: 0.4621 
2024-07-17 12:45:54:INFO:TRAIN-(cmcm) (5/56/1)>> loss: 0.2623
2024-07-17 12:46:43:INFO:VAL-(cmcm) >>
2024-07-17 12:46:43:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7604  Mult_acc_5: 0.5348  F1_score: 0.8287  MAE: 0.2937  Corr: 0.7255  R_squre: 0.4601 
2024-07-17 12:48:29:INFO:TRAIN-(cmcm) (6/57/1)>> loss: 0.2596
2024-07-17 12:49:17:INFO:VAL-(cmcm) >>
2024-07-17 12:49:17:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7496  Mult_acc_5: 0.5116  F1_score: 0.8302  MAE: 0.2995  Corr: 0.7155  R_squre: 0.4460 
2024-07-17 12:51:05:INFO:TRAIN-(cmcm) (7/58/1)>> loss: 0.2563
2024-07-17 12:51:52:INFO:VAL-(cmcm) >>
2024-07-17 12:51:52:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7496  Mult_acc_5: 0.5131  F1_score: 0.8225  MAE: 0.2971  Corr: 0.7199  R_squre: 0.4653 
2024-07-17 12:53:41:INFO:TRAIN-(cmcm) (8/59/1)>> loss: 0.2546
2024-07-17 12:54:28:INFO:VAL-(cmcm) >>
2024-07-17 12:54:28:INFO:M: >>  Mult_acc_2: 0.8315  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7573  Mult_acc_5: 0.5270  F1_score: 0.8308  MAE: 0.2940  Corr: 0.7197  R_squre: 0.4585 
2024-07-17 12:56:16:INFO:TRAIN-(cmcm) (9/60/1)>> loss: 0.2521
2024-07-17 12:57:05:INFO:VAL-(cmcm) >>
2024-07-17 12:57:05:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7496  Mult_acc_5: 0.5147  F1_score: 0.8253  MAE: 0.2998  Corr: 0.7093  R_squre: 0.4363 
2024-07-17 12:58:53:INFO:TRAIN-(cmcm) (10/61/1)>> loss: 0.2490
2024-07-17 12:59:40:INFO:VAL-(cmcm) >>
2024-07-17 12:59:40:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7604  Mult_acc_5: 0.5224  F1_score: 0.8374  MAE: 0.2930  Corr: 0.7216  R_squre: 0.4580 
2024-07-17 13:00:55:INFO:TEST-(cmcm) >>
2024-07-17 13:00:55:INFO:M: >>  Mult_acc_2: 0.8066  Mult_acc_2_weak: 0.7164  Mult_acc_3: 0.7602  Mult_acc_5: 0.5667  F1_score: 0.8037  MAE: 0.2952  Corr: 0.6979  R_squre: 0.4011 
2024-07-17 13:00:56:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 13:00:56:INFO:Start running cmcm...
2024-07-17 13:00:56:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 2222}>
2024-07-17 13:00:56:INFO:Let's use the GPU 1 !
2024-07-17 13:00:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 13:00:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721192459 HTTP/1.1" 200 280
2024-07-17 13:00:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 13:00:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 13:01:00:INFO:train samples: (2722,)
2024-07-17 13:01:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 13:01:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721192462 HTTP/1.1" 200 280
2024-07-17 13:01:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 13:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 13:01:03:INFO:valid samples: (647,)
2024-07-17 13:01:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 13:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721192465 HTTP/1.1" 200 280
2024-07-17 13:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 13:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 13:01:06:INFO:test samples: (1034,)
2024-07-17 13:01:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 13:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721192466 HTTP/1.1" 200 280
2024-07-17 13:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 13:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 13:01:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 13:01:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721192476 HTTP/1.1" 200 280
2024-07-17 13:01:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 13:01:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 13:01:18:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 13:01:18:INFO:Init labels...
2024-07-17 13:01:18:INFO:Start training...
2024-07-17 13:03:06:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.4704
2024-07-17 13:03:55:INFO:VAL-(cmcm) >>
2024-07-17 13:03:55:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1113  Mult_acc_5: 0.1036  F1_score: 0.4710  MAE: 0.5330  Corr: 0.1411  R_squre: -0.0008 
2024-07-17 13:04:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:05:49:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.4222
2024-07-17 13:06:37:INFO:VAL-(cmcm) >>
2024-07-17 13:06:37:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.1144  Mult_acc_5: 0.1036  F1_score: 0.4703  MAE: 0.5322  Corr: 0.1449  R_squre: 0.0024 
2024-07-17 13:06:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:08:32:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 1.0005
2024-07-17 13:09:19:INFO:VAL-(cmcm) >>
2024-07-17 13:09:19:INFO:M: >>  Mult_acc_2: 0.6352  Mult_acc_2_weak: 0.6588  Mult_acc_3: 0.4776  Mult_acc_5: 0.3107  F1_score: 0.5326  MAE: 0.4428  Corr: 0.5123  R_squre: 0.2462 
2024-07-17 13:09:24:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:11:13:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.4511
2024-07-17 13:12:01:INFO:VAL-(cmcm) >>
2024-07-17 13:12:01:INFO:M: >>  Mult_acc_2: 0.7048  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.5379  Mult_acc_5: 0.3478  F1_score: 0.6620  MAE: 0.3737  Corr: 0.6159  R_squre: 0.3791 
2024-07-17 13:12:07:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:13:57:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.3880
2024-07-17 13:14:45:INFO:VAL-(cmcm) >>
2024-07-17 13:14:45:INFO:M: >>  Mult_acc_2: 0.7450  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6121  Mult_acc_5: 0.3740  F1_score: 0.7166  MAE: 0.3499  Corr: 0.6482  R_squre: 0.4128 
2024-07-17 13:14:52:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:16:41:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.3815
2024-07-17 13:17:31:INFO:VAL-(cmcm) >>
2024-07-17 13:17:31:INFO:M: >>  Mult_acc_2: 0.7372  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.5951  Mult_acc_5: 0.3849  F1_score: 0.7013  MAE: 0.3459  Corr: 0.6446  R_squre: 0.4059 
2024-07-17 13:17:38:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:19:27:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.3775
2024-07-17 13:20:17:INFO:VAL-(cmcm) >>
2024-07-17 13:20:17:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.6677  Mult_acc_5: 0.4281  F1_score: 0.7744  MAE: 0.3277  Corr: 0.6718  R_squre: 0.4424 
2024-07-17 13:20:23:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:22:13:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.3751
2024-07-17 13:23:02:INFO:VAL-(cmcm) >>
2024-07-17 13:23:02:INFO:M: >>  Mult_acc_2: 0.7975  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6878  Mult_acc_5: 0.4451  F1_score: 0.7863  MAE: 0.3184  Corr: 0.6812  R_squre: 0.4458 
2024-07-17 13:23:09:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:24:58:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.3730
2024-07-17 13:25:47:INFO:VAL-(cmcm) >>
2024-07-17 13:25:47:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.6893  Mult_acc_5: 0.4436  F1_score: 0.7928  MAE: 0.3147  Corr: 0.6892  R_squre: 0.4641 
2024-07-17 13:25:54:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:27:43:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.3699
2024-07-17 13:28:32:INFO:VAL-(cmcm) >>
2024-07-17 13:28:33:INFO:M: >>  Mult_acc_2: 0.7434  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6074  Mult_acc_5: 0.3864  F1_score: 0.7108  MAE: 0.3360  Corr: 0.6698  R_squre: 0.4392 
2024-07-17 13:30:22:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.3685
2024-07-17 13:31:11:INFO:VAL-(cmcm) >>
2024-07-17 13:31:11:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6971  Mult_acc_5: 0.4590  F1_score: 0.7985  MAE: 0.3088  Corr: 0.6993  R_squre: 0.4779 
2024-07-17 13:31:17:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:33:06:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.3654
2024-07-17 13:33:55:INFO:VAL-(cmcm) >>
2024-07-17 13:33:55:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.6522  Mult_acc_5: 0.4250  F1_score: 0.7674  MAE: 0.3122  Corr: 0.6981  R_squre: 0.4842 
2024-07-17 13:35:43:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.3635
2024-07-17 13:36:33:INFO:VAL-(cmcm) >>
2024-07-17 13:36:33:INFO:M: >>  Mult_acc_2: 0.7913  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.6770  Mult_acc_5: 0.4436  F1_score: 0.7760  MAE: 0.3131  Corr: 0.6997  R_squre: 0.4786 
2024-07-17 13:38:20:INFO:TRAIN-(cmcm) (3/14/2)>> loss: 0.3618
2024-07-17 13:39:09:INFO:VAL-(cmcm) >>
2024-07-17 13:39:09:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6801  Mult_acc_5: 0.4575  F1_score: 0.7950  MAE: 0.3045  Corr: 0.7103  R_squre: 0.4921 
2024-07-17 13:39:16:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:41:05:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.3531
2024-07-17 13:41:55:INFO:VAL-(cmcm) >>
2024-07-17 13:41:55:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7218  Mult_acc_5: 0.4869  F1_score: 0.8033  MAE: 0.2989  Corr: 0.7139  R_squre: 0.4877 
2024-07-17 13:42:02:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:43:51:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.3438
2024-07-17 13:44:40:INFO:VAL-(cmcm) >>
2024-07-17 13:44:40:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7264  Mult_acc_5: 0.4900  F1_score: 0.7882  MAE: 0.3039  Corr: 0.7245  R_squre: 0.4925 
2024-07-17 13:46:28:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.3382
2024-07-17 13:47:17:INFO:VAL-(cmcm) >>
2024-07-17 13:47:17:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.6862  Mult_acc_5: 0.4544  F1_score: 0.7982  MAE: 0.3020  Corr: 0.7198  R_squre: 0.5006 
2024-07-17 13:49:05:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.3348
2024-07-17 13:49:53:INFO:VAL-(cmcm) >>
2024-07-17 13:49:53:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7063  Mult_acc_5: 0.4853  F1_score: 0.8102  MAE: 0.2961  Corr: 0.7229  R_squre: 0.5120 
2024-07-17 13:49:59:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:51:49:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.3304
2024-07-17 13:52:37:INFO:VAL-(cmcm) >>
2024-07-17 13:52:37:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6662  Mult_acc_5: 0.4482  F1_score: 0.7688  MAE: 0.3076  Corr: 0.7211  R_squre: 0.5135 
2024-07-17 13:54:26:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.3281
2024-07-17 13:55:15:INFO:VAL-(cmcm) >>
2024-07-17 13:55:15:INFO:M: >>  Mult_acc_2: 0.8423  Mult_acc_2_weak: 0.8000  Mult_acc_3: 0.7326  Mult_acc_5: 0.4900  F1_score: 0.8395  MAE: 0.2878  Corr: 0.7415  R_squre: 0.5336 
2024-07-17 13:55:21:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 13:57:11:INFO:TRAIN-(cmcm) (1/21/2)>> loss: 0.3252
2024-07-17 13:57:59:INFO:VAL-(cmcm) >>
2024-07-17 13:57:59:INFO:M: >>  Mult_acc_2: 0.7913  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6862  Mult_acc_5: 0.4637  F1_score: 0.7764  MAE: 0.2980  Corr: 0.7340  R_squre: 0.5290 
2024-07-17 13:59:49:INFO:TRAIN-(cmcm) (2/22/2)>> loss: 0.3226
2024-07-17 14:00:38:INFO:VAL-(cmcm) >>
2024-07-17 14:00:38:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.6584  Mult_acc_5: 0.4250  F1_score: 0.7722  MAE: 0.3122  Corr: 0.7151  R_squre: 0.4828 
2024-07-17 14:02:27:INFO:TRAIN-(cmcm) (3/23/2)>> loss: 0.3202
2024-07-17 14:03:16:INFO:VAL-(cmcm) >>
2024-07-17 14:03:16:INFO:M: >>  Mult_acc_2: 0.7682  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6399  Mult_acc_5: 0.4343  F1_score: 0.7446  MAE: 0.3091  Corr: 0.7175  R_squre: 0.5052 
2024-07-17 14:05:04:INFO:TRAIN-(cmcm) (4/24/2)>> loss: 0.3169
2024-07-17 14:05:53:INFO:VAL-(cmcm) >>
2024-07-17 14:05:53:INFO:M: >>  Mult_acc_2: 0.7651  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6770  Mult_acc_5: 0.4420  F1_score: 0.7406  MAE: 0.3168  Corr: 0.7137  R_squre: 0.4657 
2024-07-17 14:07:42:INFO:TRAIN-(cmcm) (5/25/2)>> loss: 0.3161
2024-07-17 14:08:31:INFO:VAL-(cmcm) >>
2024-07-17 14:08:31:INFO:M: >>  Mult_acc_2: 0.7342  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.5657  Mult_acc_5: 0.3910  F1_score: 0.6978  MAE: 0.3292  Corr: 0.6812  R_squre: 0.4616 
2024-07-17 14:10:22:INFO:TRAIN-(cmcm) (6/26/2)>> loss: 0.3126
2024-07-17 14:11:12:INFO:VAL-(cmcm) >>
2024-07-17 14:11:12:INFO:M: >>  Mult_acc_2: 0.7805  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6893  Mult_acc_5: 0.4668  F1_score: 0.7616  MAE: 0.3097  Corr: 0.7136  R_squre: 0.4709 
2024-07-17 14:13:04:INFO:TRAIN-(cmcm) (7/27/2)>> loss: 0.3094
2024-07-17 14:13:52:INFO:VAL-(cmcm) >>
2024-07-17 14:13:52:INFO:M: >>  Mult_acc_2: 0.7635  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6600  Mult_acc_5: 0.4297  F1_score: 0.7404  MAE: 0.3178  Corr: 0.7035  R_squre: 0.4611 
2024-07-17 14:15:45:INFO:TRAIN-(cmcm) (8/28/2)>> loss: 0.3084
2024-07-17 14:16:34:INFO:VAL-(cmcm) >>
2024-07-17 14:16:34:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7063  Mult_acc_5: 0.4776  F1_score: 0.8061  MAE: 0.2884  Corr: 0.7419  R_squre: 0.5298 
2024-07-17 14:18:25:INFO:TRAIN-(cmcm) (9/29/2)>> loss: 0.3047
2024-07-17 14:19:13:INFO:VAL-(cmcm) >>
2024-07-17 14:19:13:INFO:M: >>  Mult_acc_2: 0.7666  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6476  Mult_acc_5: 0.4189  F1_score: 0.7432  MAE: 0.3172  Corr: 0.7014  R_squre: 0.4529 
2024-07-17 14:21:05:INFO:TRAIN-(cmcm) (10/30/2)>> loss: 0.3033
2024-07-17 14:21:54:INFO:VAL-(cmcm) >>
2024-07-17 14:21:54:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6754  Mult_acc_5: 0.4498  F1_score: 0.7526  MAE: 0.3026  Corr: 0.7284  R_squre: 0.5067 
2024-07-17 14:23:11:INFO:TEST-(cmcm) >>
2024-07-17 14:23:11:INFO:M: >>  Mult_acc_2: 0.8008  Mult_acc_2_weak: 0.7226  Mult_acc_3: 0.7176  Mult_acc_5: 0.5232  F1_score: 0.7960  MAE: 0.2897  Corr: 0.7133  R_squre: 0.4635 
2024-07-17 14:23:11:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 14:23:11:INFO:Start running cmcm...
2024-07-17 14:23:11:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 3333}>
2024-07-17 14:23:11:INFO:Let's use the GPU 1 !
2024-07-17 14:23:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 14:23:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721197393 HTTP/1.1" 200 280
2024-07-17 14:23:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 14:23:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 14:23:15:INFO:train samples: (2722,)
2024-07-17 14:23:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 14:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721197398 HTTP/1.1" 200 280
2024-07-17 14:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 14:23:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 14:23:19:INFO:valid samples: (647,)
2024-07-17 14:23:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 14:23:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721197401 HTTP/1.1" 200 280
2024-07-17 14:23:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 14:23:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 14:23:22:INFO:test samples: (1034,)
2024-07-17 14:23:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 14:23:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721197403 HTTP/1.1" 200 280
2024-07-17 14:23:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 14:23:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 14:23:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 14:23:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721197414 HTTP/1.1" 200 280
2024-07-17 14:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 14:23:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 14:23:36:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 14:23:36:INFO:Init labels...
2024-07-17 14:23:36:INFO:Start training...
2024-07-17 14:25:31:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.4420
2024-07-17 14:26:22:INFO:VAL-(cmcm) >>
2024-07-17 14:26:22:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.1128  Mult_acc_5: 0.1051  F1_score: 0.4648  MAE: 0.5328  Corr: 0.1389  R_squre: -0.0001 
2024-07-17 14:26:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:28:22:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.3525
2024-07-17 14:29:10:INFO:VAL-(cmcm) >>
2024-07-17 14:29:10:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.1314  Mult_acc_5: 0.1190  F1_score: 0.4816  MAE: 0.5301  Corr: 0.1093  R_squre: -0.0154 
2024-07-17 14:29:16:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:31:06:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.7557
2024-07-17 14:31:55:INFO:VAL-(cmcm) >>
2024-07-17 14:31:55:INFO:M: >>  Mult_acc_2: 0.6306  Mult_acc_2_weak: 0.6824  Mult_acc_3: 0.3957  Mult_acc_5: 0.2612  F1_score: 0.5297  MAE: 0.4577  Corr: 0.4454  R_squre: 0.1924 
2024-07-17 14:32:01:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:33:53:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.5345
2024-07-17 14:34:42:INFO:VAL-(cmcm) >>
2024-07-17 14:34:42:INFO:M: >>  Mult_acc_2: 0.7898  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7125  Mult_acc_5: 0.4389  F1_score: 0.7888  MAE: 0.3668  Corr: 0.6142  R_squre: 0.2517 
2024-07-17 14:34:48:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:36:39:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.4120
2024-07-17 14:37:27:INFO:VAL-(cmcm) >>
2024-07-17 14:37:27:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7295  Mult_acc_5: 0.4575  F1_score: 0.7869  MAE: 0.3796  Corr: 0.5935  R_squre: 0.1870 
2024-07-17 14:39:16:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.3899
2024-07-17 14:40:05:INFO:VAL-(cmcm) >>
2024-07-17 14:40:05:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.7020  Mult_acc_3: 0.7202  Mult_acc_5: 0.4575  F1_score: 0.7883  MAE: 0.3703  Corr: 0.6039  R_squre: 0.2210 
2024-07-17 14:41:53:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.3812
2024-07-17 14:42:42:INFO:VAL-(cmcm) >>
2024-07-17 14:42:42:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6980  Mult_acc_3: 0.7156  Mult_acc_5: 0.4544  F1_score: 0.7884  MAE: 0.3716  Corr: 0.6289  R_squre: 0.2020 
2024-07-17 14:44:30:INFO:TRAIN-(cmcm) (4/8/3)>> loss: 0.3750
2024-07-17 14:45:20:INFO:VAL-(cmcm) >>
2024-07-17 14:45:20:INFO:M: >>  Mult_acc_2: 0.7805  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.7264  Mult_acc_5: 0.4807  F1_score: 0.7833  MAE: 0.3731  Corr: 0.6209  R_squre: 0.1814 
2024-07-17 14:47:08:INFO:TRAIN-(cmcm) (5/9/3)>> loss: 0.3706
2024-07-17 14:47:57:INFO:VAL-(cmcm) >>
2024-07-17 14:47:57:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7728  Mult_acc_5: 0.5054  F1_score: 0.8209  MAE: 0.3400  Corr: 0.6826  R_squre: 0.3096 
2024-07-17 14:48:03:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:49:53:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.3662
2024-07-17 14:50:41:INFO:VAL-(cmcm) >>
2024-07-17 14:50:41:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7589  Mult_acc_5: 0.5085  F1_score: 0.8233  MAE: 0.3338  Corr: 0.6801  R_squre: 0.3317 
2024-07-17 14:50:47:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 14:52:38:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.3632
2024-07-17 14:53:27:INFO:VAL-(cmcm) >>
2024-07-17 14:53:27:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.7543  Mult_acc_5: 0.4961  F1_score: 0.8030  MAE: 0.3515  Corr: 0.6561  R_squre: 0.2419 
2024-07-17 14:55:15:INFO:TRAIN-(cmcm) (2/12/3)>> loss: 0.3611
2024-07-17 14:56:05:INFO:VAL-(cmcm) >>
2024-07-17 14:56:05:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7543  Mult_acc_5: 0.5039  F1_score: 0.8120  MAE: 0.3459  Corr: 0.6543  R_squre: 0.2626 
2024-07-17 14:57:53:INFO:TRAIN-(cmcm) (3/13/3)>> loss: 0.3579
2024-07-17 14:58:42:INFO:VAL-(cmcm) >>
2024-07-17 14:58:42:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7543  Mult_acc_5: 0.5224  F1_score: 0.8302  MAE: 0.3147  Corr: 0.6926  R_squre: 0.3911 
2024-07-17 14:58:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:00:38:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.3559
2024-07-17 15:01:26:INFO:VAL-(cmcm) >>
2024-07-17 15:01:26:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7589  Mult_acc_5: 0.4606  F1_score: 0.8307  MAE: 0.3440  Corr: 0.6980  R_squre: 0.3010 
2024-07-17 15:03:15:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.3539
2024-07-17 15:04:02:INFO:VAL-(cmcm) >>
2024-07-17 15:04:02:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.7264  Mult_acc_5: 0.4853  F1_score: 0.8212  MAE: 0.3295  Corr: 0.6818  R_squre: 0.3544 
2024-07-17 15:05:49:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.3542
2024-07-17 15:06:38:INFO:VAL-(cmcm) >>
2024-07-17 15:06:38:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7527  Mult_acc_5: 0.4900  F1_score: 0.8188  MAE: 0.3338  Corr: 0.6887  R_squre: 0.3436 
2024-07-17 15:08:26:INFO:TRAIN-(cmcm) (4/17/3)>> loss: 0.3511
2024-07-17 15:09:14:INFO:VAL-(cmcm) >>
2024-07-17 15:09:14:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7589  Mult_acc_5: 0.5085  F1_score: 0.8292  MAE: 0.3172  Corr: 0.7071  R_squre: 0.4091 
2024-07-17 15:11:02:INFO:TRAIN-(cmcm) (5/18/3)>> loss: 0.3493
2024-07-17 15:11:51:INFO:VAL-(cmcm) >>
2024-07-17 15:11:51:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7419  Mult_acc_5: 0.4822  F1_score: 0.8271  MAE: 0.3252  Corr: 0.6923  R_squre: 0.3741 
2024-07-17 15:13:40:INFO:TRAIN-(cmcm) (6/19/3)>> loss: 0.3475
2024-07-17 15:14:29:INFO:VAL-(cmcm) >>
2024-07-17 15:14:29:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7233  Mult_acc_5: 0.4668  F1_score: 0.8161  MAE: 0.3394  Corr: 0.6724  R_squre: 0.3191 
2024-07-17 15:16:17:INFO:TRAIN-(cmcm) (7/20/3)>> loss: 0.3470
2024-07-17 15:17:05:INFO:VAL-(cmcm) >>
2024-07-17 15:17:05:INFO:M: >>  Mult_acc_2: 0.8238  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7419  Mult_acc_5: 0.4992  F1_score: 0.8206  MAE: 0.3147  Corr: 0.7076  R_squre: 0.4230 
2024-07-17 15:18:51:INFO:TRAIN-(cmcm) (8/21/3)>> loss: 0.3430
2024-07-17 15:19:39:INFO:VAL-(cmcm) >>
2024-07-17 15:19:39:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7264  Mult_acc_5: 0.4838  F1_score: 0.8159  MAE: 0.3206  Corr: 0.7097  R_squre: 0.4032 
2024-07-17 15:21:27:INFO:TRAIN-(cmcm) (9/22/3)>> loss: 0.3354
2024-07-17 15:22:16:INFO:VAL-(cmcm) >>
2024-07-17 15:22:16:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7187  Mult_acc_5: 0.4606  F1_score: 0.8134  MAE: 0.3206  Corr: 0.7115  R_squre: 0.4229 
2024-07-17 15:24:05:INFO:TRAIN-(cmcm) (10/23/3)>> loss: 0.3292
2024-07-17 15:24:55:INFO:VAL-(cmcm) >>
2024-07-17 15:24:55:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.6816  Mult_acc_5: 0.4822  F1_score: 0.8033  MAE: 0.3141  Corr: 0.6945  R_squre: 0.4441 
2024-07-17 15:25:01:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:26:51:INFO:TRAIN-(cmcm) (1/24/3)>> loss: 0.3250
2024-07-17 15:27:42:INFO:VAL-(cmcm) >>
2024-07-17 15:27:42:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.6971  Mult_acc_5: 0.4807  F1_score: 0.8159  MAE: 0.3138  Corr: 0.6956  R_squre: 0.4208 
2024-07-17 15:27:48:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:29:37:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.3211
2024-07-17 15:30:26:INFO:VAL-(cmcm) >>
2024-07-17 15:30:26:INFO:M: >>  Mult_acc_2: 0.8300  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7450  Mult_acc_5: 0.4961  F1_score: 0.8275  MAE: 0.3100  Corr: 0.7184  R_squre: 0.4337 
2024-07-17 15:30:33:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:32:22:INFO:TRAIN-(cmcm) (1/26/3)>> loss: 0.3188
2024-07-17 15:33:11:INFO:VAL-(cmcm) >>
2024-07-17 15:33:11:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7110  Mult_acc_5: 0.5039  F1_score: 0.8189  MAE: 0.3141  Corr: 0.6887  R_squre: 0.4078 
2024-07-17 15:35:00:INFO:TRAIN-(cmcm) (2/27/3)>> loss: 0.3164
2024-07-17 15:35:48:INFO:VAL-(cmcm) >>
2024-07-17 15:35:48:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7311  Mult_acc_5: 0.5070  F1_score: 0.8221  MAE: 0.3060  Corr: 0.7122  R_squre: 0.4414 
2024-07-17 15:35:54:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:37:45:INFO:TRAIN-(cmcm) (1/28/3)>> loss: 0.3139
2024-07-17 15:38:34:INFO:VAL-(cmcm) >>
2024-07-17 15:38:34:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.7434  Mult_acc_5: 0.5162  F1_score: 0.8363  MAE: 0.3008  Corr: 0.7222  R_squre: 0.4541 
2024-07-17 15:38:41:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 15:40:31:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.3107
2024-07-17 15:41:21:INFO:VAL-(cmcm) >>
2024-07-17 15:41:21:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7202  Mult_acc_5: 0.5008  F1_score: 0.8212  MAE: 0.3070  Corr: 0.7103  R_squre: 0.4368 
2024-07-17 15:43:10:INFO:TRAIN-(cmcm) (2/30/3)>> loss: 0.3109
2024-07-17 15:43:59:INFO:VAL-(cmcm) >>
2024-07-17 15:43:59:INFO:M: >>  Mult_acc_2: 0.8377  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7450  Mult_acc_5: 0.5023  F1_score: 0.8369  MAE: 0.3088  Corr: 0.7123  R_squre: 0.4188 
2024-07-17 15:45:47:INFO:TRAIN-(cmcm) (3/31/3)>> loss: 0.3064
2024-07-17 15:46:35:INFO:VAL-(cmcm) >>
2024-07-17 15:46:35:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7063  Mult_acc_5: 0.4946  F1_score: 0.8234  MAE: 0.3144  Corr: 0.6908  R_squre: 0.4032 
2024-07-17 15:48:29:INFO:TRAIN-(cmcm) (4/32/3)>> loss: 0.3045
2024-07-17 15:49:17:INFO:VAL-(cmcm) >>
2024-07-17 15:49:17:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7403  Mult_acc_5: 0.5178  F1_score: 0.8206  MAE: 0.3066  Corr: 0.7012  R_squre: 0.4207 
2024-07-17 15:51:06:INFO:TRAIN-(cmcm) (5/33/3)>> loss: 0.3033
2024-07-17 15:51:55:INFO:VAL-(cmcm) >>
2024-07-17 15:51:55:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7156  Mult_acc_5: 0.4900  F1_score: 0.8177  MAE: 0.3144  Corr: 0.6974  R_squre: 0.4134 
2024-07-17 15:53:44:INFO:TRAIN-(cmcm) (6/34/3)>> loss: 0.3009
2024-07-17 15:54:32:INFO:VAL-(cmcm) >>
2024-07-17 15:54:32:INFO:M: >>  Mult_acc_2: 0.8253  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7388  Mult_acc_5: 0.5008  F1_score: 0.8214  MAE: 0.3100  Corr: 0.7124  R_squre: 0.4259 
2024-07-17 15:56:20:INFO:TRAIN-(cmcm) (7/35/3)>> loss: 0.2991
2024-07-17 15:57:08:INFO:VAL-(cmcm) >>
2024-07-17 15:57:08:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7063  Mult_acc_5: 0.4915  F1_score: 0.8166  MAE: 0.3274  Corr: 0.6669  R_squre: 0.3536 
2024-07-17 15:58:56:INFO:TRAIN-(cmcm) (8/36/3)>> loss: 0.2953
2024-07-17 15:59:45:INFO:VAL-(cmcm) >>
2024-07-17 15:59:45:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7002  Mult_acc_5: 0.4900  F1_score: 0.8169  MAE: 0.3243  Corr: 0.6603  R_squre: 0.3638 
2024-07-17 16:01:35:INFO:TRAIN-(cmcm) (9/37/3)>> loss: 0.2947
2024-07-17 16:02:23:INFO:VAL-(cmcm) >>
2024-07-17 16:02:23:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.7249  Mult_acc_5: 0.5070  F1_score: 0.8207  MAE: 0.3156  Corr: 0.6873  R_squre: 0.4066 
2024-07-17 16:04:11:INFO:TRAIN-(cmcm) (10/38/3)>> loss: 0.2918
2024-07-17 16:04:59:INFO:VAL-(cmcm) >>
2024-07-17 16:04:59:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7264  Mult_acc_5: 0.4930  F1_score: 0.8254  MAE: 0.3165  Corr: 0.6874  R_squre: 0.4016 
2024-07-17 16:06:16:INFO:TEST-(cmcm) >>
2024-07-17 16:06:16:INFO:M: >>  Mult_acc_2: 0.7940  Mult_acc_2_weak: 0.7122  Mult_acc_3: 0.7282  Mult_acc_5: 0.5077  F1_score: 0.7907  MAE: 0.3147  Corr: 0.6992  R_squre: 0.3603 
2024-07-17 16:06:17:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 16:06:17:INFO:Start running cmcm...
2024-07-17 16:06:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 4444}>
2024-07-17 16:06:17:INFO:Let's use the GPU 1 !
2024-07-17 16:06:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 16:06:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721203579 HTTP/1.1" 200 280
2024-07-17 16:06:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 16:06:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 16:06:20:INFO:train samples: (2722,)
2024-07-17 16:06:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 16:06:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721203583 HTTP/1.1" 200 280
2024-07-17 16:06:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 16:06:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 16:06:23:INFO:valid samples: (647,)
2024-07-17 16:06:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 16:06:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721203586 HTTP/1.1" 200 280
2024-07-17 16:06:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 16:06:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 16:06:26:INFO:test samples: (1034,)
2024-07-17 16:06:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 16:06:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721203587 HTTP/1.1" 200 280
2024-07-17 16:06:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 16:06:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 16:06:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 16:06:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721203596 HTTP/1.1" 200 280
2024-07-17 16:06:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 16:06:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 16:06:39:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 16:06:39:INFO:Init labels...
2024-07-17 16:06:39:INFO:Start training...
2024-07-17 16:08:29:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.4816
2024-07-17 16:09:17:INFO:VAL-(cmcm) >>
2024-07-17 16:09:17:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1128  Mult_acc_5: 0.1036  F1_score: 0.4710  MAE: 0.5325  Corr: 0.1493  R_squre: 0.0018 
2024-07-17 16:09:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:11:11:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.4709
2024-07-17 16:11:58:INFO:VAL-(cmcm) >>
2024-07-17 16:11:58:INFO:M: >>  Mult_acc_2: 0.6167  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.1175  Mult_acc_5: 0.1066  F1_score: 0.4753  MAE: 0.5298  Corr: 0.1735  R_squre: 0.0090 
2024-07-17 16:12:05:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:13:55:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.4360
2024-07-17 16:14:44:INFO:VAL-(cmcm) >>
2024-07-17 16:14:44:INFO:M: >>  Mult_acc_2: 0.6151  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1206  Mult_acc_5: 0.1097  F1_score: 0.4745  MAE: 0.5287  Corr: 0.1747  R_squre: 0.0107 
2024-07-17 16:14:50:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:16:41:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 1.3061
2024-07-17 16:17:29:INFO:VAL-(cmcm) >>
2024-07-17 16:17:29:INFO:M: >>  Mult_acc_2: 0.6229  Mult_acc_2_weak: 0.6667  Mult_acc_3: 0.1298  Mult_acc_5: 0.1082  F1_score: 0.5059  MAE: 0.5294  Corr: 0.1644  R_squre: -0.0021 
2024-07-17 16:19:18:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.5907
2024-07-17 16:20:08:INFO:VAL-(cmcm) >>
2024-07-17 16:20:08:INFO:M: >>  Mult_acc_2: 0.6414  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.5301  Mult_acc_5: 0.3447  F1_score: 0.5444  MAE: 0.4164  Corr: 0.6110  R_squre: 0.2018 
2024-07-17 16:20:14:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:22:04:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.3989
2024-07-17 16:22:53:INFO:VAL-(cmcm) >>
2024-07-17 16:22:53:INFO:M: >>  Mult_acc_2: 0.7202  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6028  Mult_acc_5: 0.3849  F1_score: 0.6915  MAE: 0.3694  Corr: 0.5972  R_squre: 0.3217 
2024-07-17 16:23:00:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:24:49:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.3873
2024-07-17 16:25:37:INFO:VAL-(cmcm) >>
2024-07-17 16:25:37:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.6198  Mult_acc_5: 0.3833  F1_score: 0.7547  MAE: 0.3567  Corr: 0.6259  R_squre: 0.3443 
2024-07-17 16:25:43:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:27:33:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.3830
2024-07-17 16:28:23:INFO:VAL-(cmcm) >>
2024-07-17 16:28:23:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.6352  Mult_acc_5: 0.4173  F1_score: 0.7607  MAE: 0.3323  Corr: 0.6605  R_squre: 0.4208 
2024-07-17 16:28:30:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:30:20:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.3777
2024-07-17 16:31:09:INFO:VAL-(cmcm) >>
2024-07-17 16:31:09:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7202  Mult_acc_5: 0.4637  F1_score: 0.8202  MAE: 0.3243  Corr: 0.6696  R_squre: 0.3977 
2024-07-17 16:31:16:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:33:06:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.3744
2024-07-17 16:33:54:INFO:VAL-(cmcm) >>
2024-07-17 16:33:54:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.6646  Mult_acc_5: 0.4513  F1_score: 0.7967  MAE: 0.3230  Corr: 0.6661  R_squre: 0.4157 
2024-07-17 16:34:02:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:35:52:INFO:TRAIN-(cmcm) (1/11/4)>> loss: 0.3722
2024-07-17 16:36:41:INFO:VAL-(cmcm) >>
2024-07-17 16:36:41:INFO:M: >>  Mult_acc_2: 0.8176  Mult_acc_2_weak: 0.7804  Mult_acc_3: 0.7110  Mult_acc_5: 0.4652  F1_score: 0.8147  MAE: 0.3175  Corr: 0.6806  R_squre: 0.4320 
2024-07-17 16:36:48:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:38:37:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 0.3682
2024-07-17 16:39:27:INFO:VAL-(cmcm) >>
2024-07-17 16:39:27:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6522  Mult_acc_5: 0.4204  F1_score: 0.7665  MAE: 0.3233  Corr: 0.6821  R_squre: 0.4621 
2024-07-17 16:41:15:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 0.3668
2024-07-17 16:42:04:INFO:VAL-(cmcm) >>
2024-07-17 16:42:04:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.6893  Mult_acc_5: 0.4637  F1_score: 0.8067  MAE: 0.3134  Corr: 0.6887  R_squre: 0.4522 
2024-07-17 16:42:12:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 16:44:03:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.3654
2024-07-17 16:44:52:INFO:VAL-(cmcm) >>
2024-07-17 16:44:52:INFO:M: >>  Mult_acc_2: 0.7388  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.5827  Mult_acc_5: 0.3879  F1_score: 0.7018  MAE: 0.3431  Corr: 0.6658  R_squre: 0.4336 
2024-07-17 16:46:40:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 0.3641
2024-07-17 16:47:30:INFO:VAL-(cmcm) >>
2024-07-17 16:47:30:INFO:M: >>  Mult_acc_2: 0.7774  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.6522  Mult_acc_5: 0.4312  F1_score: 0.7587  MAE: 0.3240  Corr: 0.6815  R_squre: 0.4529 
2024-07-17 16:49:18:INFO:TRAIN-(cmcm) (3/16/4)>> loss: 0.3628
2024-07-17 16:50:07:INFO:VAL-(cmcm) >>
2024-07-17 16:50:07:INFO:M: >>  Mult_acc_2: 0.7264  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.5904  Mult_acc_5: 0.3833  F1_score: 0.6859  MAE: 0.3462  Corr: 0.6575  R_squre: 0.4193 
2024-07-17 16:51:56:INFO:TRAIN-(cmcm) (4/17/4)>> loss: 0.3603
2024-07-17 16:52:44:INFO:VAL-(cmcm) >>
2024-07-17 16:52:44:INFO:M: >>  Mult_acc_2: 0.7264  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.5827  Mult_acc_5: 0.3879  F1_score: 0.6840  MAE: 0.3440  Corr: 0.6665  R_squre: 0.4297 
2024-07-17 16:54:32:INFO:TRAIN-(cmcm) (5/18/4)>> loss: 0.3597
2024-07-17 16:55:21:INFO:VAL-(cmcm) >>
2024-07-17 16:55:21:INFO:M: >>  Mult_acc_2: 0.7728  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6507  Mult_acc_5: 0.4250  F1_score: 0.7500  MAE: 0.3255  Corr: 0.6921  R_squre: 0.4602 
2024-07-17 16:57:10:INFO:TRAIN-(cmcm) (6/19/4)>> loss: 0.3567
2024-07-17 16:57:59:INFO:VAL-(cmcm) >>
2024-07-17 16:57:59:INFO:M: >>  Mult_acc_2: 0.7852  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.6538  Mult_acc_5: 0.4328  F1_score: 0.7663  MAE: 0.3215  Corr: 0.6906  R_squre: 0.4651 
2024-07-17 16:59:48:INFO:TRAIN-(cmcm) (7/20/4)>> loss: 0.3538
2024-07-17 17:00:37:INFO:VAL-(cmcm) >>
2024-07-17 17:00:37:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.6816  Mult_acc_5: 0.4529  F1_score: 0.7964  MAE: 0.3212  Corr: 0.6809  R_squre: 0.4395 
2024-07-17 17:02:26:INFO:TRAIN-(cmcm) (8/21/4)>> loss: 0.3457
2024-07-17 17:03:16:INFO:VAL-(cmcm) >>
2024-07-17 17:03:16:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.6862  Mult_acc_5: 0.4498  F1_score: 0.7991  MAE: 0.3100  Corr: 0.7015  R_squre: 0.4870 
2024-07-17 17:03:22:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 17:05:11:INFO:TRAIN-(cmcm) (1/22/4)>> loss: 0.3379
2024-07-17 17:05:58:INFO:VAL-(cmcm) >>
2024-07-17 17:05:58:INFO:M: >>  Mult_acc_2: 0.8099  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.6754  Mult_acc_5: 0.4467  F1_score: 0.8001  MAE: 0.3113  Corr: 0.6952  R_squre: 0.4758 
2024-07-17 17:07:47:INFO:TRAIN-(cmcm) (2/23/4)>> loss: 0.3331
2024-07-17 17:08:35:INFO:VAL-(cmcm) >>
2024-07-17 17:08:35:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7187  Mult_acc_5: 0.4791  F1_score: 0.8218  MAE: 0.3094  Corr: 0.7021  R_squre: 0.4568 
2024-07-17 17:08:41:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 17:10:36:INFO:TRAIN-(cmcm) (1/24/4)>> loss: 0.3308
2024-07-17 17:11:24:INFO:VAL-(cmcm) >>
2024-07-17 17:11:24:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7843  Mult_acc_3: 0.7141  Mult_acc_5: 0.4853  F1_score: 0.8178  MAE: 0.3023  Corr: 0.7048  R_squre: 0.4801 
2024-07-17 17:11:30:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 17:13:21:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.3282
2024-07-17 17:14:08:INFO:VAL-(cmcm) >>
2024-07-17 17:14:08:INFO:M: >>  Mult_acc_2: 0.8284  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7187  Mult_acc_5: 0.4730  F1_score: 0.8274  MAE: 0.3070  Corr: 0.7098  R_squre: 0.4758 
2024-07-17 17:15:58:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.3267
2024-07-17 17:16:46:INFO:VAL-(cmcm) >>
2024-07-17 17:16:46:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7342  Mult_acc_5: 0.4915  F1_score: 0.8126  MAE: 0.3097  Corr: 0.6924  R_squre: 0.4584 
2024-07-17 17:18:33:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 0.3257
2024-07-17 17:19:21:INFO:VAL-(cmcm) >>
2024-07-17 17:19:21:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7686  Mult_acc_3: 0.7063  Mult_acc_5: 0.4730  F1_score: 0.8090  MAE: 0.3026  Corr: 0.7100  R_squre: 0.4935 
2024-07-17 17:21:09:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 0.3235
2024-07-17 17:21:58:INFO:VAL-(cmcm) >>
2024-07-17 17:21:58:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7725  Mult_acc_3: 0.7172  Mult_acc_5: 0.4853  F1_score: 0.8085  MAE: 0.3063  Corr: 0.7033  R_squre: 0.4755 
2024-07-17 17:23:45:INFO:TRAIN-(cmcm) (5/29/4)>> loss: 0.3218
2024-07-17 17:24:33:INFO:VAL-(cmcm) >>
2024-07-17 17:24:33:INFO:M: >>  Mult_acc_2: 0.8145  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7311  Mult_acc_5: 0.4822  F1_score: 0.8116  MAE: 0.3063  Corr: 0.7013  R_squre: 0.4772 
2024-07-17 17:26:22:INFO:TRAIN-(cmcm) (6/30/4)>> loss: 0.3205
2024-07-17 17:27:09:INFO:VAL-(cmcm) >>
2024-07-17 17:27:09:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7079  Mult_acc_5: 0.4760  F1_score: 0.8097  MAE: 0.3076  Corr: 0.7027  R_squre: 0.4663 
2024-07-17 17:28:56:INFO:TRAIN-(cmcm) (7/31/4)>> loss: 0.3192
2024-07-17 17:29:45:INFO:VAL-(cmcm) >>
2024-07-17 17:29:45:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7765  Mult_acc_3: 0.7249  Mult_acc_5: 0.4838  F1_score: 0.8053  MAE: 0.3039  Corr: 0.7065  R_squre: 0.4966 
2024-07-17 17:31:33:INFO:TRAIN-(cmcm) (8/32/4)>> loss: 0.3167
2024-07-17 17:32:22:INFO:VAL-(cmcm) >>
2024-07-17 17:32:22:INFO:M: >>  Mult_acc_2: 0.8223  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7481  Mult_acc_5: 0.4930  F1_score: 0.8205  MAE: 0.2983  Corr: 0.7100  R_squre: 0.4887 
2024-07-17 17:32:28:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 17:34:17:INFO:TRAIN-(cmcm) (1/33/4)>> loss: 0.3146
2024-07-17 17:35:07:INFO:VAL-(cmcm) >>
2024-07-17 17:35:07:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.6662  Mult_acc_5: 0.4359  F1_score: 0.7881  MAE: 0.3134  Corr: 0.7124  R_squre: 0.5059 
2024-07-17 17:36:57:INFO:TRAIN-(cmcm) (2/34/4)>> loss: 0.3136
2024-07-17 17:37:46:INFO:VAL-(cmcm) >>
2024-07-17 17:37:46:INFO:M: >>  Mult_acc_2: 0.8192  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.7156  Mult_acc_5: 0.4730  F1_score: 0.8181  MAE: 0.3060  Corr: 0.7074  R_squre: 0.4706 
2024-07-17 17:39:35:INFO:TRAIN-(cmcm) (3/35/4)>> loss: 0.3116
2024-07-17 17:40:24:INFO:VAL-(cmcm) >>
2024-07-17 17:40:24:INFO:M: >>  Mult_acc_2: 0.8269  Mult_acc_2_weak: 0.7608  Mult_acc_3: 0.7357  Mult_acc_5: 0.4977  F1_score: 0.8273  MAE: 0.3023  Corr: 0.7098  R_squre: 0.4685 
2024-07-17 17:42:11:INFO:TRAIN-(cmcm) (4/36/4)>> loss: 0.3104
2024-07-17 17:43:00:INFO:VAL-(cmcm) >>
2024-07-17 17:43:00:INFO:M: >>  Mult_acc_2: 0.8207  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7233  Mult_acc_5: 0.4791  F1_score: 0.8203  MAE: 0.3026  Corr: 0.7119  R_squre: 0.4792 
2024-07-17 17:44:49:INFO:TRAIN-(cmcm) (5/37/4)>> loss: 0.3085
2024-07-17 17:45:37:INFO:VAL-(cmcm) >>
2024-07-17 17:45:37:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.6862  Mult_acc_5: 0.4529  F1_score: 0.8015  MAE: 0.3128  Corr: 0.6998  R_squre: 0.4709 
2024-07-17 17:47:26:INFO:TRAIN-(cmcm) (6/38/4)>> loss: 0.3078
2024-07-17 17:48:14:INFO:VAL-(cmcm) >>
2024-07-17 17:48:14:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.7048  Mult_acc_5: 0.4683  F1_score: 0.8045  MAE: 0.3051  Corr: 0.7077  R_squre: 0.4806 
2024-07-17 17:49:57:INFO:TRAIN-(cmcm) (7/39/4)>> loss: 0.3056
2024-07-17 17:50:44:INFO:VAL-(cmcm) >>
2024-07-17 17:50:44:INFO:M: >>  Mult_acc_2: 0.8083  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7002  Mult_acc_5: 0.4621  F1_score: 0.8065  MAE: 0.3104  Corr: 0.7077  R_squre: 0.4787 
2024-07-17 17:52:26:INFO:TRAIN-(cmcm) (8/40/4)>> loss: 0.3042
2024-07-17 17:53:12:INFO:VAL-(cmcm) >>
2024-07-17 17:53:12:INFO:M: >>  Mult_acc_2: 0.8130  Mult_acc_2_weak: 0.7647  Mult_acc_3: 0.7326  Mult_acc_5: 0.4869  F1_score: 0.8059  MAE: 0.2983  Corr: 0.7145  R_squre: 0.5047 
2024-07-17 17:54:55:INFO:TRAIN-(cmcm) (9/41/4)>> loss: 0.3017
2024-07-17 17:55:41:INFO:VAL-(cmcm) >>
2024-07-17 17:55:41:INFO:M: >>  Mult_acc_2: 0.8006  Mult_acc_2_weak: 0.7569  Mult_acc_3: 0.6878  Mult_acc_5: 0.4529  F1_score: 0.7934  MAE: 0.3107  Corr: 0.7066  R_squre: 0.4949 
2024-07-17 17:57:26:INFO:TRAIN-(cmcm) (10/42/4)>> loss: 0.3002
2024-07-17 17:58:12:INFO:VAL-(cmcm) >>
2024-07-17 17:58:12:INFO:M: >>  Mult_acc_2: 0.8161  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.7249  Mult_acc_5: 0.4853  F1_score: 0.8148  MAE: 0.3029  Corr: 0.7112  R_squre: 0.4865 
2024-07-17 17:59:26:INFO:TEST-(cmcm) >>
2024-07-17 17:59:26:INFO:M: >>  Mult_acc_2: 0.8182  Mult_acc_2_weak: 0.7391  Mult_acc_3: 0.7679  Mult_acc_5: 0.5445  F1_score: 0.8158  MAE: 0.2870  Corr: 0.7136  R_squre: 0.4675 
2024-07-17 17:59:27:INFO:Results are added to results/results/simsv2-regression-80.csv...
2024-07-17 17:59:27:INFO:Start running cmcm...
2024-07-17 17:59:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'ZhipuAI/chatglm3-6b-base', 'max_new_tokens': 5, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, 1.0]: ', 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 5555}>
2024-07-17 17:59:27:INFO:Let's use the GPU 1 !
2024-07-17 17:59:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 17:59:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721210369 HTTP/1.1" 200 280
2024-07-17 17:59:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 17:59:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 17:59:30:INFO:train samples: (2722,)
2024-07-17 17:59:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 17:59:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721210372 HTTP/1.1" 200 280
2024-07-17 17:59:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 17:59:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 17:59:33:INFO:valid samples: (647,)
2024-07-17 17:59:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 17:59:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721210375 HTTP/1.1" 200 280
2024-07-17 17:59:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 17:59:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 17:59:36:INFO:test samples: (1034,)
2024-07-17 17:59:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 17:59:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721210376 HTTP/1.1" 200 280
2024-07-17 17:59:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 17:59:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 17:59:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-17 17:59:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1721210385 HTTP/1.1" 200 280
2024-07-17 17:59:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/revisions?EndTime=1701705600 HTTP/1.1" 200 280
2024-07-17 17:59:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/ZhipuAI/chatglm3-6b-base/repo/files?Revision=v1.0.1&Recursive=True HTTP/1.1" 200 None
2024-07-17 17:59:47:INFO:trainable params: 2680716 || all params: 6246264716 || trainable%: 0.042917105212228086
2024-07-17 17:59:47:INFO:Init labels...
2024-07-17 17:59:47:INFO:Start training...
2024-07-17 18:01:30:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.3327
2024-07-17 18:02:16:INFO:VAL-(cmcm) >>
2024-07-17 18:02:16:INFO:M: >>  Mult_acc_2: 0.6198  Mult_acc_2_weak: 0.6784  Mult_acc_3: 0.1144  Mult_acc_5: 0.1082  F1_score: 0.4898  MAE: 0.5335  Corr: 0.1220  R_squre: -0.0092 
2024-07-17 18:02:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:04:06:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.6430
2024-07-17 18:04:52:INFO:VAL-(cmcm) >>
2024-07-17 18:04:52:INFO:M: >>  Mult_acc_2: 0.6692  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.5116  Mult_acc_5: 0.3292  F1_score: 0.6061  MAE: 0.4297  Corr: 0.5059  R_squre: 0.2559 
2024-07-17 18:04:58:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:06:42:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.4779
2024-07-17 18:07:28:INFO:VAL-(cmcm) >>
2024-07-17 18:07:28:INFO:M: >>  Mult_acc_2: 0.7280  Mult_acc_2_weak: 0.7059  Mult_acc_3: 0.6012  Mult_acc_5: 0.3818  F1_score: 0.7111  MAE: 0.3703  Corr: 0.5886  R_squre: 0.2937 
2024-07-17 18:07:34:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:09:19:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.3933
2024-07-17 18:10:06:INFO:VAL-(cmcm) >>
2024-07-17 18:10:06:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.7451  Mult_acc_3: 0.7002  Mult_acc_5: 0.4544  F1_score: 0.7801  MAE: 0.3403  Corr: 0.6442  R_squre: 0.3577 
2024-07-17 18:10:12:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:11:58:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.3821
2024-07-17 18:12:44:INFO:VAL-(cmcm) >>
2024-07-17 18:12:44:INFO:M: >>  Mult_acc_2: 0.7867  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.7280  Mult_acc_5: 0.4668  F1_score: 0.7885  MAE: 0.3357  Corr: 0.6506  R_squre: 0.3405 
2024-07-17 18:12:50:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:14:35:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.3776
2024-07-17 18:15:21:INFO:VAL-(cmcm) >>
2024-07-17 18:15:21:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7110  Mult_acc_5: 0.4560  F1_score: 0.7947  MAE: 0.3326  Corr: 0.6506  R_squre: 0.3606 
2024-07-17 18:15:27:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:17:13:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.3728
2024-07-17 18:17:59:INFO:VAL-(cmcm) >>
2024-07-17 18:17:59:INFO:M: >>  Mult_acc_2: 0.7635  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6677  Mult_acc_5: 0.4297  F1_score: 0.7553  MAE: 0.3428  Corr: 0.6443  R_squre: 0.3740 
2024-07-17 18:19:44:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.3696
2024-07-17 18:20:31:INFO:VAL-(cmcm) >>
2024-07-17 18:20:31:INFO:M: >>  Mult_acc_2: 0.7836  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6754  Mult_acc_5: 0.4436  F1_score: 0.7792  MAE: 0.3199  Corr: 0.6752  R_squre: 0.4317 
2024-07-17 18:20:36:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:22:20:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.3654
2024-07-17 18:23:06:INFO:VAL-(cmcm) >>
2024-07-17 18:23:06:INFO:M: >>  Mult_acc_2: 0.7774  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6476  Mult_acc_5: 0.4204  F1_score: 0.7698  MAE: 0.3236  Corr: 0.6762  R_squre: 0.4361 
2024-07-17 18:24:50:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.3616
2024-07-17 18:25:36:INFO:VAL-(cmcm) >>
2024-07-17 18:25:36:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.6461  Mult_acc_5: 0.4219  F1_score: 0.7749  MAE: 0.3246  Corr: 0.6870  R_squre: 0.4672 
2024-07-17 18:27:19:INFO:TRAIN-(cmcm) (3/11/5)>> loss: 0.3586
2024-07-17 18:28:05:INFO:VAL-(cmcm) >>
2024-07-17 18:28:05:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.6677  Mult_acc_5: 0.4374  F1_score: 0.7591  MAE: 0.3162  Corr: 0.6937  R_squre: 0.4572 
2024-07-17 18:28:11:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:29:55:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.3556
2024-07-17 18:30:42:INFO:VAL-(cmcm) >>
2024-07-17 18:30:42:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6878  Mult_acc_5: 0.4482  F1_score: 0.7608  MAE: 0.3323  Corr: 0.6644  R_squre: 0.3855 
2024-07-17 18:32:28:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.3535
2024-07-17 18:33:14:INFO:VAL-(cmcm) >>
2024-07-17 18:33:14:INFO:M: >>  Mult_acc_2: 0.7543  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6430  Mult_acc_5: 0.4281  F1_score: 0.7283  MAE: 0.3246  Corr: 0.6840  R_squre: 0.4471 
2024-07-17 18:34:56:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.3504
2024-07-17 18:35:42:INFO:VAL-(cmcm) >>
2024-07-17 18:35:42:INFO:M: >>  Mult_acc_2: 0.7543  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6352  Mult_acc_5: 0.4189  F1_score: 0.7263  MAE: 0.3199  Corr: 0.7024  R_squre: 0.4748 
2024-07-17 18:37:25:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.3490
2024-07-17 18:38:11:INFO:VAL-(cmcm) >>
2024-07-17 18:38:11:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7137  Mult_acc_3: 0.6816  Mult_acc_5: 0.4420  F1_score: 0.7974  MAE: 0.3094  Corr: 0.7104  R_squre: 0.4803 
2024-07-17 18:38:17:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:40:03:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.3481
2024-07-17 18:40:50:INFO:VAL-(cmcm) >>
2024-07-17 18:40:50:INFO:M: >>  Mult_acc_2: 0.7496  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6522  Mult_acc_5: 0.4328  F1_score: 0.7200  MAE: 0.3363  Corr: 0.6677  R_squre: 0.3847 
2024-07-17 18:42:33:INFO:TRAIN-(cmcm) (2/17/5)>> loss: 0.3465
2024-07-17 18:43:20:INFO:VAL-(cmcm) >>
2024-07-17 18:43:20:INFO:M: >>  Mult_acc_2: 0.7898  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6476  Mult_acc_5: 0.4235  F1_score: 0.7795  MAE: 0.3107  Corr: 0.7051  R_squre: 0.4860 
2024-07-17 18:45:08:INFO:TRAIN-(cmcm) (3/18/5)>> loss: 0.3451
2024-07-17 18:45:55:INFO:VAL-(cmcm) >>
2024-07-17 18:45:55:INFO:M: >>  Mult_acc_2: 0.8037  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.7002  Mult_acc_5: 0.4606  F1_score: 0.7956  MAE: 0.3085  Corr: 0.7023  R_squre: 0.4560 
2024-07-17 18:46:01:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 18:47:49:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.3430
2024-07-17 18:48:35:INFO:VAL-(cmcm) >>
2024-07-17 18:48:35:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6476  Mult_acc_5: 0.4219  F1_score: 0.7674  MAE: 0.3184  Corr: 0.6978  R_squre: 0.4723 
2024-07-17 18:50:19:INFO:TRAIN-(cmcm) (2/20/5)>> loss: 0.3403
2024-07-17 18:51:05:INFO:VAL-(cmcm) >>
2024-07-17 18:51:05:INFO:M: >>  Mult_acc_2: 0.7743  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6507  Mult_acc_5: 0.4374  F1_score: 0.7570  MAE: 0.3168  Corr: 0.7108  R_squre: 0.4735 
2024-07-17 18:52:53:INFO:TRAIN-(cmcm) (3/21/5)>> loss: 0.3400
2024-07-17 18:53:39:INFO:VAL-(cmcm) >>
2024-07-17 18:53:39:INFO:M: >>  Mult_acc_2: 0.7821  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6832  Mult_acc_5: 0.4436  F1_score: 0.7687  MAE: 0.3116  Corr: 0.7047  R_squre: 0.4675 
2024-07-17 18:55:22:INFO:TRAIN-(cmcm) (4/22/5)>> loss: 0.3372
2024-07-17 18:56:08:INFO:VAL-(cmcm) >>
2024-07-17 18:56:08:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6754  Mult_acc_5: 0.4420  F1_score: 0.7922  MAE: 0.3088  Corr: 0.7079  R_squre: 0.4833 
2024-07-17 18:57:50:INFO:TRAIN-(cmcm) (5/23/5)>> loss: 0.3371
2024-07-17 18:58:35:INFO:VAL-(cmcm) >>
2024-07-17 18:58:35:INFO:M: >>  Mult_acc_2: 0.7944  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6754  Mult_acc_5: 0.4436  F1_score: 0.7866  MAE: 0.3085  Corr: 0.7089  R_squre: 0.4865 
2024-07-17 19:00:18:INFO:TRAIN-(cmcm) (6/24/5)>> loss: 0.3348
2024-07-17 19:01:04:INFO:VAL-(cmcm) >>
2024-07-17 19:01:04:INFO:M: >>  Mult_acc_2: 0.7960  Mult_acc_2_weak: 0.7412  Mult_acc_3: 0.6631  Mult_acc_5: 0.4374  F1_score: 0.7860  MAE: 0.3162  Corr: 0.6958  R_squre: 0.4578 
2024-07-17 19:02:48:INFO:TRAIN-(cmcm) (7/25/5)>> loss: 0.3330
2024-07-17 19:03:34:INFO:VAL-(cmcm) >>
2024-07-17 19:03:34:INFO:M: >>  Mult_acc_2: 0.7682  Mult_acc_2_weak: 0.7176  Mult_acc_3: 0.6476  Mult_acc_5: 0.4281  F1_score: 0.7498  MAE: 0.3240  Corr: 0.6960  R_squre: 0.4431 
2024-07-17 19:05:16:INFO:TRAIN-(cmcm) (8/26/5)>> loss: 0.3317
2024-07-17 19:06:03:INFO:VAL-(cmcm) >>
2024-07-17 19:06:03:INFO:M: >>  Mult_acc_2: 0.8068  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6862  Mult_acc_5: 0.4513  F1_score: 0.7988  MAE: 0.3029  Corr: 0.7098  R_squre: 0.4876 
2024-07-17 19:06:09:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-simsv2-regression.pth.
2024-07-17 19:07:55:INFO:TRAIN-(cmcm) (1/27/5)>> loss: 0.3303
2024-07-17 19:08:42:INFO:VAL-(cmcm) >>
2024-07-17 19:08:42:INFO:M: >>  Mult_acc_2: 0.7697  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6461  Mult_acc_5: 0.4297  F1_score: 0.7512  MAE: 0.3240  Corr: 0.6918  R_squre: 0.4502 
2024-07-17 19:10:25:INFO:TRAIN-(cmcm) (2/28/5)>> loss: 0.3277
2024-07-17 19:11:11:INFO:VAL-(cmcm) >>
2024-07-17 19:11:11:INFO:M: >>  Mult_acc_2: 0.8053  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6785  Mult_acc_5: 0.4529  F1_score: 0.8013  MAE: 0.3113  Corr: 0.6951  R_squre: 0.4534 
2024-07-17 19:12:55:INFO:TRAIN-(cmcm) (3/29/5)>> loss: 0.3272
2024-07-17 19:13:42:INFO:VAL-(cmcm) >>
2024-07-17 19:13:42:INFO:M: >>  Mult_acc_2: 0.7883  Mult_acc_2_weak: 0.7294  Mult_acc_3: 0.6569  Mult_acc_5: 0.4297  F1_score: 0.7749  MAE: 0.3125  Corr: 0.6991  R_squre: 0.4701 
2024-07-17 19:15:26:INFO:TRAIN-(cmcm) (4/30/5)>> loss: 0.3251
2024-07-17 19:16:13:INFO:VAL-(cmcm) >>
2024-07-17 19:16:13:INFO:M: >>  Mult_acc_2: 0.8022  Mult_acc_2_weak: 0.7490  Mult_acc_3: 0.6847  Mult_acc_5: 0.4467  F1_score: 0.7910  MAE: 0.3097  Corr: 0.6998  R_squre: 0.4740 
2024-07-17 19:17:59:INFO:TRAIN-(cmcm) (5/31/5)>> loss: 0.3241
2024-07-17 19:18:45:INFO:VAL-(cmcm) >>
2024-07-17 19:18:45:INFO:M: >>  Mult_acc_2: 0.8114  Mult_acc_2_weak: 0.7529  Mult_acc_3: 0.6971  Mult_acc_5: 0.4621  F1_score: 0.8025  MAE: 0.3057  Corr: 0.7079  R_squre: 0.4748 
2024-07-17 19:20:32:INFO:TRAIN-(cmcm) (6/32/5)>> loss: 0.3241
2024-07-17 19:21:18:INFO:VAL-(cmcm) >>
2024-07-17 19:21:18:INFO:M: >>  Mult_acc_2: 0.7960  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6445  Mult_acc_5: 0.4235  F1_score: 0.7867  MAE: 0.3193  Corr: 0.6816  R_squre: 0.4517 
2024-07-17 19:23:06:INFO:TRAIN-(cmcm) (7/33/5)>> loss: 0.3219
2024-07-17 19:23:53:INFO:VAL-(cmcm) >>
2024-07-17 19:23:53:INFO:M: >>  Mult_acc_2: 0.7991  Mult_acc_2_weak: 0.7373  Mult_acc_3: 0.6893  Mult_acc_5: 0.4544  F1_score: 0.7881  MAE: 0.3104  Corr: 0.6950  R_squre: 0.4611 
2024-07-17 19:25:40:INFO:TRAIN-(cmcm) (8/34/5)>> loss: 0.3200
2024-07-17 19:26:28:INFO:VAL-(cmcm) >>
2024-07-17 19:26:28:INFO:M: >>  Mult_acc_2: 0.7790  Mult_acc_2_weak: 0.7216  Mult_acc_3: 0.6445  Mult_acc_5: 0.4204  F1_score: 0.7612  MAE: 0.3156  Corr: 0.6971  R_squre: 0.4731 
2024-07-17 19:28:17:INFO:TRAIN-(cmcm) (9/35/5)>> loss: 0.3180
2024-07-17 19:29:03:INFO:VAL-(cmcm) >>
2024-07-17 19:29:03:INFO:M: >>  Mult_acc_2: 0.7960  Mult_acc_2_weak: 0.7333  Mult_acc_3: 0.6677  Mult_acc_5: 0.4451  F1_score: 0.7845  MAE: 0.3094  Corr: 0.7046  R_squre: 0.4731 
2024-07-17 19:30:49:INFO:TRAIN-(cmcm) (10/36/5)>> loss: 0.3157
2024-07-17 19:31:37:INFO:VAL-(cmcm) >>
2024-07-17 19:31:37:INFO:M: >>  Mult_acc_2: 0.7759  Mult_acc_2_weak: 0.7255  Mult_acc_3: 0.6461  Mult_acc_5: 0.4219  F1_score: 0.7589  MAE: 0.3218  Corr: 0.6794  R_squre: 0.4443 
2024-07-17 19:32:50:INFO:TEST-(cmcm) >>
2024-07-17 19:32:50:INFO:M: >>  Mult_acc_2: 0.7524  Mult_acc_2_weak: 0.6832  Mult_acc_3: 0.6654  Mult_acc_5: 0.4652  F1_score: 0.7408  MAE: 0.3151  Corr: 0.6704  R_squre: 0.3986 
2024-07-17 19:32:51:INFO:Results are added to results/results/simsv2-regression-80.csv...
